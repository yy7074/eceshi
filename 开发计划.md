# 科研检测服务平台 - 详细需求说明与开发计划
**对标平台：eceshi.com（e测试）**

## 一、项目概述

### 1.1 项目背景
科研检测服务平台旨在为高校师生、科研机构提供便捷的科研检测服务，连接实验室资源与科研用户需求，实现检测服务的在线化、标准化和智能化管理。

**对标平台**：eceshi.com（泛锐云智科技），国家高新技术企业，具备CNAS/CMA ISO认证。

**核心定位**：
- 科研检测服务一站式平台
- 打造"云现场服务" + "标准化检测" 双模式
- 建立实验室加盟合作生态
- 提供专属顾问1v1服务

### 1.2 系统架构
- **实验室管理端**：后台管理系统（Web）
- **用户端**：小程序 + 网站（响应式）
- **后台管理**：运营管理系统（订单、审核、财务、数据分析）
- **实验室加盟端**：实验室入驻申请和管理
- **技术架构**：前后端分离，微服务架构

### 1.3 核心价值
- 提高实验室设备利用率和收益（参考eceshi加盟模式）
- 降低科研用户检测成本和时间（会员权益、预付优惠）
- 规范化检测服务流程和质量（CNAS/CMA标准）
- 建立科研服务生态圈（用户、实验室、平台三方共赢）

---

## 二、功能模块详细需求说明

### 2.1 实验室管理端（后台系统）

#### 2.1.1 设备管理模块
**功能描述**：实验室录入和管理检测设备信息

**详细需求**：
1. **设备申请与录入**
   - 支持前端申请审核流程
   - 支持后台直接开设账号录入
   - 必填字段（≥5个参数）：
     * 设备型号（如：德国布鲁克 D8）
     * 测试项目（如：XRD、原位XRD、拉曼）
     * 测试能力（如：3~120度）
     * 收样要求（如：粉末、薄膜，不接块体）
     * 周接单量预估（如：50个样品）
     * 测试周期（如：3个工作日）
   - 支持上传设备照片、参数文档

2. **设备信息修改**
   - 实验室可修改自己的设备信息
   - 修改后实时同步到前端展示页面
   - 修改历史记录可追溯

3. **设备状态管理**
   - 设备状态：正常、维护中、停用
   - 停用时自动停止接单
   - 维护中可设置预计恢复时间

**数据表设计要点**：
```
equipment (设备表)
- id: 设备ID
- lab_id: 实验室ID
- model: 设备型号
- test_items: 测试项目（JSON）
- test_capability: 测试能力
- sample_requirements: 收样要求
- weekly_capacity: 周接单量
- test_cycle: 测试周期
- status: 设备状态
- created_at/updated_at
```

---

#### 2.1.2 订单处理模块
**功能描述**：实验室接收、处理和管理测试订单

**详细需求**：
1. **订单查看**
   - 仅显示测试相关信息（项目、样品要求、订单号）
   - **隐私保护**：不显示客户个人信息
   - 订单列表按状态分类：待确认、待试验、实验中、已完成
   - 支持按时间、项目、状态筛选

2. **订单操作**
   - **确认接单**：确认后订单进入"待试验"状态
   - **拒接订单**：需填写拒接原因，自动通知客户
   - **重新指派**：将订单转给其他实验室（需系统管理员权限）
   - 操作后实时同步订单状态，发送通知

3. **订单导出**
   - 支持导出为Word文档格式
   - 包含完整的样品信息、测试要求、备注
   - 支持批量导出

4. **订单提醒**
   - 新订单实时提醒（微信、短信、系统通知）
   - 即将超期订单预警
   - 客户催单提醒

**数据表设计要点**：
```
orders (订单表)
- order_no: 订单号（格式：YYYYMMDD+4位序号）
- user_id: 用户ID
- lab_id: 实验室ID
- equipment_id: 设备ID
- test_items: 测试项目
- sample_info: 样品信息（JSON）
- status: 订单状态
- created_at: 下单时间
- confirmed_at: 接单时间
- completed_at: 完成时间
```

---

#### 2.1.3 数据与报告管理模块
**功能描述**：上传测试数据和生成报告

**详细需求**：
1. **数据上传**
   - **批量上传**：支持多文件一键上传
   - **自动分类**：按文件名中的订单号自动匹配客户
   - 文件命名规则：订单号_样品编号_测试项目
   - 单文件大小限制：≤100MB
   - 支持格式：常见测试数据格式（.raw, .xlsx, .txt等）

2. **数据通知**
   - 数据上传完成后自动通知客户
   - 通知方式：微信模板消息、短信、站内消息
   - 客户可在线预览、下载数据

3. **报告生成**
   - 支持生成电子测试报告
   - 报告模板可自定义
   - 报告状态：待上传、已完成
   - 支持电子签章（实验室盖章）
   - 报告可导出为PDF格式

4. **数据管理**
   - 数据按订单号归档存储
   - 支持数据检索、查看
   - 数据保存≥3年

**数据表设计要点**：
```
test_data (测试数据表)
- id: 数据ID
- order_id: 订单ID
- file_name: 文件名
- file_path: 存储路径
- file_size: 文件大小
- uploaded_at: 上传时间
- status: 状态（待审核、已发布）

test_reports (测试报告表)
- id: 报告ID
- order_id: 订单ID
- report_no: 报告编号
- report_path: 报告路径
- generated_at: 生成时间
```

---

#### 2.1.4 收益与信息管理模块
**功能描述**：核算订单收益和管理实验室信息

**详细需求**：
1. **收益核算**
   - 每个订单可输入单价
   - **一键核算**：样品数量 × 单价 = 总收益
   - 后台可修改单价（需权限）
   - 实时显示累计收益

2. **报表导出**
   - **月报**：订单数量、总收益、各设备接单量
   - **年报**：年度汇总数据、趋势分析
   - 支持导出为Excel、PDF格式
   - 图表可视化：收益趋势图、设备使用率

3. **联系信息管理**
   - 可修改：
     * 实验室联系人
     * 联系电话
     * 收样地址
   - 修改后需联系公司工作人员确认生效
   - 修改记录可追溯

4. **财务对账**
   - 支持查看待结算、已结算订单
   - 对账单导出
   - 收款记录管理

**数据表设计要点**：
```
lab_finance (实验室财务表)
- id
- lab_id: 实验室ID
- order_id: 订单ID
- unit_price: 单价
- quantity: 数量
- total_amount: 总金额
- settlement_status: 结算状态
- settlement_date: 结算日期

lab_info (实验室信息表)
- id
- lab_name: 实验室名称
- contact_person: 联系人
- contact_phone: 联系电话
- address: 收样地址
- status: 状态
```

---

### 2.2 用户端（小程序/网站）

#### 2.2.1 实名认证模块
**功能描述**：用户完成实名认证，获取信用额度

**详细需求**：
1. **认证信息采集**
   - 入学年份 / 预计毕业年份（下拉选择）
   - 客户地区（省市二级联动）
   - 所在高校（搜索或选择）
   - 所在院系（输入）
   - 导师姓名及职称（输入+下拉）
   - 学生证/工作证照片上传

2. **认证审核**
   - 自动审核：高校邮箱验证
   - 人工审核：工作人员审核证件
   - 审核时间：1-2个工作日
   - 审核结果通知

3. **信用额度**
   - 初始信用额度：3000元（可后台调整）
   - 信用额度使用规则：先测试后付款
   - "我的欠款"：信用额度支付的未结清费用
   - 欠款结清后自动恢复额度

4. **认证等级**
   - 基础认证：学生信息
   - 高级认证：导师信息、科研项目
   - 不同等级享受不同权益

**数据表设计要点**：
```
user_certification (用户认证表)
- id
- user_id: 用户ID
- enrollment_year: 入学年份
- graduation_year: 毕业年份
- region: 地区
- university: 高校
- department: 院系
- supervisor_name: 导师姓名
- supervisor_title: 导师职称
- credit_limit: 信用额度
- used_credit: 已用额度
- certification_status: 认证状态
- certified_at: 认证时间
```

---

#### 2.2.2 订单管理模块
**功能描述**：用户查询和管理测试订单

**详细需求**：
1. **订单查询**
   - 输入订单号快速查询
   - 订单列表按状态分类显示
   - **订单状态流转**：
     * 待支付 → 待确认 → 待试验 → 实验中 → 已完成 → 待评价 → 待开票 → 已开票
   - 每个状态显示对应的操作按钮和进度说明

2. **订单操作**
   - **待支付订单**：
     * 选择支付方式完成支付
     * 支付超时自动取消（24小时）
   - **已完成订单**：
     * 申请开票
     * 查看电子报告
     * 下载测试数据（PC端直接下载，移动端分享到云盘）
     * 评价订单
   - **订单取消**：
     * 客户端可取消"待支付""待确认"状态订单
     * "待试验"及以后状态需联系客服取消

3. **订单凭证**
   - 电子版测试清单
   - 电子合同（可下载或打印）
   - 支付凭证
   - 发票电子版

4. **订单详情**
   - 显示完整的订单信息
   - 测试进度实时更新
   - 物流信息追踪
   - 沟通记录（与客服/实验室）

**界面设计要点**：
- 订单状态用进度条可视化
- 关键操作醒目显示
- 支持筛选、排序
- 长订单列表分页加载

**数据表设计要点**：
```
order_status_log (订单状态日志表)
- id
- order_id: 订单ID
- status: 状态
- operator: 操作人
- remark: 备注
- created_at: 时间

order_communication (订单沟通记录表)
- id
- order_id: 订单ID
- user_type: 用户类型（客户/客服/实验室）
- message: 消息内容
- created_at: 时间
```

---

#### 2.2.3 支付与开票模块
**功能描述**：多种支付方式和发票管理

**详细需求**：
1. **支付方式（单选）**
   - **对公转账**：
     * 显示公司账户信息
     * 提醒备注订单号
     * 上传转账凭证
     * 财务确认后订单生效
   
   - **扫码支付**（支付宝/微信）：
     * 调用官方支付接口
     * 支付成功实时反馈
     * 支付失败重试机制
   
   - **预付支付**：
     * 使用预存金额支付
     * 余额不足跳转储值页面
     * 显示可用余额
   
   - **先测试后付款**（信用额度支付）：
     * 判断信用额度是否足够
     * 额度不足提示充值或更改支付方式
     * 使用后计入"我的欠款"

2. **预付管理**
   - **申请预付**：
     * 输入预存金额
     * 填写备注说明
     * 提交审核（对公转账需审核）
   
   - **预付记录**：
     * 充值记录列表
     * 使用记录列表
     * 余额变动明细
   
   - **团队预付**：
     * 加入团队共享预付余额
     * 创建团队设置消费权限
     * 余额不足统一提醒

3. **开票管理**
   - **申请开票**：
     * 选择订单（支持多选）
     * 完成/未完成订单均可开票
     * 选择发票类型：
       - 电子普通发票
       - 电子增值税专用发票
     * 填写发票信息：
       - 发票抬头
       - 税号
       - 地址电话
       - 开户行及账号（增值税发票必填）
   
   - **发票记录**：
     * 开票记录列表
     * 发票状态：待开、已开、已邮寄
     * 已开发票可下载电子版
     * 增值税发票显示物流信息

4. **优惠券管理**
   - 可用优惠券列表
   - 优惠券详情（折扣、有效期、使用规则）
   - 支付时自动推荐最优优惠券
   - 优惠券到期提醒

**数据表设计要点**：
```
payments (支付记录表)
- id
- order_id: 订单ID
- user_id: 用户ID
- payment_method: 支付方式
- amount: 支付金额
- status: 支付状态
- transaction_no: 交易流水号
- paid_at: 支付时间

prepaid_accounts (预付账户表)
- id
- user_id: 用户ID（个人）或team_id（团队）
- balance: 余额
- frozen_amount: 冻结金额
- updated_at

prepaid_transactions (预付交易记录表)
- id
- account_id: 账户ID
- type: 类型（充值/消费/退款）
- amount: 金额
- balance_after: 交易后余额
- order_id: 关联订单ID
- remark: 备注
- created_at

invoices (发票表)
- id
- user_id: 用户ID
- order_ids: 订单ID列表（JSON）
- invoice_type: 发票类型
- invoice_title: 发票抬头
- tax_no: 税号
- amount: 开票金额
- status: 开票状态
- invoice_no: 发票号码
- invoice_file: 电子发票文件路径
- created_at: 申请时间
- issued_at: 开票时间
```

---

#### 2.2.4 积分与社交功能模块
**功能描述**：积分激励和邀请返利机制

**详细需求**：
1. **积分管理**
   - **积分获取**：
     * 完成订单获得积分（订单金额的1%-5%）
     * 首次下单奖励
     * 完成评价奖励
     * 签到奖励
     * 参与活动奖励
   
   - **我的积分**：
     * 显示当前积分余额
     * 积分获取记录
     * 积分使用记录
     * 积分即将过期提醒（如设置1年有效期）
   
   - **积分城兑换**：
     * 商品列表展示（类似拼多多积分商城）
     * 商品分类：实物商品、优惠券、测试抵扣券
     * 兑换流程：选择商品 → 确认兑换 → 填写地址 → 兑换成功
     * 兑换记录查询
     * 物流信息追踪

2. **邀请好友**
   - **邀请机制**：
     * 生成专属邀请码/邀请链接
     * 生成邀请海报（含二维码）
     * 分享到微信、朋友圈、QQ等
   
   - **返利规则**：
     * 好友注册成功：邀请人获得注册奖励
     * 好友首次下单：邀请人获得首单返利
     * 好友后续消费：邀请人获得消费返利（比例可调整，如5%-10%）
     * 返利形式：积分或现金（可提现）
   
   - **邀请记录**：
     * 邀请人数统计
     * 邀请好友列表（脱敏显示）
     * 返利金额统计
     * 返利明细记录

3. **提现管理**
   - **提现功能**：
     * 提现来源：积分返利、邀请返利、预付余额
     * 提现方式：支付宝、微信、银行卡
     * 提现门槛：最低提现金额（如50元）
     * 提现手续费：按比例收取（可设置免手续费活动）
   
   - **提现记录**：
     * 提现金额
     * 提现时间
     * 提现状态：待审核、处理中、已到账、已拒绝
     * 预计到账时间
     * 拒绝原因说明

4. **团队功能**
   - 创建团队/加入团队
   - 团队成员管理
   - 团队预付共享
   - 团队订单统计
   - 团队专属优惠

**数据表设计要点**：
```
user_points (用户积分表)
- id
- user_id: 用户ID
- balance: 积分余额
- total_earned: 累计获得
- total_used: 累计使用
- updated_at

point_transactions (积分交易记录表)
- id
- user_id: 用户ID
- type: 类型（获得/使用/过期）
- amount: 积分数量
- balance_after: 交易后余额
- source: 来源（订单/签到/活动等）
- related_id: 关联ID
- remark: 备注
- created_at

point_products (积分商品表)
- id
- name: 商品名称
- points_required: 所需积分
- stock: 库存
- category: 分类
- image: 商品图片
- description: 描述
- status: 状态（上架/下架）

invitations (邀请记录表)
- id
- inviter_id: 邀请人ID
- invitee_id: 被邀请人ID
- invitation_code: 邀请码
- registered_at: 注册时间
- first_order_at: 首单时间
- total_rebate: 累计返利

rebates (返利记录表)
- id
- user_id: 用户ID
- type: 返利类型（注册/首单/消费）
- amount: 返利金额
- order_id: 关联订单ID
- status: 状态
- created_at

withdrawals (提现记录表)
- id
- user_id: 用户ID
- amount: 提现金额
- fee: 手续费
- actual_amount: 实际到账金额
- method: 提现方式
- account: 账户信息
- status: 状态
- applied_at: 申请时间
- processed_at: 处理时间
- remark: 备注
```

---

### 2.3 商品链接模块（检测项目展示与下单）

#### 2.3.1 项目展示模块
**功能描述**：展示检测项目信息，吸引用户下单

**详细需求**：
1. **项目列表页**
   - 项目分类导航（按检测类型）
   - 项目卡片展示：
     * 项目名称（如：凝胶渗透色谱 GPC）
     * 价格：原价/现价（如：¥400 → ¥312）
     * 满意度（如：99%）
     * 预约次数（如：10987次）
     * 服务周期（如：平均2.5-6.0个工作日）
     * 标签：热门、推荐、新品
   
   - 筛选与排序：
     * 按价格排序
     * 按预约次数排序
     * 按服务周期排序
     * 按测试项目筛选
     * 按仪器型号筛选

2. **项目详情页**
   - **顶部信息区**：
     * 项目名称、价格、满意度
     * 仪器型号（如：美国 Agilent-1260 Infinity II）
     * 服务周期
     * 实验室信息（名称、位置）
   
   - **详情分类Tab**（可配置显示/隐藏）：
     * **项目介绍**：检测原理、应用领域
     * **预约须知**：样品准备、注意事项
     * **样品要求**：样品类型、数量、状态要求
     * **常见问题**：FAQ列表
     * **结果展示**：样本报告、数据示例
   
   - **底部操作区**：
     * 收藏按钮
     * 咨询客服按钮
     * 立即预约按钮（突出显示）

3. **优惠券规则**
   - 优惠券展示：
     * 可用优惠券列表
     * 优惠券面额、折扣、使用条件
     * 有效期倒计时
   
   - 优惠券使用规则：
     * 不可叠加使用
     * 按原价打折（如原价400元，7折券后280元）
     * 后台可针对客户发放定向优惠券
   
   - 优惠券领取：
     * 新人优惠券
     * 活动优惠券
     * 满减优惠券
     * 折扣优惠券

4. **评价与问答**
   - 用户评价列表
   - 评价筛选（好评/中评/差评）
   - 问答区（用户提问、客服回答）

**数据表设计要点**：
```
test_projects (检测项目表)
- id
- name: 项目名称
- category: 分类
- equipment_id: 仪器ID
- lab_id: 实验室ID
- original_price: 原价
- current_price: 现价
- satisfaction: 满意度
- booking_count: 预约次数
- service_cycle_min: 最短周期
- service_cycle_max: 最长周期
- introduction: 项目介绍
- booking_notice: 预约须知
- sample_requirements: 样品要求
- faq: 常见问题（JSON）
- result_samples: 结果展示（JSON）
- status: 状态（上架/下架）
- created_at/updated_at

coupons (优惠券表)
- id
- name: 优惠券名称
- type: 类型（折扣/满减）
- discount: 折扣（如0.7表示7折）
- min_amount: 最低消费金额
- max_discount: 最高优惠金额
- valid_from: 生效时间
- valid_to: 过期时间
- total_quantity: 总数量
- used_quantity: 已使用数量
- applicable_projects: 适用项目（JSON）
- status: 状态

user_coupons (用户优惠券表)
- id
- user_id: 用户ID
- coupon_id: 优惠券ID
- status: 状态（未使用/已使用/已过期）
- received_at: 领取时间
- used_at: 使用时间
- order_id: 使用订单ID
```

---

#### 2.3.2 下单流程模块
**功能描述**：用户选择检测项目并提交订单

**详细需求**：
1. **分组下单**
   - 点击"立即预约"进入下单页
   - 支持分组下单：A组/B组/C组/D组...
   - 每组独立配置：
     * 样品信息
     * 测试要求
     * 特殊说明
   - 价格计算：每组价格叠加
   - 添加/删除分组

2. **样品信息填写**
   - **样品基础信息**：
     * 样品数量（输入框）
     * 样品名称（输入框）
     * 样品编号（输入框或自动生成）
   
   - **样品特性（根据项目类型动态显示）**：
     * 样品类型：单选（如：有机小分子/多肽/蛋白质/聚合物）
     * 样品成分：输入或多选
     * 样品状态：单选（固体/液体/气体）
     * 样品溶解性：单选（易溶/难溶/不溶）
     * 分子量范围：输入
     * 纯度：输入
     * 其他特性：输入框
   
   - **特殊要求（红色字体提示）**：
     * "为防止流动相选择有误导致测试问题，请备注样品具体物质，切勿只备注元素或模糊信息"
     * "易燃易爆样品需特殊说明"
     * "活性样品需注明保存条件"
   
   - **附件上传**：
     * 下载预约单模板
     * 上传填写好的预约单
     * 上传样品说明文档（PDF、Word、图片）
     * 上传样品照片

3. **草稿保存功能**
   - 下单过程中随时保存草稿
   - 保存内容：
     * 已选择的项目
     * 已填写的样品信息
     * 分组信息
     * 附件
   - 草稿列表管理：
     * 继续编辑
     * 删除草稿
     * 草稿有效期（如30天）

4. **表单验证**
   - 必填项提示
   - 格式校验（手机号、邮箱等）
   - 数值范围校验
   - 附件大小限制
   - 实时错误提示

**数据表设计要点**：
```
order_samples (订单样品表)
- id
- order_id: 订单ID
- group_name: 分组名称（A组/B组）
- sample_count: 样品数量
- sample_name: 样品名称
- sample_code: 样品编号
- sample_type: 样品类型
- sample_properties: 样品特性（JSON）
- special_requirements: 特殊要求
- attachments: 附件（JSON）

order_drafts (订单草稿表)
- id
- user_id: 用户ID
- project_id: 项目ID
- draft_data: 草稿数据（JSON）
- created_at: 创建时间
- updated_at: 更新时间
- expires_at: 过期时间
```

---

#### 2.3.3 物流与样品回收模块
**功能描述**：样品寄送和回收管理

**详细需求**：
1. **物流方式选择（三选一）**

   **方式一：自行邮寄**
   - 显示全国办事处地址列表：
     * 城市：西安、郑州、北京、上海、广州、成都等
     * 详细地址
     * 收件人
     * 联系电话
     * 邮编
   - 温馨提示：
     * "请对样品拍照留存"
     * "易碎样品请妥善包装"
     * "不稳定样品请注明保存条件"
     * "包裹上请标注订单号"
   - 快递单号填写（选填）

   **方式二：上门取样**
   - 取样地址选择：
     * 省市选择（二级联动）
     * 高校/机构选择（搜索或列表）
     * 楼栋/学院（输入）
     * 楼层/房间（输入）
     * 详细地址（输入）
   
   - 取样联系信息：
     * 联系人姓名
     * 联系电话
     * 备用电话（选填）
   
   - 取样日期选择：
     * 日历控件选择日期
     * 可选范围：最近3周
     * 不可选日期灰色显示，hover提示"取样员暂时无法取样"
     * 时间段选择：上午(9:00-12:00)/下午(14:00-18:00)
   
   - 特殊说明：
     * "当天17:00后下单可能无法当天取样"
     * "紧急订单请联系专属顾问"
     * "取样员会提前30分钟电话联系"
   
   - 取样费用：
     * 根据距离计算（可配置）
     * 首次取样可能免费（营销活动）

   **方式三：自己送样**
   - 显示实验室地址：
     * 实验室名称
     * 详细地址
     * 联系人
     * 联系电话
     * 工作时间
   - 温馨提示：
     * "请提前联系实验室确认送样时间"
     * "请自行编号样品"
     * "请携带订单号"
     * "特殊运输条件需明确说明（如低温、避光）"

2. **样品回收**
   - **是否回收选择**：
     * 不回收（默认）
     * 回收（需支付回收费用）
   
   - **回收提醒弹窗**（选择回收时弹出）：
     ```
     样品回收提醒
     1. 样品经测试后可能存在污染或损坏风险
     2. 易碎、易挥发样品回收过程中可能损失
     3. 样品回收物流时间较长，请耐心等待
     4. 样品丢失赔付规则：
        - 未保价：最高赔付150元测试费
        - 已保价：按保价额度赔付
     5. 以下情形不承担赔偿责任：
        - 自然灾害、不可抗力
        - 样品本身缺陷导致的损坏
        - 合理损耗
     
     [我已知晓] [取消回收]
     ```
   
   - **样品保价**：
     * 不保价（默认）
     * 保价选项：
       - 保费50元（最高赔付150元）
       - 保费100元（最高赔付500元）
       - 保费XXX元（最高赔付1000元）
       - 自定义保价（保费=保价金额×费率）
   
   - **回收地址填写**：
     * 收件人姓名
     * 联系电话
     * 省市区选择（三级联动）
     * 详细地址
     * 邮编（选填）
     * 保存为常用地址（复选框）
   
   - **指派实验室**：
     * 自动指派（默认）
     * 与之前测试同设备（如之前有测试记录）
     * 系统自动匹配最近的实验室

3. **物流追踪**
   - 寄送状态：
     * 待寄送
     * 已揽件
     * 运输中
     * 已送达
   - 回收状态：
     * 待发出
     * 已发出
     * 运输中
     * 已签收
   - 物流信息实时更新
   - 异常情况提醒

**数据表设计要点**：
```
order_logistics (订单物流表)
- id
- order_id: 订单ID
- shipping_method: 物流方式（1自行邮寄/2上门取样/3自己送样）
- shipping_address: 寄送地址（JSON）
- pickup_info: 取样信息（JSON）
- tracking_no: 快递单号
- shipping_status: 寄送状态
- shipping_time: 寄送时间
- received_time: 收样时间

sample_return (样品回收表)
- id
- order_id: 订单ID
- is_return: 是否回收
- return_fee: 回收费用
- insurance_fee: 保价费用
- insurance_amount: 保价金额
- return_address: 回收地址（JSON）
- lab_id: 指派实验室ID
- tracking_no: 快递单号
- return_status: 回收状态
- sent_time: 发出时间
- received_time: 签收时间

logistics_offices (办事处地址表)
- id
- city: 城市
- address: 详细地址
- contact_person: 联系人
- contact_phone: 联系电话
- postcode: 邮编
- status: 状态（启用/停用）

pickup_schedule (取样排期表)
- id
- date: 日期
- time_slot: 时间段
- area: 区域
- capacity: 容量
- booked: 已预约数量
- status: 状态（可预约/已满/不可用）
```

---

#### 2.3.4 费用与订单生成模块
**功能描述**：计算订单总费用并生成订单

**详细需求**：
1. **费用计算规则**
   ```
   总费用 = 测试费用 + 加急服务费 + 取样费 + 样品回收费 + 样品保价费 - 优惠券抵扣金额
   ```
   
   **各项费用明细**：
   - **测试费用**：
     * 按分组数量叠加
     * 每组价格 = 项目单价 × 样品数量
     * 总测试费 = Σ(各组价格)
   
   - **加急服务费**（可选）：
     * 加急费 = 测试费用 × 50%
     * 最低收费：100元（不足100元按100元计算）
     * 需与技术顾问确认
     * 加急说明："加急服务将优先处理您的订单，预计X个工作日完成"
   
   - **取样费**（上门取样时产生）：
     * 根据距离阶梯计费
     * 可能免费（营销活动）
   
   - **样品回收费**：
     * 固定费用（可后台配置，如30元）
   
   - **样品保价费**：
     * 根据保价档次确定
   
   - **优惠券抵扣**：
     * 折扣券：按原价打折
     * 满减券：满足条件直接减免
     * 抵扣规则验证

2. **费用明细展示**
   - 费用明细卡片：
     ```
     ---------------------------
     测试费用              ¥312.00
     加急服务费            ¥156.00
     取样费                 ¥20.00
     样品回收费             ¥30.00
     样品保价费             ¥50.00
     优惠券抵扣            -¥50.00
     ---------------------------
     应付总额              ¥518.00
     ---------------------------
     ```
   - 每项费用可点击查看计算详情
   - 实时计算，选项变化时立即更新

3. **订单号生成规则**
   - 格式：年月日(8位) + 今日系统总下单数量(4位)
   - 示例：
     * 202501010001（2025年1月1日第1单）
     * 202501010002（2025年1月1日第2单）
     * 202501019999（2025年1月1日第9999单）
   - 每日0点重置计数器
   - 订单号全局唯一

4. **优惠券使用**
   - **可用优惠券列表**：
     * 显示可用优惠券数量
     * 点击展开优惠券列表
     * 每个优惠券显示：
       - 优惠券名称
       - 折扣/减免金额
       - 使用条件（如：满300元可用）
       - 有效期（如：至2025-06-27）
       - 使用说明（如："9折优惠券，创建/加入团队可用"）
   
   - **优惠券选择**：
     * 单选（不可叠加）
     * 选中后自动计算优惠金额
     * 不满足条件的优惠券灰色显示，标注原因
   
   - **优惠券验证**：
     * 验证有效期
     * 验证使用条件
     * 验证适用项目
     * 验证使用次数

5. **订单提交**
   - 提交前检查：
     * 必填项完整性
     * 样品信息合规性
     * 联系信息有效性
     * 库存充足性
   
   - 提交流程：
     * 点击"提交订单"
     * 生成订单号
     * 冻结优惠券（标记为使用中）
     * 跳转支付页面
   
   - 提交失败处理：
     * 显示失败原因
     * 保留已填写信息
     * 可重新提交

6. **订单确认页**
   - 订单号醒目显示
   - 订单详情汇总
   - 支付倒计时（如：请在24小时内完成支付）
   - 支付方式选择
   - 订单条款确认
   - 温馨提示

**数据表设计要点**：
```
order_fees (订单费用表)
- id
- order_id: 订单ID
- test_fee: 测试费用
- urgent_fee: 加急费用
- pickup_fee: 取样费用
- return_fee: 回收费用
- insurance_fee: 保价费用
- coupon_discount: 优惠券抵扣
- total_fee: 总费用
- paid_amount: 已支付金额
- unpaid_amount: 未支付金额

order_number_sequence (订单号序列表)
- id
- date: 日期
- last_sequence: 最后序号
- updated_at: 更新时间
```

---

### 3.4 实验室加盟合作模块（对标eceshi核心生态）⭐

**功能描述**：实验室在线申请入驻，通过审核后成为平台合作实验室

**业务价值**：
- 扩大平台服务能力和覆盖范围
- 盘活闲置实验室资源
- 建立实验室生态网络
- 参考eceshi的加盟模式

**详细需求**：

1. **加盟申请（实验室端）**
   - **申请入口**：
     * 网站首页"加盟合作"入口
     * 填写加盟申请表单
   
   - **基础信息**：
     * 实验室名称
     * 所属机构（高校/科研院所/企业）
     * 所在地区（省市区）
     * 实验室地址
     * 成立时间
     * 联系人姓名、职务
     * 联系电话、邮箱
   
   - **资质证明**：
     * 营业执照/事业单位法人证书（上传）
     * CNAS认证证书（可选，上传）
     * CMA认证证书（可选，上传）
     * ISO质量体系认证（可选）
     * 其他荣誉证书
   
   - **设备能力**：
     * 设备清单（名称、型号、数量）
     * 检测项目列表
     * 年检测能力（样品数量）
     * 特色检测项目
   
   - **合作意向**：
     * 期望合作模式（纯佣金/固定费用）
     * 期望佣金比例
     * 可接单量预估
     * 服务承诺（如48小时响应）
   
   - **案例展示**（可选）：
     * 典型检测案例
     * 合作客户（脱敏）
     * 发表论文
   
   - 提交申请

2. **审核流程（平台端）**
   - **初审**（1-2个工作日）：
     * 审核基础信息完整性
     * 验证联系方式
     * 初步评估资质
     * 通过/退回/拒绝
   
   - **实地考察**（可选，针对重点实验室）：
     * 预约上门考察
     * 查看设备和环境
     * 面谈负责人
     * 拍照记录
   
   - **终审**：
     * 综合评估实验室能力
     * 确定合作等级（金牌/银牌/普通）
     * 协商佣金比例和结算周期
     * 通过/拒绝
   
   - **签约**：
     * 发送电子合作协议
     * 实验室在线签署
     * 平台盖章
     * 双方各持一份

3. **入驻配置（实验室端）**
   - 审核通过后开通实验室管理账号
   - 完善实验室主页信息：
     * 实验室简介
     * 环境照片
     * 设备照片
     * 团队介绍
     * 服务承诺
     * 联系方式
   - 录入设备信息（详见3.1.1）
   - 设置接单规则：
     * 可接单时间
     * 样品要求
     * 定价策略
   - 开始接单

4. **合作等级与权益**
   
   | 等级 | 入驻条件 | 平台佣金 | 权益 |
   |-----|---------|---------|------|
   | 金牌实验室 | CNAS认证 + 年检测5000+样品 | 15% | 首页展示、优先推荐、专属运营支持 |
   | 银牌实验室 | CMA认证 + 年检测2000+样品 | 20% | 分类页推荐、运营支持 |
   | 普通实验室 | 基本资质齐全 | 25% | 正常展示 |

5. **实验室主页展示（用户可见）**
   - 实验室名称、logo
   - 认证标识（CNAS/CMA）
   - 等级徽章（金牌/银牌）
   - 综合评分（星级）
   - 所在地区
   - 设备列表
   - 检测项目
   - 服务承诺
   - 合作客户（脱敏展示，如"某985高校"）
   - 用户评价
   - 联系方式

6. **合作管理（平台端）**
   - 实验室列表：
     * 筛选：等级、地区、认证
     * 搜索：名称、项目
   - 实验室详情查看
   - 合作协议查看
   - 结算管理：
     * 按月结算
     * 自动生成结算单
     * 确认并支付
   - 绩效管理：
     * 接单量统计
     * 完成率
     * 好评率
     * 投诉率
   - 等级调整（年度评估）
   - 暂停/终止合作

**数据表设计**：
```
lab_applications (实验室申请表)
- id
- lab_name: 实验室名称
- institution: 所属机构
- province/city/district: 省市区
- address: 详细地址
- established_date: 成立时间
- contact_person: 联系人
- contact_title: 联系人职务
- contact_phone: 联系电话
- contact_email: 邮箱
- business_license: 营业执照路径
- cnas_certificate: CNAS证书路径
- cma_certificate: CMA证书路径
- equipment_list: 设备清单（JSON）
- test_items: 检测项目（JSON）
- annual_capacity: 年检测能力
- cooperation_mode: 合作模式
- expected_commission: 期望佣金比例
- service_promise: 服务承诺
- cases: 案例展示（JSON）
- status: 状态（待审核/初审通过/考察中/已通过/已拒绝）
- reject_reason: 拒绝原因
- created_at: 申请时间
- reviewed_at: 审核时间

laboratories (实验室表 - 已入驻)
- id
- lab_name: 实验室名称
- logo: logo路径
- institution: 所属机构
- province/city/district: 省市区
- address: 详细地址
- description: 简介
- environment_photos: 环境照片（JSON）
- team_intro: 团队介绍
- certifications: 认证（JSON：CNAS/CMA/ISO）
- level: 等级（1金牌/2银牌/3普通）
- commission_rate: 佣金比例
- settlement_cycle: 结算周期（天）
- contact_person: 联系人
- contact_phone: 联系电话
- rating: 综合评分
- total_orders: 累计订单数
- completion_rate: 完成率
- satisfaction_rate: 满意度
- status: 状态（正常/暂停/终止）
- joined_at: 入驻时间

lab_agreements (合作协议表)
- id
- lab_id: 实验室ID
- agreement_no: 协议编号
- agreement_content: 协议内容
- commission_rate: 佣金比例
- settlement_cycle: 结算周期
- valid_from: 生效日期
- valid_to: 到期日期
- lab_signature: 实验室签名
- platform_signature: 平台签名
- signed_at: 签署时间
- status: 状态（生效中/已到期/已终止）

lab_settlements (实验室结算表)
- id
- lab_id: 实验室ID
- settlement_month: 结算月份
- total_orders: 订单数量
- total_revenue: 订单总额
- commission: 平台佣金
- lab_income: 实验室收入
- settlement_date: 结算日期
- payment_date: 支付日期
- status: 状态（待结算/已结算/已支付）
```

---

## 三、数据库设计概览

### 3.1 核心数据表列表（更新版）

| 模块 | 表名 | 说明 | 新增⭐ |
|------|------|------|------|
| 用户模块 | users | 用户基础信息表 | |
| | user_certification | 用户认证信息表 | |
| | user_membership | 用户会员表 | ⭐ |
| | user_points | 用户积分表 | |
| | user_coupons | 用户优惠券表 | |
| | user_advisors | 用户顾问表 | ⭐ |
| 实验室模块 | laboratories | 实验室信息表 | |
| | lab_applications | 实验室申请表 | ⭐ |
| | lab_agreements | 合作协议表 | ⭐ |
| | lab_settlements | 实验室结算表 | ⭐ |
| | equipment | 设备信息表 | |
| | lab_finance | 实验室财务表 | |
| 订单模块 | orders | 订单主表 | |
| | order_samples | 订单样品表 | |
| | order_fees | 订单费用表 | |
| | order_status_log | 订单状态日志表 | |
| | order_logistics | 订单物流表 | |
| | order_drafts | 订单草稿表 | |
| 云现场模块 | cloud_lab_services | 云现场服务表 | ⭐ |
| | cloud_bookings | 云现场预约表 | ⭐ |
| 需求模块 | user_demands | 用户需求表 | ⭐ |
| | demand_quotes | 需求报价表 | ⭐ |
| | demand_communications | 需求沟通记录表 | ⭐ |
| 项目模块 | test_projects | 检测项目表 | |
| | project_categories | 项目分类表 | ⭐ |
| | test_data | 测试数据表 | |
| | test_reports | 测试报告表 | |
| 支付模块 | payments | 支付记录表 | |
| | prepaid_accounts | 预付账户表 | |
| | prepaid_transactions | 预付交易记录表 | |
| | prepaid_promotions | 预付充值活动表 | ⭐ |
| | invoices | 发票表 | |
| 营销模块 | coupons | 优惠券表 | |
| | membership_benefits | 会员权益配置表 | ⭐ |
| | point_products | 积分商品表 | |
| | invitations | 邀请记录表 | |
| | rebates | 返利记录表 | |
| | withdrawals | 提现记录表 | |
| 系统模块 | logistics_offices | 办事处地址表 | |
| | pickup_schedule | 取样排期表 | |
| | sample_return | 样品回收表 | |
| | system_config | 系统配置表 | |
| | operation_logs | 操作日志表 | |

**新增表数量**：14张（标注⭐）  
**总表数量**：40+张

### 3.2 数据库设计原则
1. **规范化设计**：满足第三范式，避免数据冗余
2. **性能优化**：合理设置索引，优化查询性能
3. **数据安全**：敏感信息加密存储
4. **可扩展性**：预留扩展字段，使用JSON存储灵活数据
5. **数据完整性**：设置外键约束、唯一约束、非空约束
6. **审计追踪**：关键表添加created_at、updated_at、deleted_at字段

---

## 四、技术架构与技术选型

### 4.1 整体架构

```
┌─────────────────────────────────────────────────────────┐
│                        用户层                            │
│   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐ │
│   │ 小程序(微信) │  │ 小程序(支付宝)│  │  Web网站     │ │
│   └──────────────┘  └──────────────┘  └──────────────┘ │
└─────────────────────────────────────────────────────────┘
                            ▼
┌─────────────────────────────────────────────────────────┐
│                      API网关层                           │
│             (Nginx + Kong/阿里云API Gateway)            │
│           负载均衡、限流、鉴权、日志、监控                │
└─────────────────────────────────────────────────────────┘
                            ▼
┌─────────────────────────────────────────────────────────┐
│                    微服务应用层                          │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐  │
│  │用户服务  │ │订单服务  │ │支付服务  │ │实验室服务│  │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘  │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐  │
│  │项目服务  │ │物流服务  │ │营销服务  │ │消息服务  │  │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘  │
└─────────────────────────────────────────────────────────┘
                            ▼
┌─────────────────────────────────────────────────────────┐
│                      中间件层                            │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐  │
│  │  Redis   │ │RabbitMQ  │ │   OSS    │ │Elasticsearch│
│  │  缓存    │ │  消息队列 │ │ 文件存储 │ │  搜索引擎  │  │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘  │
└─────────────────────────────────────────────────────────┘
                            ▼
┌─────────────────────────────────────────────────────────┐
│                      数据层                              │
│  ┌──────────────┐       ┌──────────────┐               │
│  │   MySQL      │       │   MongoDB    │               │
│  │ 主从读写分离  │       │  日志/文档   │               │
│  └──────────────┘       └──────────────┘               │
└─────────────────────────────────────────────────────────┘
```

### 4.2 技术选型

#### 4.2.1 前端技术栈

**小程序端**：
- **微信小程序**：原生小程序开发 + uni-app（可选）
- **支付宝小程序**：uni-app多端适配
- **UI框架**：Vant Weapp / uni-ui
- **状态管理**：Vuex / Pinia
- **网络请求**：Axios封装
- **图表**：ECharts / uCharts

**Web网站**：
- **前端框架**：Vue 3 + TypeScript
- **构建工具**：Vite
- **UI组件库**：Element Plus / Ant Design Vue
- **状态管理**：Pinia
- **路由**：Vue Router
- **HTTP客户端**：Axios
- **图表**：ECharts
- **富文本编辑器**：Quill / TinyMCE
- **代码规范**：ESLint + Prettier

**实验室管理端（后台）**：
- **前端框架**：Vue 3 + TypeScript
- **UI框架**：Ant Design Vue / Element Plus
- **其他同Web网站**

#### 4.2.2 后端技术栈

**核心框架**：
- **语言**：Java 11+ 或 Node.js (TypeScript)
- **框架**：Spring Boot 2.7+ / NestJS
- **API文档**：Swagger / OpenAPI 3.0
- **参数验证**：Hibernate Validator / class-validator
- **日志**：SLF4J + Logback / Winston

**微服务框架**（可选，初期可单体应用）：
- **Spring Cloud**：
  - Spring Cloud Gateway（网关）
  - Spring Cloud OpenFeign（服务调用）
  - Spring Cloud Alibaba Nacos（服务注册与配置中心）
  - Spring Cloud Alibaba Sentinel（限流降级）
- **或 NestJS + Consul + Kong**

**数据库**：
- **关系型数据库**：MySQL 8.0+
  - 主从复制、读写分离
  - 分库分表：ShardingSphere（订单量大时）
- **NoSQL数据库**：
  - Redis 6.0+（缓存、分布式锁、会话）
  - MongoDB 4.4+（日志、文档）
- **ORM框架**：
  - MyBatis-Plus（Java）
  - TypeORM（Node.js）

**消息队列**：
- **RabbitMQ** 或 **RocketMQ**
  - 订单异步处理
  - 消息通知
  - 数据同步

**文件存储**：
- **阿里云OSS** 或 **腾讯云COS**
  - 测试数据文件
  - 报告文件
  - 用户上传附件
  - 图片

**搜索引擎**：
- **Elasticsearch 7.x**（可选，项目量大时）
  - 检测项目搜索
  - 订单搜索
  - 日志分析

**第三方服务**：
- **支付**：支付宝开放平台、微信支付
- **短信**：阿里云短信服务、腾讯云短信
- **邮件**：阿里云邮件推送
- **物流**：快递鸟API、菜鸟物流API

#### 4.2.3 运维与监控

**容器化**：
- **Docker**：容器化部署
- **Docker Compose**：本地开发环境
- **Kubernetes**：生产环境编排（可选）

**CI/CD**：
- **Git**：代码版本管理（GitHub / GitLab）
- **Jenkins** 或 **GitLab CI**：持续集成/部署
- **自动化测试**：Jest / JUnit

**监控与日志**：
- **应用监控**：
  - Spring Boot Actuator + Prometheus + Grafana
  - 或 阿里云ARMS
- **日志收集**：
  - ELK Stack（Elasticsearch + Logstash + Kibana）
  - 或 阿里云日志服务SLS
- **链路追踪**：
  - Spring Cloud Sleuth + Zipkin
  - 或 SkyWalking

**服务器**：
- **云服务商**：阿里云 / 腾讯云 / AWS
- **负载均衡**：SLB / CLB
- **CDN**：静态资源加速

---

## 五、开发计划与时间安排（对标eceshi优化版）

### 5.1 项目阶段划分

项目分为5个阶段，总计约**24-28周**（6-7个月）

**说明**：对标eceshi后新增了云现场服务、发布需求、实验室加盟等核心功能，开发周期相应延长

```
阶段一：需求分析与设计（2-3周）
阶段二：核心功能开发（12-14周）
阶段三：集成测试与优化（4周）
阶段四：用户验收与试运行（3周）
阶段五：正式上线与运维（1周 + 持续）
```

**新增开发内容**（对标eceshi）：
- ⭐ 云现场服务模块（2周）
- ⭐ 发布需求模块（2周）
- ⭐ 实验室加盟模块（2周）
- ⭐ 会员权益体系（1周）
- ⭐ 专属顾问功能（1周）

### 5.2 详细开发计划

---

#### 阶段一：需求分析与设计（第1-2周）

| 任务 | 负责人 | 工期 | 产出 |
|------|--------|------|------|
| 需求评审会议 | 产品经理 + 全体 | 1天 | 需求确认单 |
| 原型设计 | UI/UX设计师 | 3天 | 原型图（Figma） |
| UI设计 | UI设计师 | 5天 | UI设计稿 |
| 数据库设计 | 后端架构师 | 3天 | 数据库设计文档、E-R图 |
| 接口设计 | 后端负责人 | 3天 | API接口文档（Swagger） |
| 技术方案评审 | 技术团队 | 1天 | 技术方案文档 |

**里程碑**：完成设计文档，通过评审

---

#### 阶段二：核心功能开发（第3-12周）

##### 第一迭代：用户基础功能（第3-4周）

**前端开发（小程序 + Web）**：
| 功能模块 | 工期 | 优先级 | eceshi对标 |
|----------|------|--------|-----------|
| 用户注册/登录 | 2天 | P0 | ✅ |
| 实名认证页面 | 3天 | P0 | ✅ |
| 个人中心页面 | 2天 | P0 | ✅ 我的订单 |
| 我的订单列表 | 2天 | P0 | ✅ |
| 项目列表页（分类导航） | 3天 | P0 | ✅ 电镜专场等分类 |
| 项目详情页 | 3天 | P0 | ✅ |

**后端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 用户注册/登录接口 | 2天 | P0 |
| JWT鉴权中间件 | 1天 | P0 |
| 用户认证接口 | 2天 | P0 |
| 用户信息管理接口 | 2天 | P0 |
| 检测项目查询接口 | 2天 | P0 |
| 数据库初始化 | 1天 | P0 |

**测试**：
- 单元测试
- 接口测试

**里程碑**：用户可以注册、登录、完成认证、浏览项目

---

##### 第二迭代：下单与支付功能（第5-7周）

**前端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 下单流程页面 | 5天 | P0 |
| 样品信息填写 | 3天 | P0 |
| 物流方式选择 | 3天 | P0 |
| 费用计算与展示 | 2天 | P0 |
| 支付页面 | 3天 | P0 |
| 支付结果页 | 1天 | P0 |
| 订单详情页 | 2天 | P0 |

**后端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 订单创建接口 | 3天 | P0 |
| 订单查询接口 | 2天 | P0 |
| 费用计算逻辑 | 3天 | P0 |
| 支付宝支付集成 | 3天 | P0 |
| 微信支付集成 | 3天 | P0 |
| 支付回调处理 | 2天 | P0 |
| 订单状态管理 | 2天 | P0 |
| 草稿保存接口 | 1天 | P1 |

**测试**：
- 下单流程测试
- 支付测试（沙箱环境）

**里程碑**：用户可以完成下单和支付流程

---

##### 第三迭代：实验室管理端（第8-10周）

**前端开发（后台管理系统）**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 实验室登录页面 | 1天 | P0 |
| 设备管理页面 | 3天 | P0 |
| 订单管理页面 | 4天 | P0 |
| 订单详情页 | 2天 | P0 |
| 数据上传页面 | 3天 | P0 |
| 收益统计页面 | 3天 | P0 |
| 报表导出功能 | 2天 | P1 |

**后端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 实验室登录接口 | 1天 | P0 |
| 设备管理接口 | 3天 | P0 |
| 订单分配逻辑 | 2天 | P0 |
| 订单接单/拒单接口 | 2天 | P0 |
| 订单重新指派接口 | 1天 | P1 |
| 数据上传接口（OSS） | 3天 | P0 |
| 数据分类逻辑 | 2天 | P0 |
| 报告生成接口 | 2天 | P0 |
| 收益核算接口 | 2天 | P0 |
| 报表导出接口 | 2天 | P1 |

**测试**：
- 实验室端功能测试
- 订单流程端到端测试

**里程碑**：实验室可以接单、上传数据、核算收益

---

##### 第四迭代：发票与预付功能（第11周）

**前端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 开票申请页面 | 2天 | P0 |
| 开票记录页面 | 1天 | P0 |
| 预付管理页面 | 2天 | P0 |
| 预付充值页面 | 2天 | P0 |

**后端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 开票申请接口 | 2天 | P0 |
| 发票生成逻辑 | 2天 | P0 |
| 预付账户管理 | 2天 | P0 |
| 预付充值接口 | 2天 | P0 |
| 信用额度管理 | 1天 | P0 |

**里程碑**：用户可以申请开票、管理预付账户

---

##### 第五迭代：会员与预付功能（第12周）⭐对标eceshi

**前端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 会员中心页面 | 3天 | P0 |
| 预付有礼页面 | 2天 | P0 |
| 会员权益展示 | 2天 | P0 |
| 充值页面 | 2天 | P0 |

**后端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 会员等级管理 | 2天 | P0 |
| 会员权益配置 | 2天 | P0 |
| 预付充值活动 | 2天 | P0 |
| 充值赠送逻辑 | 2天 | P0 |
| 会员升级机制 | 1天 | P0 |

**里程碑**：会员体系上线，鼓励用户预付充值

---

##### 第六迭代：云现场服务（第13周）⭐对标eceshi核心

**前端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 云现场服务列表 | 2天 | P0 |
| 云现场服务详情 | 2天 | P0 |
| 预约日历选择 | 3天 | P0 |
| 预约订单管理 | 2天 | P0 |

**后端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 云现场服务管理 | 2天 | P0 |
| 预约排期管理 | 3天 | P0 |
| 预约确认流程 | 2天 | P0 |
| 时长计费逻辑 | 2天 | P0 |

**实验室端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 云现场服务发布 | 2天 | P0 |
| 预约订单处理 | 2天 | P0 |
| 排期管理 | 2天 | P0 |

**里程碑**：云现场服务上线，用户可按小时预约设备

---

##### 第七迭代：发布需求功能（第14周）⭐对标eceshi核心

**前端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 发布需求页面 | 3天 | P0 |
| 需求列表页面 | 2天 | P0 |
| 报价查看与对比 | 3天 | P0 |
| 需求沟通页面 | 2天 | P0 |

**后端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 需求发布接口 | 2天 | P0 |
| 需求审核流程 | 2天 | P0 |
| 需求推送匹配 | 3天 | P0 |
| 报价管理接口 | 2天 | P0 |
| 需求转订单 | 2天 | P0 |

**实验室端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 需求推送展示 | 2天 | P0 |
| 报价提交页面 | 2天 | P0 |
| 报价管理 | 1天 | P0 |

**里程碑**：用户可发布需求，实验室可报价竞标

---

##### 第八迭代：实验室加盟（第15周）⭐对标eceshi生态

**前端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 加盟申请页面 | 3天 | P0 |
| 实验室主页展示 | 2天 | P0 |
| 加盟流程说明 | 1天 | P0 |

**后端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 加盟申请接口 | 2天 | P0 |
| 申请审核流程 | 3天 | P0 |
| 合作协议管理 | 2天 | P0 |
| 实验室结算 | 3天 | P0 |

**运营后台开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 申请审核页面 | 2天 | P0 |
| 实验室管理 | 2天 | P0 |
| 结算管理 | 2天 | P0 |

**里程碑**：实验室加盟通道开通，扩展平台生态

---

##### 第九迭代：营销与积分功能（第16周）

**前端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 优惠券页面 | 2天 | P1 |
| 积分城页面 | 2天 | P1 |
| 邀请好友页面 | 2天 | P1 |
| 提现页面 | 1天 | P1 |

**后端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 优惠券管理接口 | 2天 | P1 |
| 优惠券使用逻辑 | 2天 | P1 |
| 积分管理接口 | 2天 | P1 |
| 积分兑换接口 | 2天 | P1 |
| 邀请返利逻辑 | 2天 | P1 |
| 提现管理接口 | 1天 | P1 |

**里程碑**：完成营销功能

---

##### 第十迭代：专属顾问与客服（第17周）⭐对标eceshi服务

**前端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 我的顾问页面 | 2天 | P1 |
| 在线客服（集成） | 2天 | P0 |
| 顾问沟通页面 | 2天 | P1 |

**后端开发**：
| 功能模块 | 工期 | 优先级 |
|----------|------|--------|
| 顾问分配逻辑 | 2天 | P1 |
| 顾问管理 | 1天 | P1 |
| 客服系统对接 | 2天 | P0 |

**里程碑**：VIP用户享受专属顾问服务，所有用户可在线客服

---

#### 阶段三：集成测试与优化（第18-21周）

| 任务 | 工期 | 负责人 |
|------|------|--------|
| 功能测试（含新功能） | 7天 | 测试团队 |
| 性能测试 | 4天 | 测试+后端 |
| 兼容性测试 | 3天 | 测试+前端 |
| 安全测试 | 3天 | 安全工程师 |
| Bug修复（第一轮） | 4天 | 开发团队 |
| 回归测试 | 3天 | 测试团队 |
| Bug修复（第二轮） | 3天 | 开发团队 |
| 性能优化 | 4天 | 后端团队 |
| UI/UX优化 | 3天 | 前端+设计团队 |

**测试重点**（对标eceshi）：
- ✅ 订单全流程测试
- ✅ 支付流程测试（多种支付方式）
- ✅ 数据上传与下载测试
- ⭐ 云现场预约流程测试
- ⭐ 发布需求与报价流程测试
- ⭐ 实验室加盟审核流程测试
- ⭐ 会员权益与充值测试
- ✅ 并发测试（高峰期压力测试）
- ✅ 边界条件测试
- ✅ 安全漏洞扫描

**里程碑**：系统通过全面测试，主要Bug修复完毕

---

#### 阶段四：用户验收与试运行（第22-24周）

| 任务 | 工期 | 负责人 |
|------|------|--------|
| 内部验收 | 3天 | 产品+运营 |
| 用户手册编写（三端） | 3天 | 产品经理 |
| 实验室培训 | 2天 | 产品+技术 |
| 运营培训 | 1天 | 产品经理 |
| 小范围灰度发布 | 7天 | 运维+开发 |
| 邀请种子用户测试 | 5天 | 运营团队 |
| 邀请合作实验室测试 | 5天 | 商务团队 |
| 收集反馈 | 4天 | 产品+运营 |
| 问题修复与优化 | 3天 | 开发团队 |

**种子用户策略**（参考eceshi）：
- 邀请3-5所高校的科研团队试用
- 邀请2-3家优质实验室入驻
- 收集真实使用反馈
- 优化用户体验

**里程碑**：完成用户验收，准备正式上线

---

#### 阶段五：正式上线与运维（第25周+）

| 任务 | 工期 | 负责人 |
|------|------|--------|
| 生产环境部署 | 1天 | 运维团队 |
| 数据迁移（如有） | 1天 | 后端+运维 |
| 正式发布 | 1天 | 全体 |
| 监控配置 | 1天 | 运维团队 |
| 7×24小时值班 | 持续2周 | 全体轮班 |
| 运营推广（对标eceshi） | 持续 | 运营团队 |
| 实验室拓展 | 持续 | 商务团队 |
| 高校合作洽谈 | 持续 | 商务团队 |
| Bug修复与优化 | 持续 | 开发团队 |
| 功能迭代 | 持续 | 产品+开发 |

**运营推广策略**（参考eceshi）：
1. **品牌建设**：
   - 申请高新技术企业认证
   - 申请CNAS/CMA认证
   - 参加学术会议展示

2. **高校合作**：
   - 与高校签订合作协议
   - 在高校举办宣讲会
   - 提供学生优惠

3. **实验室拓展**：
   - 主动联系优质实验室
   - 参加实验室展会
   - 提供优惠入驻政策

4. **内容营销**：
   - 发布检测知识文章
   - 案例分享
   - 用户故事

5. **优惠活动**：
   - 新人优惠券
   - 预付有礼活动
   - 团队充值优惠

**里程碑**：系统正式上线运行

---

### 5.3 团队配置建议（对标eceshi优化）

| 角色 | 人数 | 职责 | 备注 |
|------|------|------|------|
| 产品经理 | 1-2 | 需求管理、产品设计、验收 | 复杂度增加，建议2人 |
| UI/UX设计师 | 1-2 | 原型设计、UI设计 | 三端设计，建议2人 |
| 前端工程师（小程序） | 2 | 小程序开发（微信+支付宝） | |
| 前端工程师（Web） | 3 | 网站+两个后台开发 | 用户端、实验室端、运营后台 |
| 后端工程师 | 4-5 | 后端开发 | 新增功能多，需4-5人 |
| 测试工程师 | 2-3 | 功能测试、自动化测试 | 测试范围扩大 |
| 运维工程师 | 1-2 | 部署、监控、安全 | |
| 项目经理 | 1 | 项目管理、协调 | |
| 商务经理 | 1 | 实验室拓展、商务合作 | ⭐新增 |
| 运营经理 | 1 | 用户运营、活动策划 | ⭐新增 |

**总计**：17-22人

**说明**：相比初版增加了5-8人，主要原因：
- 新增云现场、发布需求、实验室加盟等复杂功能
- 三端开发（用户端、实验室端、运营后台）
- 需要商务团队拓展实验室生态
- 需要运营团队推广平台

---

### 5.4 风险与应对

| 风险 | 等级 | 应对措施 |
|------|------|----------|
| 需求变更频繁 | 高 | 需求冻结机制、敏捷迭代 |
| 第三方接口对接问题 | 中 | 提前调研、预留缓冲时间 |
| 性能问题 | 中 | 早期性能测试、架构预留扩展性 |
| 人员变动 | 中 | 知识共享、代码规范、文档完善 |
| 进度延期 | 中 | 每日站会、周报、关键路径管理 |
| 安全问题 | 高 | 安全评审、渗透测试 |

---

## 六、功能实现优先级（对标eceshi优化版）

### 6.1 P0 优先级（必须实现，MVP第一期上线）

**基础功能**：
- [x] 用户注册/登录
- [x] 实名认证
- [x] 项目浏览（分类展示）
- [x] 下单流程
- [x] 支付（支付宝、微信）
- [x] 订单管理
- [x] 数据上传与下载

**实验室端**：
- [x] 实验室登录
- [x] 设备管理
- [x] 订单处理
- [x] 数据上传

**后台管理**：
- [x] 订单监控
- [x] 用户管理
- [x] 实验室管理

**核心差异化功能（对标eceshi）**⭐：
- [x] **会员权益体系**（银卡/金卡/白金卡）
- [x] **预付有礼**（充值赠送）
- [x] 在线客服（第三方集成）

### 6.2 P0+ 优先级（核心竞争力，第二期上线）

**eceshi核心功能对标**⭐：
- [ ] **云现场服务**（按小时预约设备）
- [ ] **发布需求**（用户主动发布，实验室竞标）
- [ ] **实验室加盟**（生态扩展）
- [ ] **专属顾问**（VIP用户1v1服务）

**说明**：这些功能是eceshi的核心差异化功能，建议在第二期尽快上线

### 6.3 P1 优先级（重要功能，第二/三期上线）

**用户端**：
- [ ] 开票申请
- [ ] 优惠券系统
- [ ] 积分系统
- [ ] 邀请好友返利
- [ ] 样品回收
- [ ] 订单评价与反馈
- [ ] 建议/投诉系统

**实验室端**：
- [ ] 报表导出
- [ ] 报告生成
- [ ] 联系信息修改
- [ ] 云现场排期管理
- [ ] 需求报价管理

**后台管理**：
- [ ] 优惠券发放
- [ ] 充值活动配置
- [ ] 实验室审核
- [ ] 结算管理
- [ ] 数据统计分析
- [ ] 财务对账

### 6.4 P2 优先级（增值功能，第三期及以后）

**增值服务**：
- [ ] 团队功能（团队预付共享）
- [ ] 积分城商城
- [ ] 提现功能
- [ ] 上门取样（需调度系统）
- [ ] 样品寄存服务
- [ ] 数据深度分析服务

**技术优化**：
- [ ] 智能推荐（AI推荐检测项目）
- [ ] 数据分析与BI
- [ ] 移动端APP（非小程序）
- [ ] 国际化（多语言）

**生态扩展**：
- [ ] 开放API（第三方接入）
- [ ] 仪器设备交易平台
- [ ] 科研社区论坛

### 6.5 功能上线路线图

```
第一期（MVP）：基础交易功能 + 会员预付
├─ 用户注册、认证、下单、支付
├─ 实验室接单、数据上传
├─ 会员体系、预付有礼
└─ 目标：验证商业模式，获取种子用户

第二期（核心竞争力）：eceshi差异化功能
├─ 云现场服务（新收入模式）
├─ 发布需求（提升用户粘性）
├─ 实验室加盟（扩展生态）
├─ 专属顾问（提升服务质量）
└─ 目标：建立竞争壁垒，快速扩张

第三期（完善体验）：补充功能
├─ 完善营销功能（积分、优惠券、邀请）
├─ 完善服务功能（开票、样品回收、评价）
├─ 完善管理功能（报表、对账、审核）
└─ 目标：提升用户体验，降低运营成本

第四期（生态扩展）：增值服务
├─ 团队功能、积分城
├─ 智能推荐、数据分析
├─ 开放API、生态合作
└─ 目标：构建生态闭环，多元化收入
```

---

## 七、关键技术实现要点

### 7.1 订单号生成

**需求**：订单号格式为 YYYYMMDD + 4位序号

**实现方案**：
```java
// 方案一：数据库序列表（推荐）
@Transactional
public String generateOrderNo() {
    String date = LocalDate.now().format(DateTimeFormatter.BASIC_ISO_DATE);
    
    // 查询或创建当天序列
    OrderSequence sequence = sequenceMapper.selectByDate(date);
    if (sequence == null) {
        sequence = new OrderSequence(date, 1);
        sequenceMapper.insert(sequence);
    } else {
        sequence.setLastSequence(sequence.getLastSequence() + 1);
        sequenceMapper.updateByDate(sequence);
    }
    
    // 生成订单号
    return date + String.format("%04d", sequence.getLastSequence());
}

// 方案二：Redis原子递增（高并发）
public String generateOrderNo() {
    String date = LocalDate.now().format(DateTimeFormatter.BASIC_ISO_DATE);
    String key = "order:sequence:" + date;
    
    Long sequence = redisTemplate.opsForValue().increment(key);
    if (sequence == 1) {
        // 设置过期时间为第二天
        redisTemplate.expireAt(key, LocalDate.now().plusDays(2).atStartOfDay());
    }
    
    return date + String.format("%04d", sequence);
}
```

### 7.2 费用计算

**需求**：复杂的费用计算逻辑

**实现方案**：
```java
public class OrderFeeCalculator {
    
    public OrderFee calculate(Order order) {
        OrderFee fee = new OrderFee();
        
        // 1. 测试费用
        BigDecimal testFee = calculateTestFee(order.getSamples());
        fee.setTestFee(testFee);
        
        // 2. 加急费用
        if (order.isUrgent()) {
            BigDecimal urgentFee = testFee.multiply(new BigDecimal("0.5"));
            if (urgentFee.compareTo(new BigDecimal("100")) < 0) {
                urgentFee = new BigDecimal("100");
            }
            fee.setUrgentFee(urgentFee);
        }
        
        // 3. 物流费用
        if (order.getShippingMethod() == ShippingMethod.PICKUP) {
            fee.setPickupFee(calculatePickupFee(order.getPickupAddress()));
        }
        
        // 4. 回收费用
        if (order.getSampleReturn() != null) {
            fee.setReturnFee(order.getSampleReturn().getReturnFee());
            fee.setInsuranceFee(order.getSampleReturn().getInsuranceFee());
        }
        
        // 5. 优惠券抵扣
        if (order.getCoupon() != null) {
            BigDecimal discount = calculateCouponDiscount(order.getCoupon(), testFee);
            fee.setCouponDiscount(discount);
        }
        
        // 6. 总费用
        BigDecimal totalFee = testFee
            .add(fee.getUrgentFee())
            .add(fee.getPickupFee())
            .add(fee.getReturnFee())
            .add(fee.getInsuranceFee())
            .subtract(fee.getCouponDiscount());
        fee.setTotalFee(totalFee);
        
        return fee;
    }
}
```

### 7.3 数据上传自动分类

**需求**：按订单号自动分类数据文件

**实现方案**：
```java
public class DataUploadService {
    
    @Transactional
    public void uploadBatch(List<MultipartFile> files) {
        for (MultipartFile file : files) {
            String filename = file.getOriginalFilename();
            
            // 从文件名提取订单号（如：202501010001_A1_XRD.raw）
            String orderNo = extractOrderNo(filename);
            
            // 验证订单号
            Order order = orderMapper.selectByOrderNo(orderNo);
            if (order == null) {
                throw new BusinessException("订单号不存在：" + orderNo);
            }
            
            // 上传到OSS
            String filePath = ossService.upload(file, "test-data/" + orderNo + "/");
            
            // 保存数据记录
            TestData testData = new TestData();
            testData.setOrderId(order.getId());
            testData.setFileName(filename);
            testData.setFilePath(filePath);
            testData.setFileSize(file.getSize());
            testDataMapper.insert(testData);
            
            // 更新订单状态
            if (order.getStatus() == OrderStatus.IN_PROGRESS) {
                order.setStatus(OrderStatus.COMPLETED);
                orderMapper.updateById(order);
            }
            
            // 发送通知
            notificationService.notifyDataUploaded(order.getUserId(), orderNo);
        }
    }
    
    private String extractOrderNo(String filename) {
        // 正则提取：前缀为日期+4位数字
        Pattern pattern = Pattern.compile("(\\d{12})");
        Matcher matcher = pattern.matcher(filename);
        if (matcher.find()) {
            return matcher.group(1);
        }
        throw new BusinessException("文件名格式错误，无法提取订单号：" + filename);
    }
}
```

### 7.4 支付回调处理

**需求**：处理支付宝/微信支付回调

**实现方案**：
```java
@RestController
@RequestMapping("/api/payment/callback")
public class PaymentCallbackController {
    
    // 支付宝回调
    @PostMapping("/alipay")
    public String alipayCallback(HttpServletRequest request) {
        Map<String, String> params = convertRequestParams(request);
        
        // 验签
        boolean signVerified = AlipaySignature.rsaCheckV1(params, 
            alipayPublicKey, charset, signType);
        
        if (!signVerified) {
            return "failure";
        }
        
        String outTradeNo = params.get("out_trade_no");
        String tradeStatus = params.get("trade_status");
        
        if ("TRADE_SUCCESS".equals(tradeStatus)) {
            // 处理支付成功
            paymentService.handlePaymentSuccess(outTradeNo, params);
        }
        
        return "success";
    }
    
    // 微信支付回调
    @PostMapping("/wechat")
    public String wechatCallback(@RequestBody String xmlData) {
        Map<String, String> params = WXPayUtil.xmlToMap(xmlData);
        
        // 验签
        if (!WXPayUtil.isSignatureValid(params, wechatApiKey)) {
            return buildWechatResponse("FAIL", "签名失败");
        }
        
        String outTradeNo = params.get("out_trade_no");
        String resultCode = params.get("result_code");
        
        if ("SUCCESS".equals(resultCode)) {
            paymentService.handlePaymentSuccess(outTradeNo, params);
        }
        
        return buildWechatResponse("SUCCESS", "OK");
    }
}

@Service
public class PaymentService {
    
    @Transactional
    public void handlePaymentSuccess(String outTradeNo, Map<String, String> params) {
        // 查询支付记录
        Payment payment = paymentMapper.selectByOutTradeNo(outTradeNo);
        
        // 防止重复处理
        if (payment.getStatus() == PaymentStatus.SUCCESS) {
            return;
        }
        
        // 更新支付状态
        payment.setStatus(PaymentStatus.SUCCESS);
        payment.setTransactionNo(params.get("trade_no"));
        payment.setPaidAt(new Date());
        paymentMapper.updateById(payment);
        
        // 更新订单状态
        Order order = orderMapper.selectById(payment.getOrderId());
        order.setStatus(OrderStatus.CONFIRMED);
        orderMapper.updateById(order);
        
        // 如果使用优惠券，更新优惠券状态
        if (order.getCouponId() != null) {
            UserCoupon coupon = userCouponMapper.selectById(order.getCouponId());
            coupon.setStatus(CouponStatus.USED);
            coupon.setUsedAt(new Date());
            userCouponMapper.updateById(coupon);
        }
        
        // 发送通知
        notificationService.notifyPaymentSuccess(order.getUserId(), order.getOrderNo());
    }
}
```

### 7.5 订单状态流转

**需求**：订单状态自动流转和权限控制

**实现方案**：
```java
@Service
public class OrderStateMachine {
    
    // 状态流转规则
    private static final Map<OrderStatus, List<OrderStatus>> STATE_TRANSITIONS = Map.of(
        OrderStatus.PENDING_PAYMENT, List.of(OrderStatus.CANCELLED, OrderStatus.CONFIRMED),
        OrderStatus.CONFIRMED, List.of(OrderStatus.WAITING_TEST, OrderStatus.CANCELLED),
        OrderStatus.WAITING_TEST, List.of(OrderStatus.IN_PROGRESS, OrderStatus.REJECTED),
        OrderStatus.IN_PROGRESS, List.of(OrderStatus.COMPLETED),
        OrderStatus.COMPLETED, List.of(OrderStatus.WAITING_REVIEW, OrderStatus.WAITING_INVOICE),
        OrderStatus.WAITING_REVIEW, List.of(OrderStatus.REVIEWED),
        OrderStatus.WAITING_INVOICE, List.of(OrderStatus.INVOICED)
    );
    
    public void changeStatus(Long orderId, OrderStatus targetStatus, String operator) {
        Order order = orderMapper.selectById(orderId);
        OrderStatus currentStatus = order.getStatus();
        
        // 验证状态流转是否合法
        if (!canTransition(currentStatus, targetStatus)) {
            throw new BusinessException("订单状态不能从 " + currentStatus + " 变更为 " + targetStatus);
        }
        
        // 更新订单状态
        order.setStatus(targetStatus);
        orderMapper.updateById(order);
        
        // 记录状态变更日志
        OrderStatusLog log = new OrderStatusLog();
        log.setOrderId(orderId);
        log.setStatus(targetStatus);
        log.setOperator(operator);
        log.setCreatedAt(new Date());
        orderStatusLogMapper.insert(log);
        
        // 触发后续逻辑
        handleStatusChange(order, targetStatus);
    }
    
    private boolean canTransition(OrderStatus from, OrderStatus to) {
        List<OrderStatus> allowedStatuses = STATE_TRANSITIONS.get(from);
        return allowedStatuses != null && allowedStatuses.contains(to);
    }
    
    private void handleStatusChange(Order order, OrderStatus status) {
        switch (status) {
            case CONFIRMED:
                // 通知实验室有新订单
                notificationService.notifyLabNewOrder(order.getLabId(), order.getOrderNo());
                break;
            case IN_PROGRESS:
                // 通知用户订单开始处理
                notificationService.notifyUserOrderInProgress(order.getUserId(), order.getOrderNo());
                break;
            case COMPLETED:
                // 通知用户订单完成
                notificationService.notifyUserOrderCompleted(order.getUserId(), order.getOrderNo());
                break;
        }
    }
}
```

---

## 八、部署方案

### 8.1 开发环境

```yaml
# docker-compose.yml
version: '3.8'

services:
  mysql:
    image: mysql:8.0
    environment:
      MYSQL_ROOT_PASSWORD: root123
      MYSQL_DATABASE: eceshi
    ports:
      - "3306:3306"
    volumes:
      - mysql_data:/var/lib/mysql
  
  redis:
    image: redis:6.2-alpine
    ports:
      - "6379:6379"
  
  rabbitmq:
    image: rabbitmq:3.9-management
    ports:
      - "5672:5672"
      - "15672:15672"
  
  mongodb:
    image: mongo:4.4
    ports:
      - "27017:27017"

volumes:
  mysql_data:
```

### 8.2 生产环境架构

```
                       ┌──────────────┐
                       │   DNS/CDN    │
                       └──────┬───────┘
                              │
                       ┌──────▼────────┐
                       │  负载均衡SLB  │
                       └──────┬────────┘
                              │
         ┌────────────────────┼────────────────────┐
         │                    │                    │
    ┌────▼────┐         ┌────▼────┐         ┌────▼────┐
    │ Web服务器1│         │ Web服务器2│         │ Web服务器3│
    │  Nginx   │         │  Nginx   │         │  Nginx   │
    └────┬────┘         └────┬────┘         └────┬────┘
         │                    │                    │
         └────────────────────┼────────────────────┘
                              │
                       ┌──────▼────────┐
                       │ 应用服务器集群 │
                       │ (Spring Boot) │
                       └──────┬────────┘
                              │
         ┌────────────────────┼────────────────────┐
         │                    │                    │
    ┌────▼────┐         ┌────▼────┐         ┌────▼────┐
    │ MySQL主 │───────▶ │ MySQL从1│         │ MySQL从2│
    └─────────┘ 主从复制 └─────────┘         └─────────┘
         │
    ┌────▼────┐         ┌──────────┐         ┌──────────┐
    │  Redis  │         │RabbitMQ  │         │   OSS    │
    │  集群   │         │  集群    │         │ 文件存储  │
    └─────────┘         └──────────┘         └──────────┘
```

---

## 九、与eceshi对比分析

### 9.1 功能对比

| 功能模块 | eceshi.com | 我们的平台 | 实现难度 | 优先级 |
|---------|-----------|-----------|---------|--------|
| 基础下单交易 | ✅ | ✅ | 中 | P0 |
| 会员权益体系 | ✅ | ✅ | 中 | P0 |
| 预付有礼 | ✅ | ✅ | 低 | P0 |
| 云现场服务 | ✅ | ✅ | 高 | P0+ |
| 发布需求 | ✅ | ✅ | 中 | P0+ |
| 实验室加盟 | ✅ | ✅ | 高 | P0+ |
| 专属顾问 | ✅ | ✅ | 中 | P0+ |
| 在线客服 | ✅ | ✅（集成） | 低 | P0 |
| 合作高校展示 | ✅ | ✅ | 低 | P1 |
| 建议/投诉 | ✅ | ✅ | 低 | P1 |
| CNAS/CMA认证 | ✅ | ⏳（申请中） | - | 运营层面 |

### 9.2 差异化竞争策略

#### 我们的优势方向：

1. **技术驱动**：
   - 更智能的实验室匹配算法
   - 更强大的数据分析能力
   - 更流畅的用户体验
   - 移动端优先策略

2. **服务创新**：
   - AI辅助样品咨询
   - 自动化报告生成
   - 实时进度追踪
   - 数据可视化分析

3. **生态开放**：
   - 开放API接口
   - 第三方系统对接
   - 高校系统集成
   - 科研社区建设

4. **定价策略**：
   - 前期更激进的优惠政策
   - 更灵活的会员体系
   - 更高的充值赠送比例
   - 学生专属优惠

### 9.3 运营策略对标

| 策略 | eceshi | 我们 |
|-----|--------|------|
| 目标客户 | 高校、科研机构、企业 | 同左，前期聚焦高校 |
| 获客渠道 | 线上推广 + 线下展会 | 同左 + 社交媒体 + KOL |
| 实验室拓展 | 加盟模式 | 同左 + 更优惠条件 |
| 品牌建设 | 国家高新技术企业、认证 | 申请同等资质 |
| 客户服务 | 1v1顾问、客服 | 同左 + AI客服 |

---

## 十、总结

本开发计划基于**eceshi.com真实运营案例**和原需求文档，详细规划了科研检测服务平台的功能实现和开发进度：

### 10.1 核心亮点

1. **对标真实案例**：参考eceshi的成熟运营模式，降低试错成本
2. **功能完整**：覆盖实验室管理端、用户端、加盟端、运营后台四大模块
3. **差异化竞争**：在对标基础上，通过技术和服务创新形成差异化
4. **分工明确**：前端、后端、测试、商务、运营各司其职
5. **进度合理**：24-28周完成开发，分5个阶段、10个迭代
6. **优先级清晰**：
   - P0：基础功能 + 会员预付（第一期MVP）
   - P0+：云现场、发布需求、实验室加盟（第二期核心竞争力）
   - P1：完善功能（第三期）
   - P2：增值服务（第四期）
7. **技术可行**：成熟技术栈，降低风险
8. **可扩展性**：架构预留扩展空间，支持未来增长

### 10.2 关键成功因素

1. ✅ **快速MVP上线**：6-8周上线基础功能，验证商业模式
2. ✅ **实验室生态**：主动拓展优质实验室入驻，建立供给侧
3. ✅ **用户获取**：与高校合作，获取种子用户
4. ✅ **服务质量**：确保检测质量和交付时效，建立口碑
5. ✅ **技术创新**：通过技术提升效率，降低成本
6. ✅ **品牌建设**：申请认证，建立专业形象

### 10.3 风险与应对

| 风险 | 等级 | 应对措施 |
|------|------|----------|
| 竞争对手成熟（eceshi） | 高 | 差异化竞争、快速迭代、激进营销 |
| 实验室拓展困难 | 高 | 更优惠的入驻政策、主动BD |
| 用户获取成本高 | 中 | 高校合作、社交裂变、内容营销 |
| 检测质量问题 | 高 | 严格审核实验室资质、建立评价体系 |
| 资金消耗快 | 中 | 控制营销成本、快速盈利 |

### 10.4 下一步行动

**第一周**：
1. ✅ 组建项目团队（17-22人）
2. ✅ 开展需求评审会议
3. ✅ 研究eceshi平台细节
4. ✅ 制定详细的原型设计方案

**第二周**：
1. ✅ 启动UI设计（三端）
2. ✅ 启动数据库设计（40+表）
3. ✅ 启动技术架构设计
4. ✅ 准备开发环境

**第三周**：
1. ✅ 开始第一迭代开发
2. ✅ 启动商务团队，接触实验室
3. ✅ 启动运营团队，策划营销活动
4. ✅ 申请相关资质认证

---

## 📊 项目总览

- **开发周期**：24-28周（6-7个月）
- **团队规模**：17-22人
- **数据库表**：40+张
- **核心功能**：60+个
- **开发迭代**：10个迭代
- **对标平台**：eceshi.com
- **目标**：成为领先的科研检测服务平台

---

**预祝项目顺利！让我们打造比eceshi更优秀的平台！🚀**

