<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÁßëÁ†îÊ£ÄÊµãÊúçÂä°Âπ≥Âè∞ - EÊµãËØï</title>
    <meta name="description" content="‰∏ì‰∏öÁöÑÁßëÁ†îÊ£ÄÊµãÊúçÂä°Âπ≥Âè∞ÔºåÊèê‰æõ‰∏ÄÁ´ôÂºèÊ£ÄÊµãËß£ÂÜ≥ÊñπÊ°à">
    <meta name="keywords" content="ÁßëÁ†îÊ£ÄÊµã,ÂÆûÈ™åÊ£ÄÊµã,Ê£ÄÊµãÊúçÂä°,EÊµãËØï">
    
    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3.4.21/dist/vue.global.prod.js"></script>
    
    <!-- Element Plus -->
    <link rel="stylesheet" href="https://unpkg.com/element-plus@2.5.6/dist/index.css">
    <script src="https://unpkg.com/element-plus@2.5.6/dist/index.full.min.js"></script>
    
    <!-- Element Plus ÂõæÊ†á -->
    <script src="https://unpkg.com/@element-plus/icons-vue@2.3.1/dist/index.iife.min.js"></script>
    
    <!-- Axios -->
    <script src="https://unpkg.com/axios@1.6.7/dist/axios.min.js"></script>
    
    <!-- Ëá™ÂÆö‰πâÊ†∑Âºè -->
    <link rel="stylesheet" href="./assets/css/style.css">
</head>
<body>
    <div id="app" v-cloak>
        <!-- È°∂ÈÉ®ÂØºËà™ -->
        <el-container class="app-container">
            <!-- PCÁ´ØÈ°∂ÈÉ®ÂØºËà™Ê†è -->
            <el-header class="app-header" height="60px">
                <div class="header-content">
                    <div class="header-left">
                        <h1 class="logo" @click="currentView = 'home'">
                            üî¨ EÊµãËØï
                        </h1>
                        <el-menu
                            v-if="!isMobile"
                            :default-active="currentView"
                            class="header-menu"
                            mode="horizontal"
                            @select="handleMenuSelect">
                            <el-menu-item index="home">È¶ñÈ°µ</el-menu-item>
                            <el-menu-item index="projects">Ê£ÄÊµãÈ°πÁõÆ</el-menu-item>
                            <el-menu-item index="orders" v-if="isLogin">ÊàëÁöÑËÆ¢Âçï</el-menu-item>
                            <el-menu-item index="about">ÂÖ≥‰∫éÊàë‰ª¨</el-menu-item>
                        </el-menu>
                    </div>
                    <div class="header-right">
                        <div v-if="isLogin" class="user-info">
                            <el-dropdown @command="handleUserCommand">
                                <span class="user-dropdown">
                                    <el-avatar :size="32" :src="userInfo.avatar">{{ userInfo.nickname?.[0] || 'U' }}</el-avatar>
                                    <span class="user-name">{{ userInfo.nickname || 'Áî®Êà∑' }}</span>
                                    <el-icon><arrow-down /></el-icon>
                                </span>
                                <template #dropdown>
                                    <el-dropdown-menu>
                                        <el-dropdown-item command="profile">‰∏™‰∫∫‰∏≠ÂøÉ</el-dropdown-item>
                                        <el-dropdown-item command="orders">ÊàëÁöÑËÆ¢Âçï</el-dropdown-item>
                                        <el-dropdown-item divided command="logout">ÈÄÄÂá∫ÁôªÂΩï</el-dropdown-item>
                                    </el-dropdown-menu>
                                </template>
                            </el-dropdown>
                        </div>
                        <el-button v-else type="primary" @click="showLogin = true">ÁôªÂΩï</el-button>
                        
                        <!-- ÁßªÂä®Á´ØËèúÂçïÊåâÈíÆ -->
                        <el-button v-if="isMobile" class="mobile-menu-btn" icon="Menu" @click="showMobileMenu = true"></el-button>
                    </div>
                </div>
            </el-header>

            <!-- ‰∏ªÂÜÖÂÆπÂå∫ -->
            <el-main class="app-main">
                <div class="main-content">
                    <!-- È¶ñÈ°µ -->
                    <home-view v-if="currentView === 'home'" @go-projects="currentView = 'projects'" @go-detail="goToDetail" @go-help="currentView = 'help'" @go-chat="currentView = 'chat'" @go-lottery="currentView = 'lottery'" @go-reports="currentView = 'reports'" @go-announcements="currentView = 'announcements'"></home-view>
                    
                    <!-- È°πÁõÆÂàóË°® -->
                    <projects-view v-else-if="currentView === 'projects'" @go-detail="goToDetail"></projects-view>
                    
                    <!-- È°πÁõÆËØ¶ÊÉÖ -->
                    <project-detail v-else-if="currentView === 'detail'" :project-id="currentProjectId" @go-back="currentView = 'projects'" @show-booking="openBooking" @require-login="requireLogin"></project-detail>
                    
                    <!-- ËÆ¢ÂçïÂàóË°® -->
                    <orders-view v-else-if="currentView === 'orders'" @show-payment="openPayment" @show-review="openReview" @show-invoice="openInvoice" @go-sample-track="goToSampleTrack"></orders-view>
                    
                    <!-- ‰∏™‰∫∫‰∏≠ÂøÉ -->
                    <profile-view v-else-if="currentView === 'profile'" @go-orders="currentView = 'orders'" @go-favorites="currentView = 'favorites'" @go-coupons="currentView = 'coupons'" @go-address="currentView = 'address'" @go-wallet="currentView = 'wallet'" @go-points="currentView = 'points'" @go-invoice="currentView = 'invoices'" @go-team="currentView = 'team'" @go-reports="currentView = 'reports'" @go-help="currentView = 'help'" @go-chat="currentView = 'chat'" @go-announcements="currentView = 'announcements'" @go-contracts="currentView = 'contracts'" @go-lottery="currentView = 'lottery'" @edit-profile="openEditProfile"></profile-view>
                    
                    <!-- ÂÖ≥‰∫éÊàë‰ª¨ -->
                    <about-view v-else-if="currentView === 'about'"></about-view>
                    
                    <!-- ÊàëÁöÑÊî∂Ëóè -->
                    <favorites-view v-else-if="currentView === 'favorites'" @go-back="currentView = 'profile'" @go-detail="goToDetail"></favorites-view>
                    
                    <!-- ‰ºòÊÉ†Âà∏ -->
                    <coupons-view v-else-if="currentView === 'coupons'" @go-back="currentView = 'profile'"></coupons-view>
                    
                    <!-- Âú∞ÂùÄÁÆ°ÁêÜ -->
                    <address-view v-else-if="currentView === 'address'" @go-back="currentView = 'profile'"></address-view>
                    
                    <!-- Èí±ÂåÖ -->
                    <wallet-view v-else-if="currentView === 'wallet'" @go-back="currentView = 'profile'"></wallet-view>
                    
                    <!-- ÁßØÂàÜÂïÜÂüé -->
                    <points-view v-else-if="currentView === 'points'" @go-back="currentView = 'profile'"></points-view>
                    
                    <!-- ÂèëÁ•®ÁÆ°ÁêÜ -->
                    <invoice-view v-else-if="currentView === 'invoices'" @go-back="currentView = 'profile'"></invoice-view>
                    
                    <!-- Âõ¢ÈòüÈÇÄËØ∑ -->
                    <team-view v-else-if="currentView === 'team'" @go-back="currentView = 'profile'"></team-view>
                    
                    <!-- Â∏ÆÂä©‰∏≠ÂøÉ -->
                    <help-view v-else-if="currentView === 'help'" @go-back="currentView = 'home'"></help-view>
                    
                    <!-- Âú®Á∫øÂÆ¢Êúç -->
                    <chat-view v-else-if="currentView === 'chat'" @go-back="currentView = 'home'"></chat-view>
                    
                    <!-- ÊäΩÂ•ñÊ¥ªÂä® -->
                    <lottery-view v-else-if="currentView === 'lottery'" @go-back="currentView = 'home'"></lottery-view>
                    
                    <!-- Êä•Âëä‰∏ãËΩΩ -->
                    <reports-view v-else-if="currentView === 'reports'" @go-back="currentView = 'profile'" @go-sample-track="goToSampleTrack"></reports-view>
                    
                    <!-- Ê†∑ÂìÅËøΩË∏™ -->
                    <sample-track-view v-else-if="currentView === 'sampletrack'" :order-id="currentOrderId" @go-back="currentView = 'reports'"></sample-track-view>
                    
                    <!-- ÂÖ¨ÂëäÂàóË°® -->
                    <announcements-view v-else-if="currentView === 'announcements'" @go-back="currentView = 'home'"></announcements-view>
                    
                    <!-- ÂêàÂêåÁÆ°ÁêÜ -->
                    <contracts-view v-else-if="currentView === 'contracts'" @go-back="currentView = 'profile'"></contracts-view>
                </div>
            </el-main>

            <!-- PCÁ´ØÂ∫ïÈÉ® -->
            <el-footer v-if="!isMobile" class="app-footer" height="200px">
                <div class="footer-content">
                    <div class="footer-section">
                        <h3>ÂÖ≥‰∫éÊàë‰ª¨</h3>
                        <p>‰∏ì‰∏öÁöÑÁßëÁ†îÊ£ÄÊµãÊúçÂä°Âπ≥Âè∞</p>
                        <p>‰∏∫ÁßëÁ†îÂ∑•‰ΩúËÄÖÊèê‰æõ‰ºòË¥®ÊúçÂä°</p>
                    </div>
                    <div class="footer-section">
                        <h3>ËÅîÁ≥ªÊñπÂºè</h3>
                        <p>ÂÆ¢ÊúçÁîµËØùÔºö400-123-4567</p>
                        <p>ÈÇÆÁÆ±Ôºöservice@eceshi.com</p>
                    </div>
                    <div class="footer-section">
                        <h3>ÂÖ≥Ê≥®Êàë‰ª¨</h3>
                        <p>ÂæÆ‰ø°ÂÖ¨‰ºóÂè∑ÔºöEÊµãËØï</p>
                        <p>ÂæÆ‰ø°Â∞èÁ®ãÂ∫èÔºöÁßëÁ†îÊ£ÄÊµãÊúçÂä°Âπ≥Âè∞</p>
                    </div>
                </div>
                <div class="footer-copyright">
                    <p>&copy; 2025 EÊµãËØï ÁßëÁ†îÊ£ÄÊµãÊúçÂä°Âπ≥Âè∞. All rights reserved.</p>
                </div>
            </el-footer>

            <!-- ÁßªÂä®Á´ØÂ∫ïÈÉ®ÂØºËà™ -->
            <div v-if="isMobile" class="mobile-tabbar">
                <div class="tabbar-item" :class="{active: currentView === 'home'}" @click="currentView = 'home'">
                    <el-icon><home-filled /></el-icon>
                    <span>È¶ñÈ°µ</span>
                </div>
                <div class="tabbar-item" :class="{active: currentView === 'projects'}" @click="currentView = 'projects'">
                    <el-icon><files /></el-icon>
                    <span>È°πÁõÆ</span>
                </div>
                <div class="tabbar-item" :class="{active: currentView === 'orders'}" @click="handleTabClick('orders')">
                    <el-icon><document /></el-icon>
                    <span>ËÆ¢Âçï</span>
                </div>
                <div class="tabbar-item" :class="{active: currentView === 'profile'}" @click="handleTabClick('profile')">
                    <el-icon><user /></el-icon>
                    <span>ÊàëÁöÑ</span>
                </div>
            </div>
        </el-container>

        <!-- ÁôªÂΩïÂØπËØùÊ°Ü -->
        <el-dialog v-model="showLogin" title="ÁôªÂΩï" width="400px" :close-on-click-modal="false">
            <el-form :model="loginForm">
                <el-form-item label="ÊâãÊú∫Âè∑">
                    <el-input v-model="loginForm.phone" placeholder="ËØ∑ËæìÂÖ•ÊâãÊú∫Âè∑" maxlength="11"></el-input>
                </el-form-item>
                <el-form-item label="È™åËØÅÁ†Å">
                    <el-input v-model="loginForm.sms_code" placeholder="ËØ∑ËæìÂÖ•È™åËØÅÁ†Å">
                        <template #append>
                            <el-button :disabled="countdown > 0" @click="sendSms">
                                {{ countdown > 0 ? `${countdown}ÁßíÂêéÈáçËØï` : 'Ëé∑ÂèñÈ™åËØÅÁ†Å' }}
                            </el-button>
                        </template>
                    </el-input>
                </el-form-item>
            </el-form>
            <template #footer>
                <el-button @click="showLogin = false">ÂèñÊ∂à</el-button>
                <el-button type="primary" @click="handleLogin" :loading="loginLoading">ÁôªÂΩï</el-button>
            </template>
        </el-dialog>

        <!-- ÁßªÂä®Á´ØËèúÂçïÊäΩÂ±â -->
        <el-drawer v-model="showMobileMenu" title="ËèúÂçï" direction="rtl" size="70%">
            <el-menu :default-active="currentView" @select="handleMobileMenuSelect">
                <el-menu-item index="home">
                    <el-icon><home-filled /></el-icon>
                    <span>È¶ñÈ°µ</span>
                </el-menu-item>
                <el-menu-item index="projects">
                    <el-icon><files /></el-icon>
                    <span>Ê£ÄÊµãÈ°πÁõÆ</span>
                </el-menu-item>
                <el-menu-item index="orders" v-if="isLogin">
                    <el-icon><document /></el-icon>
                    <span>ÊàëÁöÑËÆ¢Âçï</span>
                </el-menu-item>
                <el-menu-item index="about">
                    <el-icon><info-filled /></el-icon>
                    <span>ÂÖ≥‰∫éÊàë‰ª¨</span>
                </el-menu-item>
                <el-menu-item v-if="isLogin" @click="logout">
                    <el-icon><switch-button /></el-icon>
                    <span>ÈÄÄÂá∫ÁôªÂΩï</span>
                </el-menu-item>
            </el-menu>
        </el-drawer>

        <!-- È¢ÑÁ∫¶‰∏ãÂçïÂØπËØùÊ°Ü -->
        <el-dialog v-model="showBooking" title="È¢ÑÁ∫¶‰∏ãÂçï" width="600px" :close-on-click-modal="false">
            <div v-if="bookingProject" class="booking-form">
                <div class="booking-project">
                    <img :src="bookingProject.cover_image || 'https://via.placeholder.com/100'" style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;">
                    <div class="booking-project-info">
                        <div class="booking-project-name">{{ bookingProject.name }}</div>
                        <div class="booking-project-price">¬•{{ bookingProject.current_price }}</div>
                    </div>
                </div>
                <el-form :model="bookingForm" label-width="100px" style="margin-top: 20px">
                    <el-form-item label="Ê†∑ÂìÅÂêçÁß∞" required>
                        <el-input v-model="bookingForm.sample_name" placeholder="ËØ∑ËæìÂÖ•Ê†∑ÂìÅÂêçÁß∞"></el-input>
                    </el-form-item>
                    <el-form-item label="Êï∞Èáè">
                        <el-input-number v-model="bookingForm.quantity" :min="1" :max="100"></el-input-number>
                    </el-form-item>
                    <el-form-item label="Êî∂Ë¥ßÂú∞ÂùÄ" required>
                        <el-select v-model="bookingForm.address_id" placeholder="ËØ∑ÈÄâÊã©Êî∂Ë¥ßÂú∞ÂùÄ" style="width: 100%">
                            <el-option v-for="addr in addresses" :key="addr.id" :label="addr.receiver_name + ' ' + addr.province + addr.city + addr.detail" :value="addr.id"></el-option>
                        </el-select>
                    </el-form-item>
                    <el-form-item label="‰ºòÊÉ†Âà∏">
                        <el-select v-model="bookingForm.coupon_id" placeholder="ÈÄâÊã©‰ºòÊÉ†Âà∏ÔºàÂèØÈÄâÔºâ" clearable style="width: 100%">
                            <el-option v-for="coupon in availableCoupons" :key="coupon.id" :label="coupon.name + ' -¬•' + coupon.discount_value" :value="coupon.id"></el-option>
                        </el-select>
                    </el-form-item>
                    <el-form-item label="Â§áÊ≥®">
                        <el-input v-model="bookingForm.remark" type="textarea" placeholder="Â§áÊ≥®‰ø°ÊÅØÔºàÂèØÈÄâÔºâ"></el-input>
                    </el-form-item>
                </el-form>
                <div class="booking-total">
                    <span>Â∫î‰ªòÈáëÈ¢ùÔºö</span>
                    <span class="total-price">¬•{{ orderTotalAmount }}</span>
                </div>
            </div>
            <template #footer>
                <el-button @click="showBooking = false">ÂèñÊ∂à</el-button>
                <el-button type="primary" @click="submitBooking" :loading="bookingLoading">Êèê‰∫§ËÆ¢Âçï</el-button>
            </template>
        </el-dialog>

        <!-- ÊîØ‰ªòÂØπËØùÊ°Ü -->
        <el-dialog v-model="showPayment" title="ËÆ¢ÂçïÊîØ‰ªò" width="500px" :close-on-click-modal="false">
            <div v-if="paymentOrder" class="payment-form">
                <div class="payment-amount">
                    <div class="payment-label">ÊîØ‰ªòÈáëÈ¢ù</div>
                    <div class="payment-value">¬•{{ paymentOrder.total_amount }}</div>
                </div>
                <div class="payment-methods">
                    <div class="payment-method" :class="{ active: payMethod === 'balance' }" @click="payMethod = 'balance'">
                        <el-icon><wallet /></el-icon>
                        <span>‰ΩôÈ¢ùÊîØ‰ªò</span>
                        <span class="method-balance">ÂèØÁî®Ôºö¬•{{ balance.prepaid_balance || 0 }}</span>
                    </div>
                    <div class="payment-method" :class="{ active: payMethod === 'alipay' }" @click="payMethod = 'alipay'">
                        <span style="color: #1677FF; font-weight: bold;">ÊîØ‰ªòÂÆù</span>
                    </div>
                    <div class="payment-method" :class="{ active: payMethod === 'wechat' }" @click="payMethod = 'wechat'">
                        <span style="color: #07C160; font-weight: bold;">ÂæÆ‰ø°ÊîØ‰ªò</span>
                    </div>
                </div>
            </div>
            <template #footer>
                <el-button @click="showPayment = false">ÂèñÊ∂à</el-button>
                <el-button type="primary" @click="submitPayment" :loading="paymentLoading">Á°ÆËÆ§ÊîØ‰ªò</el-button>
            </template>
        </el-dialog>

        <!-- ËØÑ‰ª∑ÂØπËØùÊ°Ü -->
        <el-dialog v-model="showReview" title="ËØÑ‰ª∑ËÆ¢Âçï" width="500px" :close-on-click-modal="false">
            <el-form :model="reviewForm" label-width="80px">
                <el-form-item label="ËØÑÂàÜ">
                    <el-rate v-model="reviewForm.rating" :colors="['#F56C6C', '#E6A23C', '#67C23A']" show-text :texts="['ÂæàÂ∑Æ', 'ËæÉÂ∑Æ', '‰∏ÄËà¨', 'ËæÉÂ•Ω', 'ÂæàÂ•Ω']"></el-rate>
                </el-form-item>
                <el-form-item label="ËØÑ‰ª∑ÂÜÖÂÆπ">
                    <el-input v-model="reviewForm.content" type="textarea" :rows="4" placeholder="ËØ∑ËæìÂÖ•ÊÇ®ÁöÑËØÑ‰ª∑"></el-input>
                </el-form-item>
            </el-form>
            <template #footer>
                <el-button @click="showReview = false">ÂèñÊ∂à</el-button>
                <el-button type="primary" @click="submitReview" :loading="reviewLoading">Êèê‰∫§ËØÑ‰ª∑</el-button>
            </template>
        </el-dialog>

        <!-- ÂèëÁ•®Áî≥ËØ∑ÂØπËØùÊ°Ü -->
        <el-dialog v-model="showInvoice" title="Áî≥ËØ∑ÂèëÁ•®" width="500px" :close-on-click-modal="false">
            <el-form :model="invoiceForm" label-width="100px">
                <el-form-item label="ÂèëÁ•®Á±ªÂûã">
                    <el-radio-group v-model="invoiceForm.invoice_type">
                        <el-radio value="personal">‰∏™‰∫∫</el-radio>
                        <el-radio value="company">‰ºÅ‰∏ö</el-radio>
                    </el-radio-group>
                </el-form-item>
                <el-form-item label="ÂèëÁ•®Êä¨Â§¥" required>
                    <el-input v-model="invoiceForm.title" placeholder="ËØ∑ËæìÂÖ•ÂèëÁ•®Êä¨Â§¥"></el-input>
                </el-form-item>
                <el-form-item label="Á®éÂè∑" v-if="invoiceForm.invoice_type === 'company'">
                    <el-input v-model="invoiceForm.tax_id" placeholder="ËØ∑ËæìÂÖ•‰ºÅ‰∏öÁ®éÂè∑"></el-input>
                </el-form-item>
                <el-form-item label="Êé•Êî∂ÈÇÆÁÆ±" required>
                    <el-input v-model="invoiceForm.email" placeholder="ËØ∑ËæìÂÖ•Êé•Êî∂ÈÇÆÁÆ±"></el-input>
                </el-form-item>
            </el-form>
            <template #footer>
                <el-button @click="showInvoice = false">ÂèñÊ∂à</el-button>
                <el-button type="primary" @click="submitInvoice" :loading="invoiceLoading">Êèê‰∫§Áî≥ËØ∑</el-button>
            </template>
        </el-dialog>

        <!-- ÁºñËæëËµÑÊñôÂØπËØùÊ°Ü -->
        <el-dialog v-model="showEditProfile" title="ÁºñËæëËµÑÊñô" width="400px" :close-on-click-modal="false">
            <el-form :model="profileForm" label-width="80px">
                <el-form-item label="ÊòµÁß∞">
                    <el-input v-model="profileForm.nickname" placeholder="ËØ∑ËæìÂÖ•ÊòµÁß∞"></el-input>
                </el-form-item>
                <el-form-item label="Â§¥ÂÉè">
                    <el-input v-model="profileForm.avatar" placeholder="ËØ∑ËæìÂÖ•Â§¥ÂÉèURL"></el-input>
                </el-form-item>
            </el-form>
            <template #footer>
                <el-button @click="showEditProfile = false">ÂèñÊ∂à</el-button>
                <el-button type="primary" @click="submitProfile" :loading="profileLoading">‰øùÂ≠ò</el-button>
            </template>
        </el-dialog>
    </div>

    <!-- Â∫îÁî®ËÑöÊú¨ -->
    <script src="./assets/js/app.js"></script>
</body>
</html>


