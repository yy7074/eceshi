<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÁßëÁ†îÊ£ÄÊµãÊúçÂä°Âπ≥Âè∞ - ÂêéÂè∞ÁÆ°ÁêÜ</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/element-plus"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/element-plus/dist/index.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB',
                'Microsoft YaHei', 'Helvetica Neue', Helvetica, Arial, sans-serif;
        }
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .login-box {
            width: 450px;
            padding: 40px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
        }
        .admin-layout {
            height: 100vh;
        }
        .admin-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            background: #001529;
            color: white;
            height: 60px;
        }
        .admin-header h2 {
            margin: 0;
            font-size: 18px;
        }
        .admin-container {
            height: calc(100vh - 60px);
        }
        .admin-aside {
            background: #001529;
            color: white;
        }
        .admin-aside .el-menu {
            border-right: none;
            background-color: #001529;
        }
        .admin-main {
            background: #f0f2f5;
            overflow-y: auto;
            padding: 20px;
        }
        .page-header {
            background: white;
            padding: 16px 24px;
            margin-bottom: 16px;
            border-radius: 4px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.03);
        }
        .page-header h3 {
            margin: 0;
            font-size: 20px;
            font-weight: 600;
            color: #262626;
        }
        .content-card {
            background: white;
            border-radius: 4px;
            padding: 24px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.03);
            margin-bottom: 16px;
        }
        .image-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 20px;
        }
        .image-item {
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            overflow: hidden;
            transition: all 0.3s;
        }
        .image-item:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }
        .image-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }
        .image-item-footer {
            padding: 8px;
            background: #f5f5f5;
            font-size: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .stat-card {
            padding: 20px;
            border-radius: 8px;
            color: white;
            display: flex;
            align-items: center;
            gap: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .stat-icon {
            font-size: 36px;
            opacity: 0.9;
        }
        .stat-info {
            flex: 1;
        }
        .stat-value {
            font-size: 28px;
            font-weight: 700;
            line-height: 1.2;
        }
        .stat-label {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 4px;
        }
        .stat-sub {
            font-size: 12px;
            opacity: 0.8;
            margin-top: 4px;
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- ÁôªÂΩïÈ°µÈù¢ -->
        <div v-if="!token" class="login-container">
            <div class="login-box">
                <h2 style="text-align: center; margin-bottom: 30px;">üî¨ ÂêéÂè∞ÁÆ°ÁêÜÁôªÂΩï</h2>
                
                <el-tabs v-model="loginType">
                    <!-- ÁÆ°ÁêÜÂëòÁôªÂΩï -->
                    <el-tab-pane label="ÁÆ°ÁêÜÂëòÁôªÂΩï" name="admin">
                        <el-form :model="adminLoginForm" @submit.prevent="handleAdminLogin">
                            <el-form-item label="Áî®Êà∑Âêç">
                                <el-input v-model="adminLoginForm.username" placeholder="ËØ∑ËæìÂÖ•Áî®Êà∑Âêç"></el-input>
                            </el-form-item>
                            <el-form-item label="ÂØÜÁ†Å">
                                <el-input 
                                    v-model="adminLoginForm.password" 
                                    type="password" 
                                    placeholder="ËØ∑ËæìÂÖ•ÂØÜÁ†Å"
                                    show-password
                                    @keyup.enter="handleAdminLogin"></el-input>
                            </el-form-item>
                            <el-form-item>
                                <el-button type="primary" @click="handleAdminLogin" style="width: 100%;" :loading="loading">
                                    ÁôªÂΩï
                                </el-button>
                            </el-form-item>
                            <el-alert title="ÈªòËÆ§Ë¥¶Âè∑: admin / 123456" type="info" :closable="false" show-icon />
                        </el-form>
                    </el-tab-pane>
                    
                    <!-- Áü≠‰ø°ÁôªÂΩï -->
                    <el-tab-pane label="Áü≠‰ø°ÁôªÂΩï" name="sms">
                        <el-form :model="loginForm" @submit.prevent="handleLogin">
                            <el-form-item label="ÊâãÊú∫Âè∑">
                                <el-input v-model="loginForm.phone" placeholder="ËØ∑ËæìÂÖ•ÊâãÊú∫Âè∑"></el-input>
                            </el-form-item>
                            <el-form-item label="È™åËØÅÁ†Å">
                                <el-input v-model="loginForm.sms_code" placeholder="ËØ∑ËæìÂÖ•È™åËØÅÁ†Å">
                                    <template #append>
                                        <el-button @click="sendSms" :disabled="countdown > 0">
                                            {{ countdown > 0 ? `${countdown}ÁßíÂêéÈáçËØï` : 'Ëé∑ÂèñÈ™åËØÅÁ†Å' }}
                                        </el-button>
                                    </template>
                                </el-input>
                            </el-form-item>
                            <el-form-item>
                                <el-button type="primary" @click="handleLogin" style="width: 100%;" :loading="loading">
                                    ÁôªÂΩï
                                </el-button>
                            </el-form-item>
                        </el-form>
                    </el-tab-pane>
                </el-tabs>
            </div>
        </div>

        <!-- ÂêéÂè∞ÁÆ°ÁêÜ‰∏ªÁïåÈù¢ -->
        <el-container v-else class="admin-layout">
            <!-- È°∂ÈÉ® -->
            <el-header class="admin-header" height="60px">
                <div>
                    <h2>üî¨ ÁßëÁ†îÊ£ÄÊµãÊúçÂä°Âπ≥Âè∞ - ÂêéÂè∞ÁÆ°ÁêÜ</h2>
                </div>
                <div>
                    <el-dropdown>
                        <span style="cursor: pointer; color: white;">
                            {{ userInfo.nickname || 'ÁÆ°ÁêÜÂëò' }}
                            <el-icon style="margin-left: 5px;"><arrow-down /></el-icon>
                        </span>
                        <template #dropdown>
                            <el-dropdown-menu>
                                <el-dropdown-item @click="logout">
                                    <el-icon><switch-button /></el-icon>
                                    ÈÄÄÂá∫ÁôªÂΩï
                                </el-dropdown-item>
                            </el-dropdown-menu>
                        </template>
                    </el-dropdown>
                </div>
            </el-header>

            <!-- ‰∏ª‰Ωì -->
            <el-container class="admin-container">
                <!-- Â∑¶‰æßËèúÂçï -->
                <el-aside class="admin-aside" width="200px">
                    <el-menu
                        :default-active="activeMenu"
                        background-color="#001529"
                        text-color="#fff"
                        active-text-color="#409EFF"
                        @select="handleMenuSelect">
                        <el-menu-item index="dashboard">
                            <el-icon><data-line /></el-icon>
                            <span>Êï∞ÊçÆÈù¢Êùø</span>
                        </el-menu-item>
                        <el-menu-item index="users">
                            <el-icon><user /></el-icon>
                            <span>Áî®Êà∑ÁÆ°ÁêÜ</span>
                        </el-menu-item>
                        <el-menu-item index="orders">
                            <el-icon><document /></el-icon>
                            <span>ËÆ¢ÂçïÁÆ°ÁêÜ</span>
                        </el-menu-item>
                        <el-menu-item index="projects">
                            <el-icon><picture /></el-icon>
                            <span>È°πÁõÆÁÆ°ÁêÜ</span>
                        </el-menu-item>
                        <el-menu-item index="categories">
                            <el-icon><folder /></el-icon>
                            <span>ÂàÜÁ±ªÁÆ°ÁêÜ</span>
                        </el-menu-item>
                        <el-menu-item index="coupons">
                            <el-icon><ticket /></el-icon>
                            <span>‰ºòÊÉ†Âà∏ÁÆ°ÁêÜ</span>
                        </el-menu-item>
                        <el-menu-item index="recharges">
                            <el-icon><wallet /></el-icon>
                            <span>ÂÖÖÂÄºÁÆ°ÁêÜ</span>
                        </el-menu-item>
                        <el-menu-item index="points">
                            <el-icon><present /></el-icon>
                            <span>ÁßØÂàÜÂïÜÂìÅ</span>
                        </el-menu-item>
                        <el-menu-item index="reviews">
                            <el-icon><chat-line-square /></el-icon>
                            <span>ËØÑ‰ª∑ÁÆ°ÁêÜ</span>
                        </el-menu-item>
                        <el-menu-item index="groups">
                            <el-icon><office-building /></el-icon>
                            <span>Âõ¢‰ΩìÁÆ°ÁêÜ</span>
                        </el-menu-item>
                        <el-menu-item index="invites">
                            <el-icon><share /></el-icon>
                            <span>ÈÇÄËØ∑ÁÆ°ÁêÜ</span>
                        </el-menu-item>
                        <el-menu-item index="settings">
                            <el-icon><setting /></el-icon>
                            <span>Á≥ªÁªüËÆæÁΩÆ</span>
                        </el-menu-item>
                    </el-menu>
                </el-aside>

                <!-- Âè≥‰æßÂÜÖÂÆπ -->
                <el-main class="admin-main">
                    <!-- Êï∞ÊçÆÈù¢Êùø -->
                    <div v-show="activeMenu === 'dashboard'">
                        <div class="page-header">
                            <h3>üìä Êï∞ÊçÆÈù¢Êùø</h3>
                        </div>
                        
                        <!-- ÁªüËÆ°Âç°Áâá -->
                        <el-row :gutter="16" style="margin-bottom: 16px;">
                            <el-col :span="6">
                                <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                    <div class="stat-icon">üë•</div>
                                    <div class="stat-info">
                                        <div class="stat-value">{{ dashboardData.users?.total || 0 }}</div>
                                        <div class="stat-label">ÊÄªÁî®Êà∑Êï∞</div>
                                        <div class="stat-sub">‰ªäÊó•Êñ∞Â¢û: {{ dashboardData.users?.today || 0 }}</div>
                                    </div>
                                </div>
                            </el-col>
                            <el-col :span="6">
                                <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                                    <div class="stat-icon">üì¶</div>
                                    <div class="stat-info">
                                        <div class="stat-value">{{ dashboardData.orders?.total || 0 }}</div>
                                        <div class="stat-label">ÊÄªËÆ¢ÂçïÊï∞</div>
                                        <div class="stat-sub">ÂæÖÂ§ÑÁêÜ: {{ dashboardData.orders?.pending || 0 }}</div>
                                    </div>
                                </div>
                            </el-col>
                            <el-col :span="6">
                                <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                                    <div class="stat-icon">üí∞</div>
                                    <div class="stat-info">
                                        <div class="stat-value">¬•{{ (dashboardData.revenue?.total || 0).toFixed(2) }}</div>
                                        <div class="stat-label">ÊÄªÊî∂ÂÖ•</div>
                                        <div class="stat-sub">‰ªäÊó•: ¬•{{ (dashboardData.revenue?.today || 0).toFixed(2) }}</div>
                                    </div>
                                </div>
                            </el-col>
                            <el-col :span="6">
                                <div class="stat-card" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                                    <div class="stat-icon">üî¨</div>
                                    <div class="stat-info">
                                        <div class="stat-value">{{ dashboardData.projects?.total || 0 }}</div>
                                        <div class="stat-label">Ê£ÄÊµãÈ°πÁõÆ</div>
                                        <div class="stat-sub">Âú®Êû∂: {{ dashboardData.projects?.active || 0 }}</div>
                                    </div>
                                </div>
                            </el-col>
                        </el-row>

                        <el-row :gutter="16">
                            <el-col :span="16">
                                <div class="content-card">
                                    <h4 style="margin-bottom: 16px;">üìà Ëøë7Â§©ËÆ¢ÂçïË∂ãÂäø</h4>
                                    <div style="display: flex; height: 200px; align-items: flex-end; gap: 12px;">
                                        <div v-for="item in dashboardData.trends?.orders || []" :key="item.date" 
                                            style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                            <div :style="{
                                                width: '100%',
                                                height: Math.max((item.count / maxOrderCount) * 160, 5) + 'px',
                                                background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                                                borderRadius: '4px 4px 0 0',
                                                transition: 'height 0.3s'
                                            }"></div>
                                            <div style="font-size: 12px; color: #666; margin-top: 8px;">{{ item.date }}</div>
                                            <div style="font-size: 12px; color: #333; font-weight: 600;">{{ item.count }}</div>
                                        </div>
                                    </div>
                                </div>
                            </el-col>
                            <el-col :span="8">
                                <div class="content-card">
                                    <h4 style="margin-bottom: 16px;">üìä ËÆ¢ÂçïÁä∂ÊÄÅÂàÜÂ∏É</h4>
                                    <div v-for="item in dashboardData.order_status_distribution || []" :key="item.status" 
                                        style="margin-bottom: 12px;">
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                            <span>{{ getOrderStatusText(item.status) }}</span>
                                            <span style="font-weight: 600;">{{ item.count }}</span>
                                        </div>
                                        <el-progress 
                                            :percentage="totalOrders > 0 ? (item.count / totalOrders * 100) : 0" 
                                            :show-text="false"
                                            :color="getOrderStatusColor(item.status)">
                                        </el-progress>
                                    </div>
                                </div>
                            </el-col>
                        </el-row>

                        <el-row :gutter="16" style="margin-top: 16px;">
                            <el-col :span="12">
                                <div class="content-card">
                                    <h4 style="margin-bottom: 16px;">üí≥ ÂÖÖÂÄºÁªüËÆ°</h4>
                                    <el-descriptions :column="1" border size="small">
                                        <el-descriptions-item label="Á¥ØËÆ°ÂÖÖÂÄº">¬•{{ (dashboardData.recharge?.total || 0).toFixed(2) }}</el-descriptions-item>
                                        <el-descriptions-item label="ÂæÖÂ§ÑÁêÜÂÖÖÂÄº">{{ dashboardData.recharge?.pending_count || 0 }} Á¨î</el-descriptions-item>
                                    </el-descriptions>
                                </div>
                            </el-col>
                            <el-col :span="12">
                                <div class="content-card">
                                    <h4 style="margin-bottom: 16px;">üìÖ Êú¨ÊúàÊï∞ÊçÆ</h4>
                                    <el-descriptions :column="1" border size="small">
                                        <el-descriptions-item label="Êñ∞Â¢ûÁî®Êà∑">{{ dashboardData.users?.this_month || 0 }}</el-descriptions-item>
                                        <el-descriptions-item label="Êñ∞Â¢ûËÆ¢Âçï">{{ dashboardData.orders?.this_month || 0 }}</el-descriptions-item>
                                        <el-descriptions-item label="Êú¨ÊúàÊî∂ÂÖ•">¬•{{ (dashboardData.revenue?.this_month || 0).toFixed(2) }}</el-descriptions-item>
                                    </el-descriptions>
                                </div>
                            </el-col>
                        </el-row>
                    </div>

                    <!-- Áî®Êà∑ÁÆ°ÁêÜ -->
                    <div v-show="activeMenu === 'users'">
                        <div class="page-header">
                            <h3>üë• Áî®Êà∑ÁÆ°ÁêÜ</h3>
                        </div>

                        <div class="content-card">
                            <div style="margin-bottom: 20px;">
                                <el-input 
                                    v-model="userSearch" 
                                    placeholder="ÊêúÁ¥¢ÊâãÊú∫Âè∑ÊàñÊòµÁß∞"
                                    style="width: 300px; margin-right: 10px;"
                                    @change="loadUsers">
                                    <template #prefix>
                                        <el-icon><search /></el-icon>
                                    </template>
                                </el-input>
                                <el-button type="primary" @click="loadUsers">ÊêúÁ¥¢</el-button>
                                <el-button @click="userSearch=''; loadUsers()">ÈáçÁΩÆ</el-button>
                            </div>

                            <el-table :data="users" style="width: 100%" v-loading="usersLoading">
                                <el-table-column prop="id" label="ID" width="80"></el-table-column>
                                <el-table-column label="Â§¥ÂÉè" width="80">
                                    <template #default="scope">
                                        <el-avatar 
                                            :size="40" 
                                            :src="scope.row.avatar ? baseUrl + scope.row.avatar : undefined">
                                            {{ scope.row.nickname ? scope.row.nickname[0] : '?' }}
                                        </el-avatar>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="nickname" label="ÊòµÁß∞" width="120"></el-table-column>
                                <el-table-column prop="phone" label="ÊâãÊú∫Âè∑" width="130">
                                    <template #default="scope">
                                        {{ scope.row.phone || 'Êú™ÁªëÂÆö' }}
                                    </template>
                                </el-table-column>
                                <el-table-column label="ÁôªÂΩïÊñπÂºè" width="100">
                                    <template #default="scope">
                                        <el-tag v-if="scope.row.wechat_openid" type="success" size="small">ÂæÆ‰ø°</el-tag>
                                        <el-tag v-if="scope.row.phone" type="info" size="small">ÊâãÊú∫</el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="credit_limit" label="‰ø°Áî®È¢ùÂ∫¶" width="100">
                                    <template #default="scope">
                                        ¬•{{ scope.row.credit_limit }}
                                    </template>
                                </el-table-column>
                                <el-table-column prop="total_spent" label="Á¥ØËÆ°Ê∂àË¥π" width="100">
                                    <template #default="scope">
                                        ¬•{{ scope.row.total_spent }}
                                    </template>
                                </el-table-column>
                                <el-table-column prop="total_orders" label="ËÆ¢ÂçïÊï∞" width="80"></el-table-column>
                                <el-table-column label="Áä∂ÊÄÅ" width="80">
                                    <template #default="scope">
                                        <el-tag 
                                            :type="scope.row.status === 'active' ? 'success' : 'danger'" 
                                            size="small">
                                            {{ getStatusText(scope.row.status) }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="created_at" label="Ê≥®ÂÜåÊó∂Èó¥" width="170">
                                    <template #default="scope">
                                        {{ formatDate(scope.row.created_at) }}
                                    </template>
                                </el-table-column>
                                <el-table-column label="Êìç‰Ωú" width="200" fixed="right">
                                    <template #default="scope">
                                        <el-button type="primary" size="small" @click="viewUser(scope.row)">
                                            Êü•Áúã
                                        </el-button>
                                        <el-button 
                                            v-if="scope.row.status === 'active'"
                                            type="danger" 
                                            size="small" 
                                            @click="updateUserStatus(scope.row.id, 'banned')">
                                            Á¶ÅÁî®
                                        </el-button>
                                        <el-button 
                                            v-else
                                            type="success" 
                                            size="small" 
                                            @click="updateUserStatus(scope.row.id, 'active')">
                                            ÊøÄÊ¥ª
                                        </el-button>
                                    </template>
                                </el-table-column>
                            </el-table>

                            <el-pagination
                                v-model:current-page="userPage"
                                v-model:page-size="userPageSize"
                                :page-sizes="[10, 20, 50, 100]"
                                :total="userTotal"
                                layout="total, sizes, prev, pager, next, jumper"
                                @size-change="loadUsers"
                                @current-change="loadUsers"
                                style="margin-top: 20px; justify-content: center;">
                            </el-pagination>

                            <!-- Áî®Êà∑ËØ¶ÊÉÖÂØπËØùÊ°Ü -->
                            <el-dialog v-model="userDialogVisible" title="Áî®Êà∑ËØ¶ÊÉÖ" width="700px">
                                <div v-if="selectedUser" style="display: flex; gap: 20px;">
                                    <!-- Â∑¶‰æßÂ§¥ÂÉè -->
                                    <div style="flex-shrink: 0; text-align: center;">
                                        <el-avatar 
                                            :size="120" 
                                            :src="selectedUser.avatar ? baseUrl + selectedUser.avatar : undefined"
                                            style="margin-bottom: 12px;">
                                            {{ selectedUser.nickname ? selectedUser.nickname[0] : '?' }}
                                        </el-avatar>
                                        <div>
                                            <el-button size="small" @click="avatarUploadVisible = true; currentEditUserId = selectedUser.id">
                                                ‰øÆÊîπÂ§¥ÂÉè
                                            </el-button>
                                        </div>
                                    </div>
                                    
                                    <!-- Âè≥‰æßËØ¶ÊÉÖ -->
                                    <div style="flex: 1;">
                                        <el-descriptions :column="2" border>
                                            <el-descriptions-item label="Áî®Êà∑ID">{{ selectedUser.id }}</el-descriptions-item>
                                            <el-descriptions-item label="ÊòµÁß∞">{{ selectedUser.nickname }}</el-descriptions-item>
                                            <el-descriptions-item label="ÊâãÊú∫Âè∑">{{ selectedUser.phone || 'Êú™ÁªëÂÆö' }}</el-descriptions-item>
                                            <el-descriptions-item label="ÈÇÆÁÆ±">{{ selectedUser.email || 'Êú™Â°´ÂÜô' }}</el-descriptions-item>
                                            <el-descriptions-item label="ÂæÆ‰ø°OpenID" :span="2">
                                                {{ selectedUser.wechat_openid || 'Êú™ÁªëÂÆö' }}
                                            </el-descriptions-item>
                                            <el-descriptions-item label="ÂÆûÂêçËÆ§ËØÅ">
                                                <el-tag :type="selectedUser.is_certified ? 'success' : 'info'" size="small">
                                                    {{ selectedUser.is_certified ? 'Â∑≤ËÆ§ËØÅ' : 'Êú™ËÆ§ËØÅ' }}
                                                </el-tag>
                                            </el-descriptions-item>
                                            <el-descriptions-item label="‰ºöÂëòÁ≠âÁ∫ß">
                                                {{ getMemberLevelText(selectedUser.membership_level) }}
                                            </el-descriptions-item>
                                            <el-descriptions-item label="‰ø°Áî®È¢ùÂ∫¶">¬•{{ selectedUser.credit_limit }}</el-descriptions-item>
                                            <el-descriptions-item label="Â∑≤Áî®È¢ùÂ∫¶">¬•{{ selectedUser.used_credit }}</el-descriptions-item>
                                            <el-descriptions-item label="È¢Ñ‰ªò‰ΩôÈ¢ù">¬•{{ selectedUser.prepaid_balance }}</el-descriptions-item>
                                            <el-descriptions-item label="ÁßØÂàÜ‰ΩôÈ¢ù">{{ selectedUser.points_balance }}</el-descriptions-item>
                                            <el-descriptions-item label="Á¥ØËÆ°Ê∂àË¥π">¬•{{ selectedUser.total_spent }}</el-descriptions-item>
                                            <el-descriptions-item label="ËÆ¢ÂçïÊÄªÊï∞">{{ selectedUser.total_orders }}</el-descriptions-item>
                                            <el-descriptions-item label="Ë¥¶Êà∑Áä∂ÊÄÅ">
                                                <el-tag :type="selectedUser.status === 'active' ? 'success' : 'danger'" size="small">
                                                    {{ getStatusText(selectedUser.status) }}
                                                </el-tag>
                                            </el-descriptions-item>
                                            <el-descriptions-item label="Ê≥®ÂÜåÊó∂Èó¥">{{ formatDate(selectedUser.created_at) }}</el-descriptions-item>
                                            <el-descriptions-item label="ÊúÄÂêéÁôªÂΩï">{{ formatDate(selectedUser.last_login_at) }}</el-descriptions-item>
                                        </el-descriptions>
                                    </div>
                                </div>
                            </el-dialog>

                            <!-- ‰øÆÊîπÂ§¥ÂÉèÂØπËØùÊ°Ü -->
                            <el-dialog v-model="avatarUploadVisible" title="‰øÆÊîπÁî®Êà∑Â§¥ÂÉè" width="400px">
                                <el-upload
                                    drag
                                    :action="uploadUrl"
                                    :headers="uploadHeaders"
                                    :on-success="handleAvatarUploadSuccess"
                                    :before-upload="beforeUpload"
                                    accept="image/*">
                                    <el-icon class="el-icon--upload"><upload-filled /></el-icon>
                                    <div class="el-upload__text">
                                        Â∞ÜÂ§¥ÂÉèÊãñÂà∞Ê≠§Â§ÑÔºåÊàñ<em>ÁÇπÂáª‰∏ä‰º†</em>
                                    </div>
                                    <template #tip>
                                        <div class="el-upload__tip">
                                            Âª∫ËÆÆÂ∞∫ÂØ∏ 200x200pxÔºåÊîØÊåÅ jpg/png Ê†ºÂºè
                                        </div>
                                    </template>
                                </el-upload>
                            </el-dialog>
                        </div>
                    </div>

                    <!-- È°πÁõÆÁÆ°ÁêÜ -->
                    <div v-show="activeMenu === 'projects'">
                        <div class="page-header">
                            <h3>üì∏ È°πÁõÆÁÆ°ÁêÜ</h3>
                        </div>
                        
                        <div class="content-card">
                            <div style="margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <el-input 
                                        v-model="projectSearch" 
                                        placeholder="ÊêúÁ¥¢È°πÁõÆÂêçÁß∞ÊàñÁºñÂè∑"
                                        style="width: 300px; margin-right: 10px;"
                                        @change="loadProjects">
                                        <template #prefix>
                                            <el-icon><search /></el-icon>
                                        </template>
                                    </el-input>
                                    <el-select v-model="projectCategoryFilter" placeholder="ÈÄâÊã©ÂàÜÁ±ª" style="width: 150px; margin-right: 10px;" @change="loadProjects" clearable>
                                        <el-option v-for="cat in categories" :key="cat.id" :label="cat.name" :value="cat.id"></el-option>
                                    </el-select>
                                    <el-button type="primary" @click="loadProjects">ÊêúÁ¥¢</el-button>
                                    <el-button @click="projectSearch=''; projectCategoryFilter=null; loadProjects()">ÈáçÁΩÆ</el-button>
                                </div>
                                <el-button type="primary" @click="showProjectDialog()">
                                    <el-icon><plus /></el-icon> Ê∑ªÂä†È°πÁõÆ
                                </el-button>
                            </div>

                            <el-table :data="projects" style="width: 100%" v-loading="projectsLoading">
                                <el-table-column prop="id" label="ID" width="60"></el-table-column>
                                <el-table-column label="Â∞ÅÈù¢" width="80">
                                    <template #default="scope">
                                        <el-image 
                                            v-if="scope.row.cover_image"
                                            :src="scope.row.cover_image" 
                                            style="width: 60px; height: 60px; border-radius: 4px;"
                                            fit="cover"
                                            :preview-src-list="[scope.row.cover_image]">
                                        </el-image>
                                        <span v-else style="color: #ccc;">Êó†</span>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="project_no" label="ÁºñÂè∑" width="100"></el-table-column>
                                <el-table-column prop="name" label="È°πÁõÆÂêçÁß∞" width="200" show-overflow-tooltip></el-table-column>
                                <el-table-column prop="category_name" label="ÂàÜÁ±ª" width="120"></el-table-column>
                                <el-table-column label="‰ª∑Ê†º" width="120">
                                    <template #default="scope">
                                        <div>¬•{{ scope.row.current_price }}</div>
                                        <div style="font-size: 12px; color: #999; text-decoration: line-through;">¬•{{ scope.row.original_price }}</div>
                                    </template>
                                </el-table-column>
                                <el-table-column label="Ê†áÁ≠æ" width="120">
                                    <template #default="scope">
                                        <el-tag v-if="scope.row.is_hot" type="danger" size="small" style="margin-right: 5px;">ÁÉ≠Èó®</el-tag>
                                        <el-tag v-if="scope.row.is_recommended" type="warning" size="small">Êé®Ëçê</el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column label="ÁªüËÆ°" width="100">
                                    <template #default="scope">
                                        <div style="font-size: 12px;">ÊµèËßà: {{ scope.row.view_count }}</div>
                                        <div style="font-size: 12px;">È¢ÑÁ∫¶: {{ scope.row.booking_count }}</div>
                                    </template>
                                </el-table-column>
                                <el-table-column label="Áä∂ÊÄÅ" width="80">
                                    <template #default="scope">
                                        <el-tag :type="scope.row.status === 'active' ? 'success' : 'info'" size="small">
                                            {{ scope.row.status === 'active' ? '‰∏äÊû∂' : '‰∏ãÊû∂' }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column label="Êìç‰Ωú" width="240" fixed="right">
                                    <template #default="scope">
                                        <el-button type="primary" size="small" @click="showProjectDialog(scope.row)">ÁºñËæë</el-button>
                                        <el-button 
                                            v-if="scope.row.status === 'active'"
                                            type="warning" 
                                            size="small" 
                                            @click="updateProjectStatus(scope.row.id, 'inactive')">
                                            ‰∏ãÊû∂
                                        </el-button>
                                        <el-button 
                                            v-else
                                            type="success" 
                                            size="small" 
                                            @click="updateProjectStatus(scope.row.id, 'active')">
                                            ‰∏äÊû∂
                                        </el-button>
                                        <el-button type="danger" size="small" @click="deleteProject(scope.row.id)">Âà†Èô§</el-button>
                                    </template>
                                </el-table-column>
                            </el-table>

                            <el-pagination
                                v-model:current-page="projectPage"
                                v-model:page-size="projectPageSize"
                                :page-sizes="[10, 20, 50]"
                                :total="projectTotal"
                                layout="total, sizes, prev, pager, next, jumper"
                                @size-change="loadProjects"
                                @current-change="loadProjects"
                                style="margin-top: 20px; justify-content: center;">
                            </el-pagination>

                            <!-- Ê∑ªÂä†/ÁºñËæëÈ°πÁõÆÂØπËØùÊ°Ü -->
                            <el-dialog 
                                v-model="projectDialogVisible" 
                                :title="projectForm.id ? 'ÁºñËæëÈ°πÁõÆ' : 'Ê∑ªÂä†È°πÁõÆ'" 
                                width="600px">
                                <el-form :model="projectForm" label-width="120px">
                                    <el-form-item label="È°πÁõÆÁºñÂè∑" required>
                                        <el-input v-model="projectForm.project_no" placeholder="Â¶Ç: PRJ001" :disabled="!!projectForm.id"></el-input>
                                    </el-form-item>
                                    <el-form-item label="È°πÁõÆÂêçÁß∞" required>
                                        <el-input v-model="projectForm.name" placeholder="ËØ∑ËæìÂÖ•È°πÁõÆÂêçÁß∞"></el-input>
                                    </el-form-item>
                                    <el-form-item label="ÂàÜÁ±ª" required>
                                        <el-select v-model="projectForm.category_id" placeholder="ËØ∑ÈÄâÊã©ÂàÜÁ±ª" style="width: 100%;">
                                            <el-option v-for="cat in categories" :key="cat.id" :label="cat.name" :value="cat.id"></el-option>
                                        </el-select>
                                    </el-form-item>
                                    <el-form-item label="Âéü‰ª∑" required>
                                        <el-input-number v-model="projectForm.original_price" :min="0" :precision="2" style="width: 100%;"></el-input-number>
                                    </el-form-item>
                                    <el-form-item label="Áé∞‰ª∑" required>
                                        <el-input-number v-model="projectForm.current_price" :min="0" :precision="2" style="width: 100%;"></el-input-number>
                                    </el-form-item>
                                    <el-form-item label="Âçï‰Ωç">
                                        <el-input v-model="projectForm.unit" placeholder="Â¶Ç: Ê†∑ÂìÅ„ÄÅÊ¨°"></el-input>
                                    </el-form-item>
                                    <el-form-item label="ÊúçÂä°Âë®Êúü">
                                        <div style="display: flex; gap: 10px; align-items: center;">
                                            <el-input-number v-model="projectForm.service_cycle_min" :min="1" placeholder="ÊúÄÁü≠"></el-input-number>
                                            <span>~</span>
                                            <el-input-number v-model="projectForm.service_cycle_max" :min="1" placeholder="ÊúÄÈïø"></el-input-number>
                                            <span>Â∑•‰ΩúÊó•</span>
                                        </div>
                                    </el-form-item>
                                    <el-form-item label="‰ª™Âô®ÂêçÁß∞">
                                        <el-input v-model="projectForm.equipment_name" placeholder="ËØ∑ËæìÂÖ•‰ª™Âô®ÂêçÁß∞"></el-input>
                                    </el-form-item>
                                    <el-form-item label="È°πÁõÆ‰ªãÁªç">
                                        <el-input v-model="projectForm.introduction" type="textarea" :rows="3" placeholder="ËØ∑ËæìÂÖ•È°πÁõÆ‰ªãÁªç"></el-input>
                                    </el-form-item>
                                    <el-form-item label="Ê†∑ÂìÅË¶ÅÊ±Ç">
                                        <el-input v-model="projectForm.sample_requirements" type="textarea" :rows="3" placeholder="ËØ∑ËæìÂÖ•Ê†∑ÂìÅË¶ÅÊ±Ç"></el-input>
                                    </el-form-item>
                                    <el-form-item label="Â∞ÅÈù¢Âõæ">
                                        <div>
                                            <el-input v-model="projectForm.cover_image" placeholder="ÂõæÁâáURL" style="margin-bottom: 10px;"></el-input>
                                            <el-upload
                                                :action="uploadUrl"
                                                :headers="uploadHeaders"
                                                :on-success="handleProjectImageUpload"
                                                :show-file-list="false"
                                                accept="image/*">
                                                <el-button size="small" type="primary">‰∏ä‰º†Â∞ÅÈù¢Âõæ</el-button>
                                            </el-upload>
                                            <el-image 
                                                v-if="projectForm.cover_image"
                                                :src="projectForm.cover_image" 
                                                style="width: 100px; height: 100px; margin-top: 10px;"
                                                fit="cover">
                                            </el-image>
                                        </div>
                                    </el-form-item>
                                    <el-form-item label="Ê†áÁ≠æ">
                                        <el-checkbox v-model="projectForm.is_hot">ÁÉ≠Èó®</el-checkbox>
                                        <el-checkbox v-model="projectForm.is_recommended">Êé®Ëçê</el-checkbox>
                                    </el-form-item>
                                    <el-form-item label="ÊéíÂ∫è">
                                        <el-input-number v-model="projectForm.sort_order" :min="0"></el-input-number>
                                    </el-form-item>
                                </el-form>
                                <template #footer>
                                    <el-button @click="projectDialogVisible = false">ÂèñÊ∂à</el-button>
                                    <el-button type="primary" @click="saveProject" :loading="loading">‰øùÂ≠ò</el-button>
                                </template>
                            </el-dialog>
                        </div>
                    </div>

                    <!-- ËÆ¢ÂçïÁÆ°ÁêÜ -->
                    <div v-show="activeMenu === 'orders'">
                        <div class="page-header">
                            <h3>üì¶ ËÆ¢ÂçïÁÆ°ÁêÜ</h3>
                        </div>
                        <div class="content-card">
                            <div style="margin-bottom: 16px; display: flex; justify-content: space-between;">
                                <div style="display: flex; gap: 10px;">
                                    <el-input
                                        v-model="orderSearch"
                                        placeholder="ÊêúÁ¥¢ËÆ¢ÂçïÂè∑/Áî®Êà∑ÊâãÊú∫Âè∑"
                                        style="width: 300px;"
                                        clearable
                                        @change="loadOrders">
                                        <template #prefix>
                                            <el-icon><search /></el-icon>
                                        </template>
                                    </el-input>
                                    <el-select v-model="orderStatusFilter" placeholder="ËÆ¢ÂçïÁä∂ÊÄÅ" style="width: 150px;" @change="loadOrders" clearable>
                                        <el-option label="ÂæÖÊîØ‰ªò" value="unpaid"></el-option>
                                        <el-option label="Â∑≤ÊîØ‰ªò" value="paid"></el-option>
                                        <el-option label="Â∑≤Á°ÆËÆ§" value="confirmed"></el-option>
                                        <el-option label="ÂÆûÈ™å‰∏≠" value="testing"></el-option>
                                        <el-option label="Â∑≤ÂÆåÊàê" value="completed"></el-option>
                                        <el-option label="Â∑≤ÂèñÊ∂à" value="cancelled"></el-option>
                                    </el-select>
                                    <el-button type="primary" @click="loadOrders">ÊêúÁ¥¢</el-button>
                                    <el-button @click="orderSearch=''; orderStatusFilter=null; loadOrders()">ÈáçÁΩÆ</el-button>
                                </div>
                            </div>

                            <el-table :data="orders" style="width: 100%" v-loading="ordersLoading">
                                <el-table-column prop="id" label="ID" width="80"></el-table-column>
                                <el-table-column prop="order_no" label="ËÆ¢ÂçïÂè∑" width="200"></el-table-column>
                                <el-table-column label="Áî®Êà∑" width="150">
                                    <template #default="scope">
                                        <div>{{ scope.row.user_nickname }}</div>
                                        <div style="font-size: 12px; color: #999;">{{ scope.row.user_phone }}</div>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="project_name" label="Ê£ÄÊµãÈ°πÁõÆ" width="200"></el-table-column>
                                <el-table-column label="Ê†∑ÂìÅ" width="150">
                                    <template #default="scope">
                                        <div>{{ scope.row.sample_name }}</div>
                                        <div style="font-size: 12px; color: #999;">Êï∞ÈáèÔºö{{ scope.row.quantity }}</div>
                                    </template>
                                </el-table-column>
                                <el-table-column label="ÈáëÈ¢ù" width="120">
                                    <template #default="scope">
                                        <span style="color: #ff4d4f; font-weight: 600;">¬•{{ scope.row.total_amount }}</span>
                                    </template>
                                </el-table-column>
                                <el-table-column label="Áä∂ÊÄÅ" width="100">
                                    <template #default="scope">
                                        <el-tag :type="getOrderStatusType(scope.row.status)" size="small">
                                            {{ getOrderStatusText(scope.row.status) }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column label="ÂàõÂª∫Êó∂Èó¥" width="180">
                                    <template #default="scope">
                                        {{ formatDateTime(scope.row.created_at) }}
                                    </template>
                                </el-table-column>
                                <el-table-column label="Êìç‰Ωú" width="200" fixed="right">
                                    <template #default="scope">
                                        <el-button link type="primary" size="small" @click="viewOrderDetail(scope.row)">ËØ¶ÊÉÖ</el-button>
                                        <el-button link type="warning" size="small" @click="showOrderStatusDialog(scope.row)">ÊîπÁä∂ÊÄÅ</el-button>
                                    </template>
                                </el-table-column>
                            </el-table>

                            <el-pagination
                                v-model:current-page="orderPage"
                                v-model:page-size="orderPageSize"
                                :page-sizes="[10, 20, 50, 100]"
                                :total="orderTotal"
                                layout="total, sizes, prev, pager, next, jumper"
                                @size-change="loadOrders"
                                @current-change="loadOrders"
                                style="margin-top: 20px; justify-content: center;">
                            </el-pagination>
                        </div>
                    </div>

                    <!-- ÂàÜÁ±ªÁÆ°ÁêÜ -->
                    <div v-show="activeMenu === 'categories'">
                        <div class="page-header">
                            <h3>üìÇ ÂàÜÁ±ªÁÆ°ÁêÜ</h3>
                        </div>
                        <div class="content-card">
                            <div style="margin-bottom: 16px; display: flex; justify-content: space-between;">
                                <div>
                                    <el-input v-model="categorySearch" placeholder="ÊêúÁ¥¢ÂàÜÁ±ªÂêçÁß∞" style="width: 250px;" clearable @change="loadCategories">
                                        <template #prefix><el-icon><search /></el-icon></template>
                                    </el-input>
                                    <el-button type="primary" @click="loadCategories" style="margin-left: 10px;">ÊêúÁ¥¢</el-button>
                                </div>
                                <el-button type="primary" @click="showCategoryDialog()"><el-icon><plus /></el-icon> Ê∑ªÂä†ÂàÜÁ±ª</el-button>
                            </div>
                            <el-table :data="categoryList" v-loading="categoryLoading">
                                <el-table-column prop="id" label="ID" width="80"></el-table-column>
                                <el-table-column label="ÂõæÊ†á" width="80">
                                    <template #default="scope">
                                        <el-image v-if="scope.row.icon" :src="scope.row.icon" style="width: 40px; height: 40px;" fit="cover"></el-image>
                                        <span v-else style="color: #ccc;">-</span>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="name" label="ÂêçÁß∞" width="150"></el-table-column>
                                <el-table-column prop="code" label="ÁºñÁ†Å" width="120"></el-table-column>
                                <el-table-column prop="sort_order" label="ÊéíÂ∫è" width="80"></el-table-column>
                                <el-table-column label="ÁÉ≠Èó®" width="80">
                                    <template #default="scope">
                                        <el-tag :type="scope.row.is_hot ? 'danger' : 'info'" size="small">{{ scope.row.is_hot ? 'ÊòØ' : 'Âê¶' }}</el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column label="Áä∂ÊÄÅ" width="80">
                                    <template #default="scope">
                                        <el-tag :type="scope.row.is_active ? 'success' : 'info'" size="small">{{ scope.row.is_active ? 'ÂêØÁî®' : 'Á¶ÅÁî®' }}</el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column label="Êìç‰Ωú" width="180">
                                    <template #default="scope">
                                        <el-button link type="primary" size="small" @click="showCategoryDialog(scope.row)">ÁºñËæë</el-button>
                                        <el-button link type="danger" size="small" @click="deleteCategory(scope.row.id)">Âà†Èô§</el-button>
                                    </template>
                                </el-table-column>
                            </el-table>
                            <el-pagination v-model:current-page="categoryPage" v-model:page-size="categoryPageSize" :total="categoryTotal"
                                layout="total, prev, pager, next" @current-change="loadCategories" style="margin-top: 16px; justify-content: center;">
                            </el-pagination>
                        </div>
                        <!-- ÂàÜÁ±ªÂØπËØùÊ°Ü -->
                        <el-dialog v-model="categoryDialogVisible" :title="categoryForm.id ? 'ÁºñËæëÂàÜÁ±ª' : 'Ê∑ªÂä†ÂàÜÁ±ª'" width="500px">
                            <el-form :model="categoryForm" label-width="80px">
                                <el-form-item label="ÂêçÁß∞" required><el-input v-model="categoryForm.name"></el-input></el-form-item>
                                <el-form-item label="ÁºñÁ†Å"><el-input v-model="categoryForm.code" placeholder="Â¶Ç: SEM"></el-input></el-form-item>
                                <el-form-item label="ÂõæÊ†á"><el-input v-model="categoryForm.icon" placeholder="ÂõæÊ†áURL"></el-input></el-form-item>
                                <el-form-item label="ÊéíÂ∫è"><el-input-number v-model="categoryForm.sort_order" :min="0"></el-input-number></el-form-item>
                                <el-form-item label="ÁÉ≠Èó®"><el-switch v-model="categoryForm.is_hot"></el-switch></el-form-item>
                                <el-form-item label="ÊèèËø∞"><el-input v-model="categoryForm.description" type="textarea" :rows="2"></el-input></el-form-item>
                            </el-form>
                            <template #footer>
                                <el-button @click="categoryDialogVisible = false">ÂèñÊ∂à</el-button>
                                <el-button type="primary" @click="saveCategory" :loading="loading">‰øùÂ≠ò</el-button>
                            </template>
                        </el-dialog>
                    </div>

                    <!-- ‰ºòÊÉ†Âà∏ÁÆ°ÁêÜ -->
                    <div v-show="activeMenu === 'coupons'">
                        <div class="page-header">
                            <h3>üéÅ ‰ºòÊÉ†Âà∏ÁÆ°ÁêÜ</h3>
                        </div>
                        <div class="content-card">
                            <div style="margin-bottom: 16px; display: flex; justify-content: space-between;">
                                <div>
                                    <el-input v-model="couponSearch" placeholder="ÊêúÁ¥¢‰ºòÊÉ†Âà∏ÂêçÁß∞" style="width: 250px;" clearable @change="loadCoupons">
                                        <template #prefix><el-icon><search /></el-icon></template>
                                    </el-input>
                                    <el-button type="primary" @click="loadCoupons" style="margin-left: 10px;">ÊêúÁ¥¢</el-button>
                                </div>
                                <el-button type="primary" @click="showCouponDialog()"><el-icon><plus /></el-icon> Ê∑ªÂä†‰ºòÊÉ†Âà∏</el-button>
                            </div>
                            <el-table :data="couponList" v-loading="couponLoading">
                                <el-table-column prop="id" label="ID" width="60"></el-table-column>
                                <el-table-column prop="name" label="ÂêçÁß∞" width="150"></el-table-column>
                                <el-table-column label="Á±ªÂûã" width="100">
                                    <template #default="scope">
                                        <el-tag size="small">{{ getCouponTypeText(scope.row.type) }}</el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column label="‰ºòÊÉ†" width="120">
                                    <template #default="scope">
                                        <span v-if="scope.row.type === 'cash'">¬•{{ scope.row.cash_amount }}</span>
                                        <span v-else-if="scope.row.type === 'discount'">{{ (scope.row.discount_rate * 10).toFixed(1) }}Êäò</span>
                                        <span v-else>Êª°{{ scope.row.full_amount }}Âáè{{ scope.row.reduction_amount }}</span>
                                    </template>
                                </el-table-column>
                                <el-table-column label="ÂèëÊîæ/È¢ÜÂèñ" width="100">
                                    <template #default="scope">{{ scope.row.received_quantity }}/{{ scope.row.total_quantity || '‰∏çÈôê' }}</template>
                                </el-table-column>
                                <el-table-column prop="valid_days" label="ÊúâÊïàÊúü" width="80">
                                    <template #default="scope">{{ scope.row.valid_days }}Â§©</template>
                                </el-table-column>
                                <el-table-column label="Áä∂ÊÄÅ" width="80">
                                    <template #default="scope">
                                        <el-tag :type="scope.row.status === 'active' ? 'success' : 'info'" size="small">{{ scope.row.status === 'active' ? 'ÂèØÈ¢Ü' : 'Â∑≤‰∏ãÊû∂' }}</el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column label="Êìç‰Ωú" width="160">
                                    <template #default="scope">
                                        <el-button link type="primary" size="small" @click="showCouponDialog(scope.row)">ÁºñËæë</el-button>
                                        <el-button link type="danger" size="small" @click="deleteCoupon(scope.row.id)">‰∏ãÊû∂</el-button>
                                    </template>
                                </el-table-column>
                            </el-table>
                            <el-pagination v-model:current-page="couponPage" v-model:page-size="couponPageSize" :total="couponTotal"
                                layout="total, prev, pager, next" @current-change="loadCoupons" style="margin-top: 16px; justify-content: center;">
                            </el-pagination>
                        </div>
                        <!-- ‰ºòÊÉ†Âà∏ÂØπËØùÊ°Ü -->
                        <el-dialog v-model="couponDialogVisible" :title="couponForm.id ? 'ÁºñËæë‰ºòÊÉ†Âà∏' : 'Ê∑ªÂä†‰ºòÊÉ†Âà∏'" width="550px">
                            <el-form :model="couponForm" label-width="100px">
                                <el-form-item label="ÂêçÁß∞" required><el-input v-model="couponForm.name"></el-input></el-form-item>
                                <el-form-item label="Á±ªÂûã" required>
                                    <el-select v-model="couponForm.type" style="width: 100%;">
                                        <el-option label="‰ª£ÈáëÂà∏" value="cash"></el-option>
                                        <el-option label="ÊäòÊâ£Âà∏" value="discount"></el-option>
                                        <el-option label="Êª°ÂáèÂà∏" value="full_reduction"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="‰ª£ÈáëÈáëÈ¢ù" v-if="couponForm.type === 'cash'">
                                    <el-input-number v-model="couponForm.cash_amount" :min="0" :precision="2" style="width: 100%;"></el-input-number>
                                </el-form-item>
                                <el-form-item label="ÊäòÊâ£Áéá" v-if="couponForm.type === 'discount'">
                                    <el-input-number v-model="couponForm.discount_rate" :min="0.1" :max="0.99" :step="0.1" :precision="2" style="width: 100%;"></el-input-number>
                                    <div style="font-size: 12px; color: #999;">Â¶Ç0.9Ë°®Á§∫9Êäò</div>
                                </el-form-item>
                                <el-form-item label="Êª°ÂáèÈó®Êßõ" v-if="couponForm.type === 'full_reduction'">
                                    <el-input-number v-model="couponForm.full_amount" :min="0" :precision="2" style="width: 100%;"></el-input-number>
                                </el-form-item>
                                <el-form-item label="ÂáèÂÖçÈáëÈ¢ù" v-if="couponForm.type === 'full_reduction'">
                                    <el-input-number v-model="couponForm.reduction_amount" :min="0" :precision="2" style="width: 100%;"></el-input-number>
                                </el-form-item>
                                <el-form-item label="ÊúÄ‰ΩéÊ∂àË¥π"><el-input-number v-model="couponForm.min_order_amount" :min="0" :precision="2" style="width: 100%;"></el-input-number></el-form-item>
                                <el-form-item label="ÂèëÊîæÊï∞Èáè"><el-input-number v-model="couponForm.total_quantity" :min="0" style="width: 100%;"></el-input-number><div style="font-size: 12px; color: #999;">0Ë°®Á§∫‰∏çÈôêÈáè</div></el-form-item>
                                <el-form-item label="ÊúâÊïàÂ§©Êï∞"><el-input-number v-model="couponForm.valid_days" :min="1" style="width: 100%;"></el-input-number></el-form-item>
                                <el-form-item label="ÊèèËø∞"><el-input v-model="couponForm.description" type="textarea" :rows="2"></el-input></el-form-item>
                            </el-form>
                            <template #footer>
                                <el-button @click="couponDialogVisible = false">ÂèñÊ∂à</el-button>
                                <el-button type="primary" @click="saveCoupon" :loading="loading">‰øùÂ≠ò</el-button>
                            </template>
                        </el-dialog>
                    </div>

                    <!-- ÂÖÖÂÄºÁÆ°ÁêÜ -->
                    <div v-show="activeMenu === 'recharges'">
                        <div class="page-header">
                            <h3>üí∞ ÂÖÖÂÄºÁÆ°ÁêÜ</h3>
                        </div>
                        <div class="content-card">
                            <div style="margin-bottom: 16px; display: flex; gap: 10px;">
                                <el-input v-model="rechargeSearch" placeholder="ÊêúÁ¥¢ÂÖÖÂÄºÂçïÂè∑/ÊâãÊú∫Âè∑" style="width: 250px;" clearable @change="loadRecharges">
                                    <template #prefix><el-icon><search /></el-icon></template>
                                </el-input>
                                <el-select v-model="rechargeStatusFilter" placeholder="Áä∂ÊÄÅÁ≠õÈÄâ" style="width: 120px;" clearable @change="loadRecharges">
                                    <el-option label="ÂæÖÊîØ‰ªò" value="pending"></el-option>
                                    <el-option label="ÊàêÂäü" value="success"></el-option>
                                    <el-option label="Â§±Ë¥•" value="failed"></el-option>
                                    <el-option label="Â∑≤ÈÄÄÊ¨æ" value="refunded"></el-option>
                                </el-select>
                                <el-button type="primary" @click="loadRecharges">ÊêúÁ¥¢</el-button>
                                <el-button @click="rechargeSearch=''; rechargeStatusFilter=null; loadRecharges()">ÈáçÁΩÆ</el-button>
                            </div>
                            <el-table :data="rechargeList" v-loading="rechargeLoading">
                                <el-table-column prop="id" label="ID" width="60"></el-table-column>
                                <el-table-column prop="recharge_no" label="ÂÖÖÂÄºÂçïÂè∑" width="180"></el-table-column>
                                <el-table-column label="Áî®Êà∑" width="150">
                                    <template #default="scope">
                                        <div>{{ scope.row.user_nickname }}</div>
                                        <div style="font-size: 12px; color: #999;">{{ scope.row.user_phone }}</div>
                                    </template>
                                </el-table-column>
                                <el-table-column label="ÂÖÖÂÄºÈáëÈ¢ù" width="100">
                                    <template #default="scope"><span style="color: #ff4d4f; font-weight: 600;">¬•{{ scope.row.amount }}</span></template>
                                </el-table-column>
                                <el-table-column label="ÂÆûÈôÖÂà∞Ë¥¶" width="100">
                                    <template #default="scope"><span style="color: #52c41a;">¬•{{ scope.row.actual_amount }}</span></template>
                                </el-table-column>
                                <el-table-column label="Ëµ†ÈÄÅ" width="80">
                                    <template #default="scope">¬•{{ scope.row.bonus_amount || 0 }}</template>
                                </el-table-column>
                                <el-table-column label="ÊñπÂºè" width="80">
                                    <template #default="scope">
                                        <el-tag size="small" :type="scope.row.payment_method === 'wechat' ? 'success' : 'primary'">{{ scope.row.payment_method === 'wechat' ? 'ÂæÆ‰ø°' : 'ÊîØ‰ªòÂÆù' }}</el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column label="Áä∂ÊÄÅ" width="80">
                                    <template #default="scope">
                                        <el-tag :type="getRechargeStatusType(scope.row.status)" size="small">{{ getRechargeStatusText(scope.row.status) }}</el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column label="Êó∂Èó¥" width="160">
                                    <template #default="scope">{{ formatDateTime(scope.row.created_at) }}</template>
                                </el-table-column>
                                <el-table-column label="Êìç‰Ωú" width="120">
                                    <template #default="scope">
                                        <el-button v-if="scope.row.status === 'pending'" link type="success" size="small" @click="updateRechargeStatus(scope.row.id, 'success')">Á°ÆËÆ§</el-button>
                                        <el-button v-if="scope.row.status === 'pending'" link type="danger" size="small" @click="updateRechargeStatus(scope.row.id, 'failed')">Â§±Ë¥•</el-button>
                                    </template>
                                </el-table-column>
                            </el-table>
                            <el-pagination v-model:current-page="rechargePage" v-model:page-size="rechargePageSize" :total="rechargeTotal"
                                layout="total, prev, pager, next" @current-change="loadRecharges" style="margin-top: 16px; justify-content: center;">
                            </el-pagination>
                        </div>
                    </div>

                    <!-- ÁßØÂàÜÂïÜÂìÅÁÆ°ÁêÜ -->
                    <div v-show="activeMenu === 'points'">
                        <div class="page-header">
                            <h3>üéØ ÁßØÂàÜÂïÜÂìÅÁÆ°ÁêÜ</h3>
                        </div>
                        <div class="content-card">
                            <div style="margin-bottom: 16px; display: flex; justify-content: space-between;">
                                <div style="display: flex; gap: 10px;">
                                    <el-input v-model="pointsGoodsSearch" placeholder="ÊêúÁ¥¢ÂïÜÂìÅÂêçÁß∞" style="width: 200px;" clearable @change="loadPointsGoods">
                                        <template #prefix><el-icon><search /></el-icon></template>
                                    </el-input>
                                    <el-select v-model="pointsGoodsCategoryFilter" placeholder="ÂàÜÁ±ª" style="width: 120px;" clearable @change="loadPointsGoods">
                                        <el-option label="‰ºòÊÉ†Âà∏" value="‰ºòÊÉ†Âà∏"></el-option>
                                        <el-option label="‰∫¨‰∏úEÂç°" value="‰∫¨‰∏úEÂç°"></el-option>
                                        <el-option label="ÂÆûÁâ©Á§º" value="ÂÆûÁâ©Á§º"></el-option>
                                    </el-select>
                                    <el-button type="primary" @click="loadPointsGoods">ÊêúÁ¥¢</el-button>
                                </div>
                                <el-button type="primary" @click="showPointsGoodsDialog()"><el-icon><plus /></el-icon> Ê∑ªÂä†ÂïÜÂìÅ</el-button>
                            </div>
                            <el-table :data="pointsGoodsList" v-loading="pointsGoodsLoading">
                                <el-table-column prop="id" label="ID" width="60"></el-table-column>
                                <el-table-column label="ÂõæÁâá" width="80">
                                    <template #default="scope">
                                        <el-image v-if="scope.row.image" :src="scope.row.image" style="width: 50px; height: 50px;" fit="cover"></el-image>
                                        <span v-else style="color: #ccc;">-</span>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="name" label="ÂïÜÂìÅÂêçÁß∞" width="180"></el-table-column>
                                <el-table-column label="ÁßØÂàÜ" width="100">
                                    <template #default="scope"><span style="color: #ff9500; font-weight: 600;">{{ scope.row.points }}</span></template>
                                </el-table-column>
                                <el-table-column prop="category" label="ÂàÜÁ±ª" width="100"></el-table-column>
                                <el-table-column prop="stock" label="Â∫ìÂ≠ò" width="80"></el-table-column>
                                <el-table-column label="Áä∂ÊÄÅ" width="80">
                                    <template #default="scope">
                                        <el-tag :type="scope.row.is_active ? 'success' : 'info'" size="small">{{ scope.row.is_active ? '‰∏äÊû∂' : '‰∏ãÊû∂' }}</el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column label="Êìç‰Ωú" width="160">
                                    <template #default="scope">
                                        <el-button link type="primary" size="small" @click="showPointsGoodsDialog(scope.row)">ÁºñËæë</el-button>
                                        <el-button link :type="scope.row.is_active ? 'warning' : 'success'" size="small" @click="togglePointsGoodsStatus(scope.row)">
                                            {{ scope.row.is_active ? '‰∏ãÊû∂' : '‰∏äÊû∂' }}
                                        </el-button>
                                    </template>
                                </el-table-column>
                            </el-table>
                            <el-pagination v-model:current-page="pointsGoodsPage" v-model:page-size="pointsGoodsPageSize" :total="pointsGoodsTotal"
                                layout="total, prev, pager, next" @current-change="loadPointsGoods" style="margin-top: 16px; justify-content: center;">
                            </el-pagination>
                        </div>
                        <!-- ÁßØÂàÜÂïÜÂìÅÂØπËØùÊ°Ü -->
                        <el-dialog v-model="pointsGoodsDialogVisible" :title="pointsGoodsForm.id ? 'ÁºñËæëÂïÜÂìÅ' : 'Ê∑ªÂä†ÂïÜÂìÅ'" width="500px">
                            <el-form :model="pointsGoodsForm" label-width="80px">
                                <el-form-item label="ÂêçÁß∞" required><el-input v-model="pointsGoodsForm.name"></el-input></el-form-item>
                                <el-form-item label="ÁßØÂàÜ" required><el-input-number v-model="pointsGoodsForm.points" :min="1" style="width: 100%;"></el-input-number></el-form-item>
                                <el-form-item label="ÂàÜÁ±ª" required>
                                    <el-select v-model="pointsGoodsForm.category" style="width: 100%;">
                                        <el-option label="‰ºòÊÉ†Âà∏" value="‰ºòÊÉ†Âà∏"></el-option>
                                        <el-option label="‰∫¨‰∏úEÂç°" value="‰∫¨‰∏úEÂç°"></el-option>
                                        <el-option label="ÂÆûÁâ©Á§º" value="ÂÆûÁâ©Á§º"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="Â∫ìÂ≠ò"><el-input-number v-model="pointsGoodsForm.stock" :min="0" style="width: 100%;"></el-input-number></el-form-item>
                                <el-form-item label="ÂõæÁâá"><el-input v-model="pointsGoodsForm.image" placeholder="ÂõæÁâáURL"></el-input></el-form-item>
                                <el-form-item label="ÊèèËø∞"><el-input v-model="pointsGoodsForm.description" type="textarea" :rows="2"></el-input></el-form-item>
                            </el-form>
                            <template #footer>
                                <el-button @click="pointsGoodsDialogVisible = false">ÂèñÊ∂à</el-button>
                                <el-button type="primary" @click="savePointsGoods" :loading="loading">‰øùÂ≠ò</el-button>
                            </template>
                        </el-dialog>
                    </div>

                    <!-- ËØÑ‰ª∑ÁÆ°ÁêÜ -->
                    <div v-show="activeMenu === 'reviews'">
                        <div class="page-header">
                            <h3>‚≠ê ËØÑ‰ª∑ÁÆ°ÁêÜ</h3>
                        </div>
                        <div class="content-card">
                            <div style="margin-bottom: 16px;">
                                <el-select v-model="reviewStatusFilter" placeholder="Áä∂ÊÄÅÁ≠õÈÄâ" style="width: 120px;" clearable @change="loadReviews">
                                    <el-option label="Â∑≤ÂèëÂ∏É" value="published"></el-option>
                                    <el-option label="Â∑≤ÈöêËóè" value="hidden"></el-option>
                                </el-select>
                                <el-button type="primary" @click="loadReviews" style="margin-left: 10px;">ÊêúÁ¥¢</el-button>
                            </div>
                            <el-table :data="reviewList" v-loading="reviewLoading">
                                <el-table-column prop="id" label="ID" width="60"></el-table-column>
                                <el-table-column prop="user_nickname" label="Áî®Êà∑" width="100"></el-table-column>
                                <el-table-column prop="project_name" label="È°πÁõÆ" width="180" show-overflow-tooltip></el-table-column>
                                <el-table-column label="ËØÑÂàÜ" width="120">
                                    <template #default="scope">
                                        <el-rate v-model="scope.row.rating" disabled text-color="#ff9900"></el-rate>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="content" label="ÂÜÖÂÆπ" show-overflow-tooltip></el-table-column>
                                <el-table-column label="Áä∂ÊÄÅ" width="80">
                                    <template #default="scope">
                                        <el-tag :type="scope.row.status === 'published' ? 'success' : 'info'" size="small">{{ scope.row.status === 'published' ? 'ÊòæÁ§∫' : 'ÈöêËóè' }}</el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column label="Êó∂Èó¥" width="160">
                                    <template #default="scope">{{ formatDateTime(scope.row.created_at) }}</template>
                                </el-table-column>
                                <el-table-column label="Êìç‰Ωú" width="160">
                                    <template #default="scope">
                                        <el-button link type="primary" size="small" @click="replyReview(scope.row)">ÂõûÂ§ç</el-button>
                                        <el-button link :type="scope.row.status === 'published' ? 'warning' : 'success'" size="small" @click="toggleReviewStatus(scope.row)">
                                            {{ scope.row.status === 'published' ? 'ÈöêËóè' : 'ÊòæÁ§∫' }}
                                        </el-button>
                                    </template>
                                </el-table-column>
                            </el-table>
                            <el-pagination v-model:current-page="reviewPage" v-model:page-size="reviewPageSize" :total="reviewTotal"
                                layout="total, prev, pager, next" @current-change="loadReviews" style="margin-top: 16px; justify-content: center;">
                            </el-pagination>
                        </div>
                    </div>

                    <!-- Âõ¢‰ΩìÁÆ°ÁêÜ -->
                    <div v-show="activeMenu === 'groups'">
                        <div class="page-header">
                            <h3>üë• Âõ¢‰ΩìÁÆ°ÁêÜ</h3>
                        </div>
                        <div class="content-card">
                            <div style="margin-bottom: 16px; display: flex; gap: 10px;">
                                <el-input v-model="groupSearch" placeholder="ÊêúÁ¥¢Âõ¢‰ΩìÂêçÁß∞/ÈÇÄËØ∑Á†Å" style="width: 250px;" clearable @change="loadGroups">
                                    <template #prefix><el-icon><search /></el-icon></template>
                                </el-input>
                                <el-button type="primary" @click="loadGroups">ÊêúÁ¥¢</el-button>
                            </div>
                            <el-table :data="groupList" v-loading="groupLoading">
                                <el-table-column prop="id" label="ID" width="60"></el-table-column>
                                <el-table-column prop="name" label="Âõ¢‰ΩìÂêçÁß∞" width="150"></el-table-column>
                                <el-table-column prop="owner_name" label="Ë¥üË¥£‰∫∫" width="100"></el-table-column>
                                <el-table-column prop="owner_phone" label="ËÅîÁ≥ªÁîµËØù" width="120"></el-table-column>
                                <el-table-column prop="university" label="ÊâÄÂ±ûÈ´òÊ†°" width="150"></el-table-column>
                                <el-table-column prop="invite_code" label="ÈÇÄËØ∑Á†Å" width="100"></el-table-column>
                                <el-table-column prop="member_count" label="ÊàêÂëòÊï∞" width="80"></el-table-column>
                                <el-table-column label="Á¥ØËÆ°Ê∂àË¥π" width="100">
                                    <template #default="scope">¬•{{ scope.row.total_spent }}</template>
                                </el-table-column>
                                <el-table-column label="ËÆ§ËØÅ" width="80">
                                    <template #default="scope">
                                        <el-tag :type="scope.row.is_certified ? 'success' : 'info'" size="small">{{ scope.row.is_certified ? 'Â∑≤ËÆ§ËØÅ' : 'Êú™ËÆ§ËØÅ' }}</el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column label="Áä∂ÊÄÅ" width="80">
                                    <template #default="scope">
                                        <el-tag :type="scope.row.status === 'active' ? 'success' : 'danger'" size="small">{{ scope.row.status === 'active' ? 'Ê≠£Â∏∏' : 'Á¶ÅÁî®' }}</el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column label="Êìç‰Ωú" width="160">
                                    <template #default="scope">
                                        <el-button link :type="scope.row.is_certified ? 'warning' : 'success'" size="small" @click="toggleGroupCertify(scope.row)">
                                            {{ scope.row.is_certified ? 'ÂèñÊ∂àËÆ§ËØÅ' : 'ËÆ§ËØÅ' }}
                                        </el-button>
                                        <el-button link :type="scope.row.status === 'active' ? 'danger' : 'success'" size="small" @click="toggleGroupStatus(scope.row)">
                                            {{ scope.row.status === 'active' ? 'Á¶ÅÁî®' : 'ÂêØÁî®' }}
                                        </el-button>
                                    </template>
                                </el-table-column>
                            </el-table>
                            <el-pagination v-model:current-page="groupPage" v-model:page-size="groupPageSize" :total="groupTotal"
                                layout="total, prev, pager, next" @current-change="loadGroups" style="margin-top: 16px; justify-content: center;">
                            </el-pagination>
                        </div>
                    </div>

                    <!-- ÈÇÄËØ∑ÁÆ°ÁêÜ -->
                    <div v-show="activeMenu === 'invites'">
                        <div class="page-header">
                            <h3>üîó ÈÇÄËØ∑ÁÆ°ÁêÜ</h3>
                        </div>
                        <el-tabs v-model="inviteTab">
                            <el-tab-pane label="ÈÇÄËØ∑ËÆ∞ÂΩï" name="records">
                                <div class="content-card">
                                    <div style="margin-bottom: 16px;">
                                        <el-input v-model="inviteSearch" placeholder="ÊêúÁ¥¢ÊâãÊú∫Âè∑" style="width: 250px;" clearable @change="loadInvites"></el-input>
                                        <el-button type="primary" @click="loadInvites" style="margin-left: 10px;">ÊêúÁ¥¢</el-button>
                                    </div>
                                    <el-table :data="inviteList" v-loading="inviteLoading">
                                        <el-table-column prop="id" label="ID" width="60"></el-table-column>
                                        <el-table-column label="ÈÇÄËØ∑‰∫∫" width="150">
                                            <template #default="scope">
                                                <div>{{ scope.row.inviter_name }}</div>
                                                <div style="font-size: 12px; color: #999;">{{ scope.row.inviter_phone }}</div>
                                            </template>
                                        </el-table-column>
                                        <el-table-column label="Ë¢´ÈÇÄËØ∑‰∫∫" width="150">
                                            <template #default="scope">
                                                <div>{{ scope.row.invitee_name }}</div>
                                                <div style="font-size: 12px; color: #999;">{{ scope.row.invitee_phone }}</div>
                                            </template>
                                        </el-table-column>
                                        <el-table-column label="Â•ñÂä±" width="100">
                                            <template #default="scope"><span style="color: #ff4d4f;">¬•{{ scope.row.reward_amount }}</span></template>
                                        </el-table-column>
                                        <el-table-column label="È¶ñÂçïÈáëÈ¢ù" width="100">
                                            <template #default="scope">¬•{{ scope.row.first_order_amount || 0 }}</template>
                                        </el-table-column>
                                        <el-table-column label="Áä∂ÊÄÅ" width="100">
                                            <template #default="scope">
                                                <el-tag :type="getInviteStatusType(scope.row.status)" size="small">{{ getInviteStatusText(scope.row.status) }}</el-tag>
                                            </template>
                                        </el-table-column>
                                        <el-table-column label="ÈÇÄËØ∑Êó∂Èó¥" width="160">
                                            <template #default="scope">{{ formatDateTime(scope.row.invited_at) }}</template>
                                        </el-table-column>
                                    </el-table>
                                    <el-pagination v-model:current-page="invitePage" v-model:page-size="invitePageSize" :total="inviteTotal"
                                        layout="total, prev, pager, next" @current-change="loadInvites" style="margin-top: 16px; justify-content: center;">
                                    </el-pagination>
                                </div>
                            </el-tab-pane>
                            <el-tab-pane label="ÊèêÁé∞ÂÆ°Ê†∏" name="withdraws">
                                <div class="content-card">
                                    <div style="margin-bottom: 16px;">
                                        <el-select v-model="withdrawStatusFilter" placeholder="Áä∂ÊÄÅÁ≠õÈÄâ" style="width: 120px;" clearable @change="loadWithdraws">
                                            <el-option label="ÂæÖÂÆ°Ê†∏" value="pending"></el-option>
                                            <el-option label="Â∑≤ÈÄöËøá" value="approved"></el-option>
                                            <el-option label="Â∑≤ÊãíÁªù" value="rejected"></el-option>
                                        </el-select>
                                        <el-button type="primary" @click="loadWithdraws" style="margin-left: 10px;">ÊêúÁ¥¢</el-button>
                                    </div>
                                    <el-table :data="withdrawList" v-loading="withdrawLoading">
                                        <el-table-column prop="id" label="ID" width="60"></el-table-column>
                                        <el-table-column label="Áî®Êà∑" width="150">
                                            <template #default="scope">
                                                <div>{{ scope.row.user_nickname }}</div>
                                                <div style="font-size: 12px; color: #999;">{{ scope.row.user_phone }}</div>
                                            </template>
                                        </el-table-column>
                                        <el-table-column label="ÈáëÈ¢ù" width="100">
                                            <template #default="scope"><span style="color: #ff4d4f; font-weight: 600;">¬•{{ scope.row.amount }}</span></template>
                                        </el-table-column>
                                        <el-table-column label="Ë¥¶Êà∑" width="180">
                                            <template #default="scope">
                                                <div>{{ scope.row.account_type === 'alipay' ? 'ÊîØ‰ªòÂÆù' : scope.row.account_type === 'wechat' ? 'ÂæÆ‰ø°' : 'Èì∂Ë°åÂç°' }}</div>
                                                <div style="font-size: 12px; color: #999;">{{ scope.row.account_name }} {{ scope.row.account_number }}</div>
                                            </template>
                                        </el-table-column>
                                        <el-table-column label="Áä∂ÊÄÅ" width="100">
                                            <template #default="scope">
                                                <el-tag :type="getWithdrawStatusType(scope.row.status)" size="small">{{ getWithdrawStatusText(scope.row.status) }}</el-tag>
                                            </template>
                                        </el-table-column>
                                        <el-table-column label="Áî≥ËØ∑Êó∂Èó¥" width="160">
                                            <template #default="scope">{{ formatDateTime(scope.row.created_at) }}</template>
                                        </el-table-column>
                                        <el-table-column label="Êìç‰Ωú" width="150">
                                            <template #default="scope">
                                                <template v-if="scope.row.status === 'pending'">
                                                    <el-button link type="success" size="small" @click="reviewWithdraw(scope.row.id, 'approve')">ÈÄöËøá</el-button>
                                                    <el-button link type="danger" size="small" @click="reviewWithdraw(scope.row.id, 'reject')">ÊãíÁªù</el-button>
                                                </template>
                                                <span v-else style="color: #999;">Â∑≤Â§ÑÁêÜ</span>
                                            </template>
                                        </el-table-column>
                                    </el-table>
                                    <el-pagination v-model:current-page="withdrawPage" v-model:page-size="withdrawPageSize" :total="withdrawTotal"
                                        layout="total, prev, pager, next" @current-change="loadWithdraws" style="margin-top: 16px; justify-content: center;">
                                    </el-pagination>
                                </div>
                            </el-tab-pane>
                        </el-tabs>
                    </div>

                    <!-- Á≥ªÁªüËÆæÁΩÆ -->
                    <div v-show="activeMenu === 'settings'">
                        <div class="page-header">
                            <h3>‚öôÔ∏è Á≥ªÁªüËÆæÁΩÆ</h3>
                        </div>
                        <div class="content-card">
                            <el-descriptions title="Á≥ªÁªü‰ø°ÊÅØ" :column="2" border>
                                <el-descriptions-item label="Á≥ªÁªüÂêçÁß∞">ÁßëÁ†îÊ£ÄÊµãÊúçÂä°Âπ≥Âè∞</el-descriptions-item>
                                <el-descriptions-item label="ÁâàÊú¨">v1.1.0</el-descriptions-item>
                                <el-descriptions-item label="ÂêéÁ´ØÂú∞ÂùÄ">{{ baseUrl }}</el-descriptions-item>
                                <el-descriptions-item label="ÂΩìÂâçÁÆ°ÁêÜÂëò">{{ userInfo.nickname }}</el-descriptions-item>
                            </el-descriptions>
                        </div>
                    </div>
                </el-main>
            </el-container>
        </el-container>
    </div>

    <script>
        const { createApp } = Vue
        const { ElMessage, ElMessageBox } = ElementPlus

        createApp({
            data() {
                return {
                    baseUrl: 'https://catdog.dachaonet.com',
                    token: localStorage.getItem('admin_token') || '',
                    userInfo: JSON.parse(localStorage.getItem('admin_user') || '{}'),
                    loginType: 'admin',
                    adminLoginForm: { username: '', password: '' },
                    loginForm: { phone: '', sms_code: '' },
                    countdown: 0,
                    loading: false,
                    activeMenu: 'dashboard',
                    uploadedImages: [],
                    // ‰ª™Ë°®Áõò
                    dashboardData: {},
                    // Áî®Êà∑ÁÆ°ÁêÜ
                    users: [],
                    usersLoading: false,
                    userSearch: '',
                    userPage: 1,
                    userPageSize: 20,
                    userTotal: 0,
                    userDialogVisible: false,
                    selectedUser: null,
                    avatarUploadVisible: false,
                    currentEditUserId: null,
                    // È°πÁõÆÁÆ°ÁêÜ
                    projects: [],
                    projectsLoading: false,
                    projectSearch: '',
                    projectCategoryFilter: null,
                    projectPage: 1,
                    projectPageSize: 20,
                    projectTotal: 0,
                    projectDialogVisible: false,
                    projectForm: { id: null, name: '', project_no: '', category_id: null, description: '', original_price: '', current_price: '', cover_image: '', is_hot: false, is_recommended: false, status: 'active' },
                    categories: [],
                    // ËÆ¢ÂçïÁÆ°ÁêÜ
                    orders: [],
                    ordersLoading: false,
                    orderSearch: '',
                    orderStatusFilter: null,
                    orderPage: 1,
                    orderPageSize: 20,
                    orderTotal: 0,
                    // ÂàÜÁ±ªÁÆ°ÁêÜ
                    categoryList: [],
                    categoryLoading: false,
                    categorySearch: '',
                    categoryPage: 1,
                    categoryPageSize: 20,
                    categoryTotal: 0,
                    categoryDialogVisible: false,
                    categoryForm: { id: null, name: '', code: '', icon: '', description: '', sort_order: 0, is_hot: false },
                    // ‰ºòÊÉ†Âà∏ÁÆ°ÁêÜ
                    couponList: [],
                    couponLoading: false,
                    couponSearch: '',
                    couponPage: 1,
                    couponPageSize: 20,
                    couponTotal: 0,
                    couponDialogVisible: false,
                    couponForm: { id: null, name: '', type: 'cash', description: '', cash_amount: 10, discount_rate: 0.9, full_amount: 100, reduction_amount: 10, min_order_amount: 0, total_quantity: 0, valid_days: 30 },
                    // ÂÖÖÂÄºÁÆ°ÁêÜ
                    rechargeList: [],
                    rechargeLoading: false,
                    rechargeSearch: '',
                    rechargeStatusFilter: null,
                    rechargePage: 1,
                    rechargePageSize: 20,
                    rechargeTotal: 0,
                    // ÁßØÂàÜÂïÜÂìÅÁÆ°ÁêÜ
                    pointsGoodsList: [],
                    pointsGoodsLoading: false,
                    pointsGoodsSearch: '',
                    pointsGoodsCategoryFilter: null,
                    pointsGoodsPage: 1,
                    pointsGoodsPageSize: 20,
                    pointsGoodsTotal: 0,
                    pointsGoodsDialogVisible: false,
                    pointsGoodsForm: { id: null, name: '', points: 100, category: '‰ºòÊÉ†Âà∏', image: '', description: '', stock: 0, sort_order: 0 },
                    // ËØÑ‰ª∑ÁÆ°ÁêÜ
                    reviewList: [],
                    reviewLoading: false,
                    reviewStatusFilter: null,
                    reviewPage: 1,
                    reviewPageSize: 20,
                    reviewTotal: 0,
                    // Âõ¢‰ΩìÁÆ°ÁêÜ
                    groupList: [],
                    groupLoading: false,
                    groupSearch: '',
                    groupPage: 1,
                    groupPageSize: 20,
                    groupTotal: 0,
                    // ÈÇÄËØ∑ÁÆ°ÁêÜ
                    inviteTab: 'records',
                    inviteList: [],
                    inviteLoading: false,
                    inviteSearch: '',
                    invitePage: 1,
                    invitePageSize: 20,
                    inviteTotal: 0,
                    withdrawList: [],
                    withdrawLoading: false,
                    withdrawStatusFilter: null,
                    withdrawPage: 1,
                    withdrawPageSize: 20,
                    withdrawTotal: 0
                }
            },
            computed: {
                uploadUrl() { return `${this.baseUrl}/api/v1/upload/image` },
                uploadHeaders() { return { 'Authorization': `Bearer ${this.token}` } },
                maxOrderCount() {
                    const orders = this.dashboardData.trends?.orders || []
                    return Math.max(...orders.map(o => o.count), 1)
                },
                totalOrders() {
                    return (this.dashboardData.order_status_distribution || []).reduce((sum, item) => sum + item.count, 0)
                }
            },
            mounted() {
                if (this.token) {
                    this.loadDashboard()
                    this.loadCategoriesForSelect()
                }
            },
            methods: {
                handleMenuSelect(index) {
                    this.activeMenu = index
                    if (index === 'dashboard') this.loadDashboard()
                    else if (index === 'users' && this.users.length === 0) this.loadUsers()
                    else if (index === 'projects') this.loadProjects()
                    else if (index === 'orders') this.loadOrders()
                    else if (index === 'categories') this.loadCategories()
                    else if (index === 'coupons') this.loadCoupons()
                    else if (index === 'recharges') this.loadRecharges()
                    else if (index === 'points') this.loadPointsGoods()
                    else if (index === 'reviews') this.loadReviews()
                    else if (index === 'groups') this.loadGroups()
                    else if (index === 'invites') { this.loadInvites(); this.loadWithdraws() }
                },
                // ‰ª™Ë°®Áõò
                async loadDashboard() {
                    try {
                        const res = await axios.get(`${this.baseUrl}/api/v1/admin/dashboard/stats`, { headers: this.uploadHeaders })
                        this.dashboardData = res.data.data || {}
                    } catch (error) { console.error('Âä†ËΩΩÁªüËÆ°Êï∞ÊçÆÂ§±Ë¥•', error) }
                },
                getOrderStatusColor(status) {
                    const colors = { unpaid: '#E6A23C', paid: '#409EFF', confirmed: '#67C23A', testing: '#909399', completed: '#67C23A', cancelled: '#F56C6C' }
                    return colors[status] || '#909399'
                },
                copyImageUrl(url) {
                    if (navigator.clipboard) {
                        navigator.clipboard.writeText(url).then(() => {
                            ElMessage.success('ÂõæÁâáURLÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø')
                        }).catch(() => {
                            ElMessage.error('Â§çÂà∂Â§±Ë¥•')
                        })
                    } else {
                        // ÂÖºÂÆπÊóßÊµèËßàÂô®
                        const textarea = document.createElement('textarea')
                        textarea.value = url
                        document.body.appendChild(textarea)
                        textarea.select()
                        try {
                            document.execCommand('copy')
                            ElMessage.success('ÂõæÁâáURLÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø')
                        } catch (err) {
                            ElMessage.error('Â§çÂà∂Â§±Ë¥•')
                        }
                        document.body.removeChild(textarea)
                    }
                },
                async sendSms() {
                    if (!this.loginForm.phone) {
                        ElMessage.error('ËØ∑ËæìÂÖ•ÊâãÊú∫Âè∑')
                        return
                    }
                    try {
                        const res = await axios.post(`${this.baseUrl}/api/v1/auth/send-sms`, {
                            phone: this.loginForm.phone,
                            scene: 'login'
                        })
                        ElMessage.success(res.data.message)
                        if (res.data.data && res.data.data.code) {
                            ElMessage.info(`ÂºÄÂèëÊ®°ÂºèÈ™åËØÅÁ†ÅÔºö${res.data.data.code}`)
                        }
                        this.countdown = 60
                        const timer = setInterval(() => {
                            this.countdown--
                            if (this.countdown <= 0) {
                                clearInterval(timer)
                            }
                        }, 1000)
                    } catch (error) {
                        ElMessage.error(error.response?.data?.detail || 'ÂèëÈÄÅÂ§±Ë¥•')
                    }
                },
                async handleLogin() {
                    this.loading = true
                    try {
                        const res = await axios.post(`${this.baseUrl}/api/v1/auth/sms-login`, this.loginForm)
                        this.token = res.data.data.access_token
                        this.userInfo = {
                            id: res.data.data.user_id,
                            phone: res.data.data.phone,
                            nickname: res.data.data.nickname
                        }
                        localStorage.setItem('admin_token', this.token)
                        localStorage.setItem('admin_user', JSON.stringify(this.userInfo))
                        ElMessage.success('ÁôªÂΩïÊàêÂäü')
                        this.loadUsers()
                    } catch (error) {
                        ElMessage.error(error.response?.data?.detail || 'ÁôªÂΩïÂ§±Ë¥•')
                    } finally {
                        this.loading = false
                    }
                },
                async handleAdminLogin() {
                    if (!this.adminLoginForm.username || !this.adminLoginForm.password) {
                        ElMessage.error('ËØ∑ËæìÂÖ•Áî®Êà∑ÂêçÂíåÂØÜÁ†Å')
                        return
                    }
                    this.loading = true
                    try {
                        const res = await axios.post(`${this.baseUrl}/api/v1/auth/admin-login`, this.adminLoginForm)
                        this.token = res.data.data.access_token
                        this.userInfo = {
                            id: res.data.data.user_id,
                            phone: res.data.data.phone,
                            nickname: res.data.data.nickname,
                            is_admin: res.data.data.is_admin
                        }
                        localStorage.setItem('admin_token', this.token)
                        localStorage.setItem('admin_user', JSON.stringify(this.userInfo))
                        ElMessage.success('ÁôªÂΩïÊàêÂäü')
                        this.loadUsers()
                    } catch (error) {
                        ElMessage.error(error.response?.data?.detail || 'ÁôªÂΩïÂ§±Ë¥•')
                    } finally {
                        this.loading = false
                    }
                },
                logout() {
                    localStorage.removeItem('admin_token')
                    localStorage.removeItem('admin_user')
                    this.token = ''
                    this.userInfo = {}
                    ElMessage.success('Â∑≤ÈÄÄÂá∫ÁôªÂΩï')
                },
                handleUploadSuccess(response, file) {
                    if (response.code === 200) {
                        ElMessage.success('‰∏ä‰º†ÊàêÂäü')
                        this.uploadedImages.unshift({
                            url: response.data.url,
                            name: file.name
                        })
                    }
                },
                async handleAvatarUploadSuccess(response, file) {
                    if (response.code === 200) {
                        try {
                            // Êõ¥Êñ∞Áî®Êà∑Â§¥ÂÉè
                            await axios.put(
                                `${this.baseUrl}/api/v1/users/me`,
                                { avatar: response.data.url },
                                { headers: this.uploadHeaders }
                            )
                            ElMessage.success('Â§¥ÂÉèÊõ¥Êñ∞ÊàêÂäü')
                            this.avatarUploadVisible = false
                            // Âà∑Êñ∞Áî®Êà∑ËØ¶ÊÉÖ
                            if (this.selectedUser) {
                                await this.viewUser({ id: this.selectedUser.id })
                            }
                            this.loadUsers()
                        } catch (error) {
                            ElMessage.error(error.response?.data?.detail || 'Â§¥ÂÉèÊõ¥Êñ∞Â§±Ë¥•')
                        }
                    }
                },
                handleUploadError(error) {
                    ElMessage.error('‰∏ä‰º†Â§±Ë¥•Ôºö' + (error.message || 'Êú™Áü•ÈîôËØØ'))
                },
                beforeUpload(file) {
                    const isImage = file.type.startsWith('image/')
                    const isLt10M = file.size / 1024 / 1024 < 10

                    if (!isImage) {
                        ElMessage.error('Âè™ËÉΩ‰∏ä‰º†ÂõæÁâáÊñá‰ª∂!')
                        return false
                    }
                    if (!isLt10M) {
                        ElMessage.error('ÂõæÁâáÂ§ßÂ∞è‰∏çËÉΩË∂ÖËøá 10MB!')
                        return false
                    }
                    return true
                },
                async deleteImage(imageUrl) {
                    try {
                        await ElMessageBox.confirm('Á°ÆÂÆöË¶ÅÂà†Èô§ËøôÂº†ÂõæÁâáÂêó?', 'ÊèêÁ§∫', {
                            type: 'warning'
                        })
                        await axios.delete(`${this.baseUrl}/api/v1/upload/image`, {
                            headers: this.uploadHeaders,
                            params: { image_path: imageUrl }
                        })
                        this.uploadedImages = this.uploadedImages.filter(img => img.url !== imageUrl)
                        ElMessage.success('Âà†Èô§ÊàêÂäü')
                    } catch (error) {
                        if (error !== 'cancel') {
                            ElMessage.error(error.response?.data?.detail || 'Âà†Èô§Â§±Ë¥•')
                        }
                    }
                },
                async loadUsers() {
                    this.usersLoading = true
                    try {
                        const res = await axios.get(`${this.baseUrl}/api/v1/admin/users`, {
                            headers: this.uploadHeaders,
                            params: {
                                page: this.userPage,
                                page_size: this.userPageSize,
                                search: this.userSearch || undefined
                            }
                        })
                        this.users = res.data.data.list
                        this.userTotal = res.data.data.total
                    } catch (error) {
                        ElMessage.error(error.response?.data?.detail || 'Âä†ËΩΩÁî®Êà∑ÂàóË°®Â§±Ë¥•')
                    } finally {
                        this.usersLoading = false
                    }
                },
                async viewUser(user) {
                    try {
                        const res = await axios.get(`${this.baseUrl}/api/v1/users/${user.id}`, {
                            headers: this.uploadHeaders
                        })
                        this.selectedUser = res.data.data
                        this.userDialogVisible = true
                    } catch (error) {
                        ElMessage.error(error.response?.data?.detail || 'Âä†ËΩΩÁî®Êà∑ËØ¶ÊÉÖÂ§±Ë¥•')
                    }
                },
                async updateUserStatus(userId, status) {
                    const action = status === 'active' ? 'ÊøÄÊ¥ª' : 'Á¶ÅÁî®'
                    try {
                        await ElMessageBox.confirm(`Á°ÆÂÆöË¶Å${action}ËØ•Áî®Êà∑Âêó?`, 'ÊèêÁ§∫', {
                            type: 'warning'
                        })
                        await axios.put(
                            `${this.baseUrl}/api/v1/users/${userId}/status`, 
                            null,
                            {
                                headers: this.uploadHeaders,
                                params: { status }
                            }
                        )
                        ElMessage.success(`${action}ÊàêÂäü`)
                        this.loadUsers()
                    } catch (error) {
                        if (error !== 'cancel') {
                            ElMessage.error(error.response?.data?.detail || `${action}Â§±Ë¥•`)
                        }
                    }
                },
                getStatusText(status) {
                    const statusMap = {
                        'active': 'Ê≠£Â∏∏',
                        'inactive': 'Êú™ÊøÄÊ¥ª',
                        'banned': 'Â∑≤Á¶ÅÁî®'
                    }
                    return statusMap[status] || status
                },
                getMemberLevelText(level) {
                    const levelMap = {
                        0: 'ÊôÆÈÄö‰ºöÂëò',
                        1: 'Èì∂Âç°‰ºöÂëò',
                        2: 'ÈáëÂç°‰ºöÂëò',
                        3: 'ÁôΩÈáë‰ºöÂëò'
                    }
                    return levelMap[level] || 'ÊôÆÈÄö‰ºöÂëò'
                },
                formatDate(dateStr) {
                    if (!dateStr) return '-'
                    const date = new Date(dateStr)
                    return date.toLocaleString('zh-CN', {
                        year: 'numeric',
                        month: '2-digit',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit'
                    })
                },
                // ÂàÜÁ±ªÁÆ°ÁêÜÊñπÊ≥ïÔºà‰∏ãÊãâÈÄâÊã©Áî®Ôºâ
                async loadCategoriesForSelect() {
                    try {
                        const res = await axios.get(`${this.baseUrl}/api/v1/projects/categories`)
                        this.categories = res.data.data || []
                    } catch (error) { console.error('Âä†ËΩΩÂàÜÁ±ªÂ§±Ë¥•', error) }
                },
                // ÂàÜÁ±ªÁÆ°ÁêÜÊñπÊ≥ïÔºàÂêéÂè∞ÁÆ°ÁêÜÁî®Ôºâ
                async loadCategories() {
                    this.categoryLoading = true
                    try {
                        const res = await axios.get(`${this.baseUrl}/api/v1/admin/categories`, {
                            headers: this.uploadHeaders,
                            params: { page: this.categoryPage, page_size: this.categoryPageSize, search: this.categorySearch || undefined }
                        })
                        this.categoryList = res.data.data.items || []
                        this.categoryTotal = res.data.data.total || 0
                    } catch (error) { ElMessage.error('Âä†ËΩΩÂàÜÁ±ªÂ§±Ë¥•') }
                    finally { this.categoryLoading = false }
                },
                showCategoryDialog(category = null) {
                    if (category) this.categoryForm = { ...category }
                    else this.categoryForm = { id: null, name: '', code: '', icon: '', description: '', sort_order: 0, is_hot: false }
                    this.categoryDialogVisible = true
                },
                async saveCategory() {
                    if (!this.categoryForm.name) { ElMessage.error('ËØ∑Â°´ÂÜôÂàÜÁ±ªÂêçÁß∞'); return }
                    this.loading = true
                    try {
                        if (this.categoryForm.id) {
                            await axios.put(`${this.baseUrl}/api/v1/admin/categories/${this.categoryForm.id}`, this.categoryForm, { headers: this.uploadHeaders })
                            ElMessage.success('Êõ¥Êñ∞ÊàêÂäü')
                        } else {
                            await axios.post(`${this.baseUrl}/api/v1/admin/categories`, this.categoryForm, { headers: this.uploadHeaders })
                            ElMessage.success('ÂàõÂª∫ÊàêÂäü')
                        }
                        this.categoryDialogVisible = false
                        this.loadCategories()
                        this.loadCategoriesForSelect()
                    } catch (error) { ElMessage.error(error.response?.data?.detail || '‰øùÂ≠òÂ§±Ë¥•') }
                    finally { this.loading = false }
                },
                async deleteCategory(id) {
                    try {
                        await ElMessageBox.confirm('Á°ÆÂÆöË¶ÅÂà†Èô§ËØ•ÂàÜÁ±ªÂêóÔºü', 'ÊèêÁ§∫', { type: 'warning' })
                        await axios.delete(`${this.baseUrl}/api/v1/admin/categories/${id}`, { headers: this.uploadHeaders })
                        ElMessage.success('Âà†Èô§ÊàêÂäü')
                        this.loadCategories()
                        this.loadCategoriesForSelect()
                    } catch (error) { if (error !== 'cancel') ElMessage.error(error.response?.data?.detail || 'Âà†Èô§Â§±Ë¥•') }
                },
                // ‰ºòÊÉ†Âà∏ÁÆ°ÁêÜÊñπÊ≥ï
                async loadCoupons() {
                    this.couponLoading = true
                    try {
                        const res = await axios.get(`${this.baseUrl}/api/v1/admin/coupons`, {
                            headers: this.uploadHeaders,
                            params: { page: this.couponPage, page_size: this.couponPageSize, search: this.couponSearch || undefined }
                        })
                        this.couponList = res.data.data.items || []
                        this.couponTotal = res.data.data.total || 0
                    } catch (error) { ElMessage.error('Âä†ËΩΩ‰ºòÊÉ†Âà∏Â§±Ë¥•') }
                    finally { this.couponLoading = false }
                },
                showCouponDialog(coupon = null) {
                    if (coupon) this.couponForm = { ...coupon }
                    else this.couponForm = { id: null, name: '', type: 'cash', description: '', cash_amount: 10, discount_rate: 0.9, full_amount: 100, reduction_amount: 10, min_order_amount: 0, total_quantity: 0, valid_days: 30 }
                    this.couponDialogVisible = true
                },
                async saveCoupon() {
                    if (!this.couponForm.name) { ElMessage.error('ËØ∑Â°´ÂÜô‰ºòÊÉ†Âà∏ÂêçÁß∞'); return }
                    this.loading = true
                    try {
                        if (this.couponForm.id) {
                            await axios.put(`${this.baseUrl}/api/v1/admin/coupons/${this.couponForm.id}`, this.couponForm, { headers: this.uploadHeaders })
                            ElMessage.success('Êõ¥Êñ∞ÊàêÂäü')
                        } else {
                            await axios.post(`${this.baseUrl}/api/v1/admin/coupons`, this.couponForm, { headers: this.uploadHeaders })
                            ElMessage.success('ÂàõÂª∫ÊàêÂäü')
                        }
                        this.couponDialogVisible = false
                        this.loadCoupons()
                    } catch (error) { ElMessage.error(error.response?.data?.detail || '‰øùÂ≠òÂ§±Ë¥•') }
                    finally { this.loading = false }
                },
                async deleteCoupon(id) {
                    try {
                        await ElMessageBox.confirm('Á°ÆÂÆöË¶Å‰∏ãÊû∂ËØ•‰ºòÊÉ†Âà∏ÂêóÔºü', 'ÊèêÁ§∫', { type: 'warning' })
                        await axios.delete(`${this.baseUrl}/api/v1/admin/coupons/${id}`, { headers: this.uploadHeaders })
                        ElMessage.success('Â∑≤‰∏ãÊû∂')
                        this.loadCoupons()
                    } catch (error) { if (error !== 'cancel') ElMessage.error(error.response?.data?.detail || 'Êìç‰ΩúÂ§±Ë¥•') }
                },
                getCouponTypeText(type) {
                    return { cash: '‰ª£ÈáëÂà∏', discount: 'ÊäòÊâ£Âà∏', full_reduction: 'Êª°ÂáèÂà∏' }[type] || type
                },
                // ÂÖÖÂÄºÁÆ°ÁêÜÊñπÊ≥ï
                async loadRecharges() {
                    this.rechargeLoading = true
                    try {
                        const res = await axios.get(`${this.baseUrl}/api/v1/admin/recharges`, {
                            headers: this.uploadHeaders,
                            params: { page: this.rechargePage, page_size: this.rechargePageSize, search: this.rechargeSearch || undefined, status: this.rechargeStatusFilter || undefined }
                        })
                        this.rechargeList = res.data.data.items || []
                        this.rechargeTotal = res.data.data.total || 0
                    } catch (error) { ElMessage.error('Âä†ËΩΩÂÖÖÂÄºËÆ∞ÂΩïÂ§±Ë¥•') }
                    finally { this.rechargeLoading = false }
                },
                async updateRechargeStatus(id, status) {
                    try {
                        await ElMessageBox.confirm(`Á°ÆÂÆöË¶ÅÂ∞ÜÂÖÖÂÄºÁä∂ÊÄÅÊîπ‰∏∫${status === 'success' ? 'ÊàêÂäü' : 'Â§±Ë¥•'}ÂêóÔºü`, 'ÊèêÁ§∫', { type: 'warning' })
                        await axios.put(`${this.baseUrl}/api/v1/admin/recharges/${id}/status`, null, { headers: this.uploadHeaders, params: { new_status: status } })
                        ElMessage.success('Áä∂ÊÄÅÂ∑≤Êõ¥Êñ∞')
                        this.loadRecharges()
                    } catch (error) { if (error !== 'cancel') ElMessage.error(error.response?.data?.detail || 'Êìç‰ΩúÂ§±Ë¥•') }
                },
                getRechargeStatusText(status) {
                    return { pending: 'ÂæÖÊîØ‰ªò', success: 'ÊàêÂäü', failed: 'Â§±Ë¥•', refunded: 'Â∑≤ÈÄÄÊ¨æ' }[status] || status
                },
                getRechargeStatusType(status) {
                    return { pending: 'warning', success: 'success', failed: 'danger', refunded: 'info' }[status] || 'info'
                },
                // ÁßØÂàÜÂïÜÂìÅÁÆ°ÁêÜÊñπÊ≥ï
                async loadPointsGoods() {
                    this.pointsGoodsLoading = true
                    try {
                        const res = await axios.get(`${this.baseUrl}/api/v1/admin/points-goods`, {
                            headers: this.uploadHeaders,
                            params: { page: this.pointsGoodsPage, page_size: this.pointsGoodsPageSize, search: this.pointsGoodsSearch || undefined, category: this.pointsGoodsCategoryFilter || undefined }
                        })
                        this.pointsGoodsList = res.data.data.items || []
                        this.pointsGoodsTotal = res.data.data.total || 0
                    } catch (error) { ElMessage.error('Âä†ËΩΩÁßØÂàÜÂïÜÂìÅÂ§±Ë¥•') }
                    finally { this.pointsGoodsLoading = false }
                },
                showPointsGoodsDialog(goods = null) {
                    if (goods) this.pointsGoodsForm = { ...goods }
                    else this.pointsGoodsForm = { id: null, name: '', points: 100, category: '‰ºòÊÉ†Âà∏', image: '', description: '', stock: 0, sort_order: 0 }
                    this.pointsGoodsDialogVisible = true
                },
                async savePointsGoods() {
                    if (!this.pointsGoodsForm.name) { ElMessage.error('ËØ∑Â°´ÂÜôÂïÜÂìÅÂêçÁß∞'); return }
                    this.loading = true
                    try {
                        if (this.pointsGoodsForm.id) {
                            await axios.put(`${this.baseUrl}/api/v1/admin/points-goods/${this.pointsGoodsForm.id}`, this.pointsGoodsForm, { headers: this.uploadHeaders })
                            ElMessage.success('Êõ¥Êñ∞ÊàêÂäü')
                        } else {
                            await axios.post(`${this.baseUrl}/api/v1/admin/points-goods`, this.pointsGoodsForm, { headers: this.uploadHeaders })
                            ElMessage.success('ÂàõÂª∫ÊàêÂäü')
                        }
                        this.pointsGoodsDialogVisible = false
                        this.loadPointsGoods()
                    } catch (error) { ElMessage.error(error.response?.data?.detail || '‰øùÂ≠òÂ§±Ë¥•') }
                    finally { this.loading = false }
                },
                async togglePointsGoodsStatus(goods) {
                    try {
                        await axios.put(`${this.baseUrl}/api/v1/admin/points-goods/${goods.id}`, { is_active: !goods.is_active }, { headers: this.uploadHeaders })
                        ElMessage.success(goods.is_active ? 'Â∑≤‰∏ãÊû∂' : 'Â∑≤‰∏äÊû∂')
                        this.loadPointsGoods()
                    } catch (error) { ElMessage.error('Êìç‰ΩúÂ§±Ë¥•') }
                },
                // ËØÑ‰ª∑ÁÆ°ÁêÜÊñπÊ≥ï
                async loadReviews() {
                    this.reviewLoading = true
                    try {
                        const res = await axios.get(`${this.baseUrl}/api/v1/admin/reviews`, {
                            headers: this.uploadHeaders,
                            params: { page: this.reviewPage, page_size: this.reviewPageSize, status: this.reviewStatusFilter || undefined }
                        })
                        this.reviewList = res.data.data.items || []
                        this.reviewTotal = res.data.data.total || 0
                    } catch (error) { ElMessage.error('Âä†ËΩΩËØÑ‰ª∑Â§±Ë¥•') }
                    finally { this.reviewLoading = false }
                },
                async replyReview(review) {
                    const { value } = await ElMessageBox.prompt('ËØ∑ËæìÂÖ•ÂõûÂ§çÂÜÖÂÆπ', 'ÂõûÂ§çËØÑ‰ª∑', { inputValue: review.reply_content || '' })
                    if (value) {
                        try {
                            await axios.put(`${this.baseUrl}/api/v1/admin/reviews/${review.id}/reply`, null, { headers: this.uploadHeaders, params: { content: value } })
                            ElMessage.success('ÂõûÂ§çÊàêÂäü')
                            this.loadReviews()
                        } catch (error) { ElMessage.error('ÂõûÂ§çÂ§±Ë¥•') }
                    }
                },
                async toggleReviewStatus(review) {
                    const newStatus = review.status === 'published' ? 'hidden' : 'published'
                    try {
                        await axios.put(`${this.baseUrl}/api/v1/admin/reviews/${review.id}/status`, null, { headers: this.uploadHeaders, params: { status: newStatus } })
                        ElMessage.success('Áä∂ÊÄÅÂ∑≤Êõ¥Êñ∞')
                        this.loadReviews()
                    } catch (error) { ElMessage.error('Êìç‰ΩúÂ§±Ë¥•') }
                },
                // Âõ¢‰ΩìÁÆ°ÁêÜÊñπÊ≥ï
                async loadGroups() {
                    this.groupLoading = true
                    try {
                        const res = await axios.get(`${this.baseUrl}/api/v1/admin/groups`, {
                            headers: this.uploadHeaders,
                            params: { page: this.groupPage, page_size: this.groupPageSize, search: this.groupSearch || undefined }
                        })
                        this.groupList = res.data.data.items || []
                        this.groupTotal = res.data.data.total || 0
                    } catch (error) { ElMessage.error('Âä†ËΩΩÂõ¢‰ΩìÂ§±Ë¥•') }
                    finally { this.groupLoading = false }
                },
                async toggleGroupCertify(group) {
                    try {
                        await axios.put(`${this.baseUrl}/api/v1/admin/groups/${group.id}/certify`, null, { headers: this.uploadHeaders, params: { is_certified: !group.is_certified } })
                        ElMessage.success(group.is_certified ? 'Â∑≤ÂèñÊ∂àËÆ§ËØÅ' : 'Â∑≤ËÆ§ËØÅ')
                        this.loadGroups()
                    } catch (error) { ElMessage.error('Êìç‰ΩúÂ§±Ë¥•') }
                },
                async toggleGroupStatus(group) {
                    const newStatus = group.status === 'active' ? 'inactive' : 'active'
                    try {
                        await axios.put(`${this.baseUrl}/api/v1/admin/groups/${group.id}/status`, null, { headers: this.uploadHeaders, params: { status: newStatus } })
                        ElMessage.success('Áä∂ÊÄÅÂ∑≤Êõ¥Êñ∞')
                        this.loadGroups()
                    } catch (error) { ElMessage.error('Êìç‰ΩúÂ§±Ë¥•') }
                },
                // ÈÇÄËØ∑ÁÆ°ÁêÜÊñπÊ≥ï
                async loadInvites() {
                    this.inviteLoading = true
                    try {
                        const res = await axios.get(`${this.baseUrl}/api/v1/admin/invites`, {
                            headers: this.uploadHeaders,
                            params: { page: this.invitePage, page_size: this.invitePageSize, search: this.inviteSearch || undefined }
                        })
                        this.inviteList = res.data.data.items || []
                        this.inviteTotal = res.data.data.total || 0
                    } catch (error) { ElMessage.error('Âä†ËΩΩÈÇÄËØ∑ËÆ∞ÂΩïÂ§±Ë¥•') }
                    finally { this.inviteLoading = false }
                },
                async loadWithdraws() {
                    this.withdrawLoading = true
                    try {
                        const res = await axios.get(`${this.baseUrl}/api/v1/admin/withdraws`, {
                            headers: this.uploadHeaders,
                            params: { page: this.withdrawPage, page_size: this.withdrawPageSize, status: this.withdrawStatusFilter || undefined }
                        })
                        this.withdrawList = res.data.data.items || []
                        this.withdrawTotal = res.data.data.total || 0
                    } catch (error) { ElMessage.error('Âä†ËΩΩÊèêÁé∞ËÆ∞ÂΩïÂ§±Ë¥•') }
                    finally { this.withdrawLoading = false }
                },
                async reviewWithdraw(id, action) {
                    let rejectReason = null
                    if (action === 'reject') {
                        const { value } = await ElMessageBox.prompt('ËØ∑ËæìÂÖ•ÊãíÁªùÂéüÂõ†', 'ÊãíÁªùÊèêÁé∞')
                        rejectReason = value
                    }
                    try {
                        await axios.put(`${this.baseUrl}/api/v1/admin/withdraws/${id}/review`, null, { 
                            headers: this.uploadHeaders, 
                            params: { action, reject_reason: rejectReason } 
                        })
                        ElMessage.success(action === 'approve' ? 'Â∑≤ÈÄöËøá' : 'Â∑≤ÊãíÁªù')
                        this.loadWithdraws()
                    } catch (error) { ElMessage.error('Êìç‰ΩúÂ§±Ë¥•') }
                },
                getInviteStatusText(status) {
                    return { pending: 'ÂæÖÂÆåÊàê', completed: 'Â∑≤ÂÆåÊàê', withdrawn: 'Â∑≤ÊèêÁé∞' }[status] || status
                },
                getInviteStatusType(status) {
                    return { pending: 'warning', completed: 'success', withdrawn: 'info' }[status] || 'info'
                },
                getWithdrawStatusText(status) {
                    return { pending: 'ÂæÖÂÆ°Ê†∏', approved: 'Â∑≤ÈÄöËøá', rejected: 'Â∑≤ÊãíÁªù', completed: 'Â∑≤ÂÆåÊàê' }[status] || status
                },
                getWithdrawStatusType(status) {
                    return { pending: 'warning', approved: 'success', rejected: 'danger', completed: 'info' }[status] || 'info'
                },
                // È°πÁõÆÁÆ°ÁêÜÊñπÊ≥ï
                async loadProjects() {
                    this.projectsLoading = true
                    try {
                        const params = {
                            page: this.projectPage,
                            page_size: this.projectPageSize
                        }
                        if (this.projectSearch) {
                            params.search = this.projectSearch
                        }
                        if (this.projectCategoryFilter) {
                            params.category_id = this.projectCategoryFilter
                        }
                        const res = await axios.get(`${this.baseUrl}/api/v1/projects/list`, {
                            params,
                            headers: this.uploadHeaders
                        })
                        this.projects = res.data.data.items || []
                        this.projectTotal = res.data.data.total || 0
                    } catch (error) {
                        ElMessage.error(error.response?.data?.detail || 'Âä†ËΩΩÈ°πÁõÆÂàóË°®Â§±Ë¥•')
                    } finally {
                        this.projectsLoading = false
                    }
                },
                showProjectDialog(project = null) {
                    if (project) {
                        // ÁºñËæëÈ°πÁõÆ
                        this.projectForm = { ...project }
                    } else {
                        // Êñ∞Âª∫È°πÁõÆ
                        this.projectForm = {
                            id: null,
                            name: '',
                            project_no: '',
                            category_id: null,
                            description: '',
                            original_price: '',
                            current_price: '',
                            cover_image: '',
                            is_hot: false,
                            is_recommended: false,
                            status: 'active'
                        }
                    }
                    this.projectDialogVisible = true
                },
                async saveProject() {
                    if (!this.projectForm.name || !this.projectForm.project_no) {
                        ElMessage.error('ËØ∑Â°´ÂÜôÈ°πÁõÆÂêçÁß∞ÂíåÁºñÂè∑')
                        return
                    }
                    this.loading = true
                    try {
                        if (this.projectForm.id) {
                            // Êõ¥Êñ∞
                            await axios.put(
                                `${this.baseUrl}/api/v1/projects/${this.projectForm.id}`,
                                this.projectForm,
                                { headers: this.uploadHeaders }
                            )
                            ElMessage.success('Êõ¥Êñ∞ÊàêÂäü')
                        } else {
                            // ÂàõÂª∫
                            await axios.post(
                                `${this.baseUrl}/api/v1/projects/create`,
                                this.projectForm,
                                { headers: this.uploadHeaders }
                            )
                            ElMessage.success('ÂàõÂª∫ÊàêÂäü')
                        }
                        this.projectDialogVisible = false
                        this.loadProjects()
                    } catch (error) {
                        ElMessage.error(error.response?.data?.detail || '‰øùÂ≠òÂ§±Ë¥•')
                    } finally {
                        this.loading = false
                    }
                },
                async updateProjectStatus(projectId, status) {
                    const action = status === 'active' ? '‰∏äÊû∂' : '‰∏ãÊû∂'
                    try {
                        await ElMessageBox.confirm(`Á°ÆÂÆöË¶Å${action}ËØ•È°πÁõÆÂêó?`, 'ÊèêÁ§∫', {
                            type: 'warning'
                        })
                        await axios.put(
                            `${this.baseUrl}/api/v1/projects/${projectId}/status`,
                            null,
                            {
                                headers: this.uploadHeaders,
                                params: { status }
                            }
                        )
                        ElMessage.success(`${action}ÊàêÂäü`)
                        this.loadProjects()
                    } catch (error) {
                        if (error !== 'cancel') {
                            ElMessage.error(error.response?.data?.detail || `${action}Â§±Ë¥•`)
                        }
                    }
                },
                async deleteProject(projectId) {
                    try {
                        await ElMessageBox.confirm('Á°ÆÂÆöË¶ÅÂà†Èô§ËØ•È°πÁõÆÂêó? Ê≠§Êìç‰Ωú‰∏çÂèØÊÅ¢Â§ç!', 'Ë≠¶Âëä', {
                            type: 'error',
                            confirmButtonText: 'Á°ÆÂÆöÂà†Èô§',
                            cancelButtonText: 'ÂèñÊ∂à'
                        })
                        await axios.delete(
                            `${this.baseUrl}/api/v1/projects/${projectId}`,
                            { headers: this.uploadHeaders }
                        )
                        ElMessage.success('Âà†Èô§ÊàêÂäü')
                        this.loadProjects()
                    } catch (error) {
                        if (error !== 'cancel') {
                            ElMessage.error(error.response?.data?.detail || 'Âà†Èô§Â§±Ë¥•')
                        }
                    }
                },
                handleProjectImageUpload(response, file) {
                    if (response.code === 200) {
                        this.projectForm.cover_image = response.data.url
                        ElMessage.success('Â∞ÅÈù¢ÂõæÁâá‰∏ä‰º†ÊàêÂäü')
                    }
                },
                
                // ==================== ËÆ¢ÂçïÁÆ°ÁêÜ ====================
                async loadOrders() {
                    this.ordersLoading = true
                    try {
                        const res = await axios.get(`${this.baseUrl}/api/v1/admin/orders`, {
                            headers: this.uploadHeaders,
                            params: {
                                page: this.orderPage,
                                page_size: this.orderPageSize,
                                search: this.orderSearch || undefined,
                                status: this.orderStatusFilter || undefined
                            }
                        })
                        this.orders = res.data.data.items || []
                        this.orderTotal = res.data.data.total || 0
                    } catch (error) {
                        console.error('Âä†ËΩΩËÆ¢ÂçïÂ§±Ë¥•', error)
                        ElMessage.error(error.response?.data?.detail || 'Âä†ËΩΩËÆ¢ÂçïÂ§±Ë¥•')
                    } finally {
                        this.ordersLoading = false
                    }
                },
                viewOrderDetail(order) {
                    ElMessageBox.alert(`
                        <div style="line-height: 1.8;">
                            <p><strong>ËÆ¢ÂçïÂè∑Ôºö</strong>${order.order_no}</p>
                            <p><strong>Áî®Êà∑Ôºö</strong>${order.user_nickname} (${order.user_phone})</p>
                            <p><strong>È°πÁõÆÔºö</strong>${order.project_name}</p>
                            <p><strong>Ê†∑ÂìÅÔºö</strong>${order.sample_name} √ó ${order.quantity}</p>
                            <p><strong>ÈáëÈ¢ùÔºö</strong>¬•${order.total_amount}</p>
                            <p><strong>Áä∂ÊÄÅÔºö</strong>${this.getOrderStatusText(order.status)}</p>
                            <p><strong>ÂàõÂª∫Êó∂Èó¥Ôºö</strong>${this.formatDateTime(order.created_at)}</p>
                            ${order.paid_at ? `<p><strong>ÊîØ‰ªòÊó∂Èó¥Ôºö</strong>${this.formatDateTime(order.paid_at)}</p>` : ''}
                        </div>
                    `, 'ËÆ¢ÂçïËØ¶ÊÉÖ', {
                        dangerouslyUseHTMLString: true,
                        confirmButtonText: 'ÂÖ≥Èó≠'
                    })
                },
                showOrderStatusDialog(order) {
                    ElMessageBox.prompt('ËØ∑ËæìÂÖ•Êñ∞Áä∂ÊÄÅ', '‰øÆÊîπËÆ¢ÂçïÁä∂ÊÄÅ', {
                        confirmButtonText: 'Á°ÆÂÆö',
                        cancelButtonText: 'ÂèñÊ∂à',
                        inputPlaceholder: 'unpaid/paid/confirmed/testing/completed/cancelled',
                        inputValue: order.status
                    }).then(async ({ value }) => {
                        try {
                            await axios.put(
                                `${this.baseUrl}/api/v1/admin/orders/${order.id}/status`,
                                null,
                                {
                                    headers: this.uploadHeaders,
                                    params: { new_status: value }
                                }
                            )
                            ElMessage.success('Áä∂ÊÄÅ‰øÆÊîπÊàêÂäü')
                            this.loadOrders()
                        } catch (error) {
                            ElMessage.error(error.response?.data?.detail || 'Áä∂ÊÄÅ‰øÆÊîπÂ§±Ë¥•')
                        }
                    }).catch(() => {})
                },
                getOrderStatusText(status) {
                    const statusMap = {
                        'unpaid': 'ÂæÖÊîØ‰ªò',
                        'paid': 'Â∑≤ÊîØ‰ªò',
                        'confirmed': 'Â∑≤Á°ÆËÆ§',
                        'testing': 'ÂÆûÈ™å‰∏≠',
                        'completed': 'Â∑≤ÂÆåÊàê',
                        'cancelled': 'Â∑≤ÂèñÊ∂à'
                    }
                    return statusMap[status] || status
                },
                getOrderStatusType(status) {
                    const typeMap = {
                        'unpaid': 'warning',
                        'paid': 'info',
                        'confirmed': 'primary',
                        'testing': 'primary',
                        'completed': 'success',
                        'cancelled': 'danger'
                    }
                    return typeMap[status] || 'info'
                },
                formatDateTime(dateStr) {
                    if (!dateStr) return '-'
                    const date = new Date(dateStr)
                    return date.toLocaleString('zh-CN', {
                        year: 'numeric',
                        month: '2-digit',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit'
                    })
                }
            }
        }).use(ElementPlus).mount('#app')
    </script>
</body>
</html>
